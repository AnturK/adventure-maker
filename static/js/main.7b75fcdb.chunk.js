(this["webpackJsonpadventure-maker"]=this["webpackJsonpadventure-maker"]||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),c=n(19),a=n.n(c),s=(n(61),n(62),n(63),n(11)),o=n(8),d=n(15),l=n(5),u=n(6),j=n(80),h=n(75),b=n(76),f=n(54),O=n(74),x=n(72),g=n(81),v=n(55),A=n(52),m=n(82),p=n(83),_=n(13),y=n(14);function q(e,t,n){var i=e.slice();return i[e.indexOf(t)]=n,i}function C(e,t,n){return Object(l.a)(Object(l.a)({},e),{},Object(y.a)({},t,n))}function w(e){var t=Number(e);return Number.isFinite(t)&&!Number.isNaN(t)?t:e}var k={};function R(e){return e in k?k[e]+=1:k[e]=0,"".concat(e," ").concat(k[e])}var D=function e(){Object(_.a)(this,e),this.id=void 0,this.name=void 0,this.description=void 0,this.choices=void 0,this.image=void 0,this.raw_image=void 0,this.on_enter_effects=void 0,this.on_exit_effects=void 0,this.id=R("Node"),this.name=this.id,this.description="Node description goes here",this.choices=[],this.image="default",this.raw_image=void 0,this.on_enter_effects=void 0,this.on_exit_effects=void 0},T=function e(){Object(_.a)(this,e),this.id=void 0,this.name=void 0,this.target_node=void 0,this.on_trigger_effects=void 0,this.requirements=void 0,this.id=R("trigger"),this.name="Trigger",this.target_node=void 0,this.on_trigger_effects=void 0,this.requirements=void 0},E=function e(){Object(_.a)(this,e),this.id=void 0,this.key=void 0,this.name=void 0,this.exit_node=void 0,this.on_selection_effects=void 0,this.requirements=void 0,this.delay=void 0,this.delay_message=void 0,this.id=R("choice"),this.key=this.id,this.name="New Choice",this.exit_node="FAIL",this.on_selection_effects=void 0,this.requirements=void 0,this.delay=0,this.delay_message=void 0},S=function e(){Object(_.a)(this,e),this.id=void 0,this.effect_type=void 0,this.quality=void 0,this.value=void 0,this.id=R("effect"),this.effect_type="Add",this.quality="Quality",this.value=1},I=function e(){Object(_.a)(this,e),this.id=void 0,this.group_type=void 0,this.requirements=void 0,this.id=R("req"),this.group_type="AND",this.requirements=[]},N=function e(){Object(_.a)(this,e),this.id=void 0,this.quality=void 0,this.operator=void 0,this.value=void 0,this.id=R("req"),this.quality="Quality",this.operator="==",this.value=1},B=Object(s.b)({key:"adventure",default:new function e(){Object(_.a)(this,e),this.name=void 0,this.starting_node=void 0,this.nodes=void 0,this.triggers=void 0,this.required_site_traits=void 0,this.loot_types=void 0,this.band_modifiers=void 0,this.starting_qualities=void 0,this.deep_scan_description=void 0,this.author=void 0,this.name="New adventure",this.starting_node="",this.nodes=[],this.triggers=[],this.required_site_traits=[],this.loot_types=[],this.band_modifiers={},this.starting_qualities={},this.deep_scan_description="",this.author="Anonymous"}}),G=Object(s.c)({key:"nodes",get:function(e){return(0,e.get)(B).nodes}}),Q=Object(s.d)({key:"single_node",get:function(e){return function(t){return(0,t.get)(B).nodes.find((function(t){return t.id===e}))}},set:function(e){return function(t,n){var i=t.set,r=(0,t.get)(B),c=Object(l.a)(Object(l.a)({},r),{},{nodes:q(r.nodes,r.nodes.find((function(t){return t.id===e})),n)});i(B,c)}}}),U=Object(s.c)({key:"triggers",get:function(e){return(0,e.get)(B).triggers}}),L=Object(s.d)({key:"single_trigger",get:function(e){return function(t){return(0,t.get)(B).triggers.find((function(t){return t.id===e}))}},set:function(e){return function(t,n){var i=t.set,r=(0,t.get)(B),c=Object(l.a)(Object(l.a)({},r),{},{triggers:q(r.triggers,r.triggers.find((function(t){return t.id===e})),n)});i(B,c)}}}),M=n(84),P=n(78),F=n(71),K=n(73),H=n(53),V=["FAIL","FAIL_DEATH","WIN","GO_BACK"],J=["ruins","technology present","space station","alien","habitable","spaceship","in space","on surface"],X=["Plasma absorption band","Hydrocarbons/Molecular oxygen","Narrow-band radio waves","Exotic Radiation","Increased Density"],Z=["maint","drugs","trade_contract","weapons","pets","unique","cash","materials"],W={default:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC7SURBVGje7ZdBDsJADAPjH2T//1lAgNrlxMVDiTynnjKyu6m6FUIIIfyA9aCtCq0XhMNo0bMoWRt7j3Za7rOPJ5fkNNj3Vk5zbVGOtiCJra9trFHSm6TdEvkka46kR0i2uX8t2bZRri+kPpax3FCSdjtESdwOpK0a05agtuwOJIiAIEUEKSKIGMmQtooIIiKIprQFSSqS71FHcjVJCD6gHzvmsuiOogVcSSO5ngQ5XcyeMDegEEIIYTBVNw34EbwIRO7ZAAAAAElFTkSuQmCC",grue:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP8AAP8hAFWgYwIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABbSURBVGje7dPBDYAgEEVBtAKXCmT7L1LucgRi4kwDL/nZLQAAAAAAAPxQXOsbR8SGSG3rKy0zB+m5G/ZG3q/G5A3PQeTMDRNGjeU312+htuWRjLbheQAA+KxSHrpcA/wdxXfnAAAAAElFTkSuQmCC",signal_lost:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsIAAA7CARUoSoAAAADZSURBVGje7ZNRFoQgCADhBnD/y66AWenbLb935vXK1BwhEQAAAAAAAACAv0LdXLzR2tVsPepuItWZ9Gb0xgxzvww+k7Prk978LvHo1rjvSTQWb4/cYry1q9bLjnMvdWvzwhMRy4bEhqSamb5cZpHUhD66Jck0D4m8kNTIjqTy3CXxK9QsM9hDXCXqcyrfae6SfgZK4qfED6+67UnWf/IkcZmjfCPR83SlREeuJkk/XVUuW5Lc81QnkUG9FYMf5XSZuxPJWD4e9lNSIehUqAAAAAAAAAAAAFdEPmbgEwxTT+ziAAAAAElFTkSuQmCC",trader:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP/YAH8zAHXkPMkAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAF8SURBVGje7dkLbsMgDAZg8AnwDbzd/5BTk3aD+A9Ngp2ChvuSIuoP2W4TtWHGjBkzZsyYMWxE5uSYnpfwEuKa3il7vnmxz643b4rsVJ6+TbLnm9fdbUb05i2RvbGJ+pDIpaZUxsYO+X37DQgqtkYoCBkjeoRHQFCxNSLLbTgk6s9OG4KKvYOQM0KhfwQVW3/X34LI6945Qs4IKvZ6ltmsegj07xFUbI1I9jBC9HXFAAgs9j5CjggFc+R5McZmCCp2BbnWlGOIDITkxX4aWef/8l9pCuyoQigMhGTFjtaI1BAuVhXPPSPkhsBicxUhayTlq/pGYLHryPmmICQqRFwRNkfoIHK2KbCjCqFgjzBCslNME/J6yZG0rioPnWyKHEKEi0guyFeJcBOyFi++Rc79mgrHpkCWznMzosZGI6HFwGMDkNBg4LFhgKBLsaMBx6apNgeQ5IHwHQhKGM0RMDYbxOaPhu3YuCB7qCvCn0DSRCoRP4LwqMiMGb1GCD/OSlYEGoUISwAAAABJRU5ErkJggg=="},Y={Add:"Add",Set:"Set",Remove:"Remove"},z={raw:"raw",random:"random"},$=n(1);function ee(e){var t=e.handleChange,n=e.handleDelete,i=e.effect.value===Object(e.effect.value)?e.effect.value.value_type:"raw";return Object($.jsxs)(F.a,{children:[Object($.jsx)(A.a,{as:"select",value:e.effect.effect_type,onChange:function(e){return t("effect_type",e.target.value)},children:Object.keys(Y).map((function(e){return Object($.jsx)("option",{children:Y[e]},e)}))}),Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Quality"})}),Object($.jsx)(A.a,{value:e.effect.quality,onChange:function(e){return t("quality",e.target.value)}}),Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Value"})}),function(n){switch(n){case"random":return Object($.jsxs)($.Fragment,{children:[Object($.jsx)(F.a.Text,{children:"Random"}),Object($.jsx)(A.a,{value:e.effect.value.low,onChange:function(n){return t("value",Object(l.a)(Object(l.a)({},e.effect.value),{},{low:w(n.target.value)}))}}),Object($.jsx)(F.a.Text,{children:"To"}),Object($.jsx)(A.a,{value:e.effect.value.high,onChange:function(n){return t("value",Object(l.a)(Object(l.a)({},e.effect.value),{},{high:w(n.target.value)}))}})]});case"raw":return Object($.jsx)(A.a,{value:e.effect.value,onChange:function(e){return t("value",w(e.target.value))}});default:return Object($.jsx)(F.a.Text,{children:"Unsupported"})}}(i),Object($.jsxs)(F.a.Append,{children:[Object($.jsx)(x.a,{onClick:function(e){var n=Object.keys(z).map((function(e){return z[e]})),r=n.indexOf(i),c=n[(r+1)%n.length];t("value",function(e){switch(e){case z.raw:return 0;case z.random:return{value_type:z.random,low:0,high:0};default:return 0}}(c))},children:"*"}),Object($.jsx)(x.a,{variant:"danger",onClick:n,children:"Delete"})]})]})}function te(e){var t=e.handleEffectsChanged,n=e.handleEffectAdded,i=e.handleEffectDeleted;function r(){n(new S)}return e.effects?Object($.jsxs)($.Fragment,{children:[Object($.jsx)(M.a.Header,{children:e.title}),Object($.jsxs)(K.a,{children:[e.effects.map((function(e){return Object($.jsx)(H.a,{children:Object($.jsx)(ee,{effect:e,handleChange:function(n,i){return t(e,n,i)},handleDelete:function(t,n){return i(e,t,n)}})},e.id)})),Object($.jsx)(H.a,{children:Object($.jsx)(x.a,{onClick:r,children:"Add New Effect"})})]})]}):Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:e.title})}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{onClick:r,children:"Create Effect"})})]})}function ne(e){var t=e.handleRequirementsChanged,n=e.handleRequirementAdded,i=e.handleRequirementDeleted;function r(){n(new N)}return e.requirements?Object($.jsxs)($.Fragment,{children:[Object($.jsx)(M.a.Header,{children:e.title}),Object($.jsxs)(K.a,{children:[e.requirements.map((function(e){return e.requirements?Object($.jsx)(re,{group:e,handleReqGroupChanged:function(n,i){return t(e,n,i)},handleReqGroupDeleted:function(){return i(e)}},e.id):Object($.jsx)(ie,{requirement:e,handleReqChanged:function(n,i){return t(e,n,i)},handleReqDeleted:function(){return i(e)}},e.id)})),Object($.jsx)(K.a.Item,{children:Object($.jsxs)(O.a,{children:[Object($.jsx)(x.a,{onClick:function(){n(new I)},children:"Add Req Group"}),Object($.jsx)(x.a,{onClick:r,children:"Add Single Req"})]})})]})]}):Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:e.title})}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{onClick:r,children:"Add Requirements"})})]})}function ie(e){var t=e.handleReqDeleted,n=e.handleReqChanged;return Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Quality"})}),Object($.jsx)(A.a,{value:e.requirement.quality,onChange:function(e){return n("quality",e.target.value)}}),Object($.jsxs)(A.a,{as:"select",value:e.requirement.operator,onChange:function(e){return n("operator",e.target.value)},children:[Object($.jsx)("option",{children:"=="}),Object($.jsx)("option",{children:"!="}),Object($.jsx)("option",{children:">"}),Object($.jsx)("option",{children:"<"}),Object($.jsx)("option",{children:">="}),Object($.jsx)("option",{children:"<="})]}),Object($.jsx)(A.a,{value:e.requirement.value,onChange:function(e){return n("value",w(e.target.value))}}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{variant:"danger",onClick:function(){return t(e.requirement)},children:"Delete"})})]})}function re(e){var t=e.handleReqGroupDeleted,n=e.handleReqGroupChanged,i=function(t){var i=e.group.requirements.filter((function(e){return e!==t}));n("requirements",i)},r=function(t,i,r){var c=Object(l.a)(Object(l.a)({},t),{},Object(y.a)({},i,r)),a=e.group.requirements.slice();a[e.group.requirements.indexOf(t)]=c,n("requirements",a)};return Object($.jsxs)(M.a,{border:"dark",children:[Object($.jsx)(M.a.Header,{children:Object($.jsxs)(F.a,{children:[Object($.jsxs)(A.a,{as:"select",value:e.group.group_type,onChange:function(e){return n("group_type",e.target.value)},children:[Object($.jsx)("option",{children:"AND"}),Object($.jsx)("option",{children:"OR"})]}),Object($.jsx)(F.a.Text,{children:"Group"}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{variant:"danger",onClick:function(){return t(e.group)},children:"Delete"})})]})}),Object($.jsxs)(K.a,{children:[Object($.jsx)(K.a.Item,{children:e.group.requirements.map((function(e){return e.requirements?Object($.jsx)(re,{group:e,handleReqGroupDeleted:i,handleReqGroupChanged:function(t,n){return r(e,t,n)}},e.id):Object($.jsx)(ie,{requirement:e,handleReqDeleted:i,handleReqChanged:function(t,n){return r(e,t,n)}},e.id)}))}),Object($.jsx)(K.a.Item,{children:Object($.jsxs)(O.a,{children:[Object($.jsx)(x.a,{onClick:function(){var t=new I,i=[].concat(Object(d.a)(e.group.requirements),[t]);n("requirements",i)},children:"Add Req Group"}),Object($.jsx)(x.a,{onClick:function(){var t=new N,i=[].concat(Object(d.a)(e.group.requirements),[t]);n("requirements",i)},children:"Add Single Req"})]})})]})]})}var ce=n(48),ae=n(77);function se(e){var t=Object(i.useState)(e.startCollapsed),n=Object(u.a)(t,2),r=n[0],c=n[1];return Object($.jsxs)(h.a,{children:[Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(M.a.Header,{onClick:function(){return c(!r)},children:Object($.jsx)(h.a,{children:Object($.jsxs)(b.a,{children:[Object($.jsx)(f.a,{className:"flex-grow",children:e.title}),Object($.jsx)(f.a,{className:"flex-grow-0",children:r?"\u25bc":"\u25b2"})]})})})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(h.a,{className:r?"d-none":"",children:Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:e.children})})})})})]})}function oe(e){var t=e.allowNone,n=void 0!==t&&t,i=e.allowCustom,r=void 0===i||i,c=Object(ce.a)(e,["allowNone","allowCustom"]),a=Object(s.f)(G);return Object($.jsxs)(A.a,Object(l.a)(Object(l.a)({},c),{},{as:"select",children:[a.map((function(e){return Object($.jsx)("option",{children:e.name},e.id)})),!!n&&Object($.jsx)("option",{value:"",children:"None"}),!!r&&V.map((function(e){return Object($.jsx)("option",{children:e},e)}))]}))}function de(e){var t=e.presetKeys,n=e.adventureProp,r=Object(s.e)(B),c=Object(u.a)(r,2),a=c[0],o=c[1],d=a[n],j=Object(i.useState)(t?t[0]:""),h=Object(u.a)(j,2),b=h[0],f=h[1],O=Object(i.useState)(""),g=Object(u.a)(O,2),v=g[0],m=g[1],p=Object.keys(d);return Object($.jsxs)(ae.a,{size:"sm",children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{children:[Object($.jsx)("th",{children:"Quality"}),Object($.jsx)("th",{children:"Value"}),Object($.jsx)("th",{})]})}),Object($.jsxs)("tbody",{children:[p.map((function(e){return Object($.jsxs)("tr",{children:[Object($.jsx)("td",{children:e}),Object($.jsx)("td",{children:d[e]}),Object($.jsx)("td",{children:Object($.jsx)(x.a,{variant:"danger",onClick:function(){return function(e){var t=Object(l.a)({},d);delete t[e],o(C(a,n,t))}(e)},children:"Delete"})})]},e)})),Object($.jsxs)("tr",{children:[Object($.jsx)("td",{children:t?Object($.jsx)(A.a,{as:"select",value:b,onChange:function(e){return f(e.target.value)},children:t.map((function(e){return Object($.jsx)("option",{children:e},e)}))}):Object($.jsx)(A.a,{value:b,onChange:function(e){return f(e.target.value)}})}),Object($.jsx)("td",{children:Object($.jsx)(A.a,{value:v,onChange:function(e){return m(w(e.target.value))}})}),Object($.jsx)("td",{children:Object($.jsx)(x.a,{onClick:function(){var e=Object(l.a)(Object(l.a)({},d),{},Object(y.a)({},b,v));o(C(a,n,e))},children:"Add"})})]})]})]})}function le(e){var t=e.presetValues,n=e.adventureProp,r=e.unique,c=void 0===r||r,a=Object(s.e)(B),o=Object(u.a)(a,2),l=o[0],j=o[1],h=l[n]||[],b=Object(i.useState)(t?t[0]:""),f=Object(u.a)(b,2),O=f[0],g=f[1];return Object($.jsxs)(v.a,{children:[h.map((function(e){return Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Text,{children:e}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{variant:"danger",onClick:function(){return function(e){var t=h.filter((function(t){return t!==e}));j(C(l,n,t))}(e)},children:"X"})})]},e)})),Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:t?Object($.jsx)(A.a,{as:"select",value:O,onChange:function(e){return g(w(e.target.value))},children:t.map((function(e){return Object($.jsx)("option",{children:e},e)}))}):Object($.jsx)(A.a,{value:O,onChange:function(e){return g(w(e.target.value))}})}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{onClick:function(){if(!(c&&h.indexOf(O)>=0)){var e=[].concat(Object(d.a)(h),[O]);j(C(l,n,e))}},children:"Add"})})]})]})}function ue(e){var t=e.handleChoiceDeletion,n=e.handleChoiceChange,r=Object(i.useState)(e.choice.exit_node),c=Object(u.a)(r,2),a=c[0],s=c[1];return Object($.jsx)(M.a,{children:Object($.jsxs)(M.a.Body,{children:[Object($.jsx)(g.a.Text,{muted:!0,children:"Choice text visible to the player."}),Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Choice"})}),Object($.jsx)(A.a,{value:e.choice.name,onChange:function(e){return n("name",e.target.value)}}),Object($.jsx)(F.a.Append,{children:Object($.jsx)(x.a,{variant:"danger",onClick:t,children:"Delete"})})]}),Object($.jsx)(g.a.Text,{muted:!0,children:"The node navigated to by choosing this choice."}),Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Exit Node"})}),Object($.jsx)(oe,{value:a,onChange:function(e){s(e.target.value),n("exit_node",e.target.value)},allowNone:!1})]}),Object($.jsx)(g.a.Text,{muted:!0,children:"Delay between selecting the choice and entering exit node."}),Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Delay(ds)"})}),Object($.jsx)(A.a,{value:e.choice.delay,onChange:function(e){return n("delay",w(e.target.value))}}),Object($.jsx)(F.a.Text,{children:"Message"}),Object($.jsx)(A.a,{value:e.choice.delay_message,onChange:function(e){return n("delay_message",e.target.value)}})]}),Object($.jsx)(g.a.Text,{muted:!0,children:"Quality changes that happen on selecting this choice. (Before navigating to exit node)"}),Object($.jsx)(te,{title:"Selection Effects",effects:e.choice.on_selection_effects,handleEffectAdded:function(t){return function(t,i){var r=e.choice[t],c=void 0!==r?[].concat(Object(d.a)(r),[i]):[i];n(t,c)}("on_selection_effects",t)},handleEffectsChanged:function(t,i,r){return function(t,i,r,c){var a=Object(l.a)(Object(l.a)({},i),{},Object(y.a)({},r,c)),s=e.choice[t].slice();s[e.choice[t].indexOf(i)]=a,n(t,s)}("on_selection_effects",t,i,r)},handleEffectDeleted:function(t){return function(t,i){var r=e.choice[t].filter((function(e){return e!==i}));n(t,r.length?r:void 0)}("on_selection_effects",t)}}),Object($.jsx)(g.a.Text,{muted:!0,children:"Qualities required for this choice to be availible. Empty set means it's always viable."}),Object($.jsx)(ne,{title:"Requirements",requirements:e.choice.requirements,handleRequirementAdded:function(t){var i=e.choice.requirements,r=void 0!==i?[].concat(Object(d.a)(i),[t]):[t];n("requirements",r)},handleRequirementDeleted:function(t){var i=e.choice.requirements.filter((function(e){return e!==t}));n("requirements",i.length?i:void 0)},handleRequirementsChanged:function(t,i,r){var c=Object(l.a)(Object(l.a)({},t),{},Object(y.a)({},i,r)),a=e.choice.requirements.slice();a[e.choice.requirements.indexOf(t)]=c,n("requirements",a)}})]})})}function je(e){var t=e.handleNodeDeletion,n=Object(s.e)(Q(e.node.id)),r=Object(u.a)(n,2),c=r[0],a=r[1],o=function(t,n){var i=e.node[t],r=void 0!==i?[].concat(Object(d.a)(i),[n]):[n];a(C(c,t,r))},j=function(t,n,i,r){var s=Object(l.a)(Object(l.a)({},n),{},Object(y.a)({},i,r)),o=e.node[t].slice();o[e.node[t].indexOf(n)]=s,a(C(c,t,o))},h=function(t,n){var i=e.node[t].filter((function(e){return e!==n}));a(C(c,t,i.length?i:void 0))},b=c.raw_image?c.raw_image:W[c.image],f=Object(i.useRef)(),O=c.raw_image?"custom image data":c.image;return Object($.jsx)($.Fragment,{children:Object($.jsx)(M.a,{children:Object($.jsxs)(M.a.Body,{children:[Object($.jsxs)(M.a.Title,{children:[c.name," ",Object($.jsx)(x.a,{variant:"danger",onClick:t,children:"Delete"})]}),Object($.jsx)(P.a,{src:b,width:"400px",height:"200px"}),Object($.jsxs)(F.a,{children:[Object($.jsx)(F.a.Prepend,{children:Object($.jsx)(F.a.Text,{children:"Image"})}),Object($.jsx)(g.a.Control,{as:"select",value:O,readOnly:void 0!==c.raw_image,onChange:function(e){a(C(c,"image",e.target.value))},children:Object.keys(W).map((function(e){return Object($.jsx)("option",{children:e},e)}))}),Object($.jsx)(g.a.File,{type:"file",accept:"image/png",ref:f,onChange:function(e){var t=new FileReader;t.onload=function(e){var t=document.createElement("img");t.onload=function(){if(200===t.width&&100===t.height){var n=Object(l.a)(Object(l.a)({},c),{},{raw_image:e.target.result,image:null});a(n)}else alert("Adventure images need to be be 200x100 pngs.")},t.src=e.target.result},t.readAsDataURL(e.target.files[0])},style:{display:"none"}}),Object($.jsxs)(F.a.Append,{children:[Object($.jsx)(x.a,{onClick:function(){f.current.click()},children:"Custom"}),Object($.jsx)(x.a,{onClick:function(){var e=Object(l.a)(Object(l.a)({},c),{},{raw_image:void 0,image:"default"});a(e)},children:"Reset"})]})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Node ID"}),Object($.jsx)(g.a.Text,{muted:!0,children:"Node unique ID, this is not visible to the player"}),Object($.jsx)(A.a,{value:c.name,onChange:function(e){var t=C(c,"name",e.target.value);a(t)}})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Description"}),Object($.jsx)(g.a.Text,{muted:!0,children:"Text shown to the player for this node. You can use $$SITE_NAME to insert exploration site name in the text. Use $$QualityName to place current quality value in text."}),Object($.jsx)(A.a,{as:"textarea",rows:5,placeholder:"Describe whatever here.",value:c.description,onChange:function(e){return a(C(c,"description",e.target.value))}})]}),Object($.jsx)(g.a.Text,{muted:!0,children:"Quality changes that happen when node is entered by any means."}),Object($.jsx)(te,{title:"On Enter Effects",effects:c.on_enter_effects,handleEffectAdded:function(e){return o("on_enter_effects",e)},handleEffectsChanged:function(e,t,n){return j("on_enter_effects",e,t,n)},handleEffectDeleted:function(e){return h("on_enter_effects",e)}}),Object($.jsx)(g.a.Text,{muted:!0,children:"Quality changes that happen when node is exited by any means."}),Object($.jsx)(te,{title:"On Exit Effects",effects:c.on_exit_effects,parent_id:c.id,handleEffectAdded:function(e){return o("on_exit_effects",e)},handleEffectsChanged:function(e,t,n){return j("on_exit_effects",e,t,n)},handleEffectDeleted:function(e){return h("on_exit_effects",e)}}),Object($.jsx)(M.a.Header,{children:"Choices"}),c.choices.map((function(t){return Object($.jsx)(ue,{choice:t,handleChoiceDeletion:function(){return function(t){var n=e.node.choices.filter((function(e){return e!==t}));a(C(c,"choices",n))}(t)},handleChoiceChange:function(n,i){var r=Object(l.a)(Object(l.a)({},t),{},Object(y.a)({},n,i));!function(t,n){var i=e.node.choices.slice();i[e.node.choices.indexOf(t)]=n,a(C(c,"choices",i))}(t,r)}},t.id)})),Object($.jsx)(x.a,{onClick:function(){return function(t){var n=[].concat(Object(d.a)(e.node.choices),[t]);a(C(c,"choices",n))}(new E)},children:"Add Choice"})]})})})}function he(e){var t=e.handleDeletion,n=Object(s.e)(L(e.trigger.id)),i=Object(u.a)(n,2),r=i[0],c=i[1];return Object($.jsx)(M.a,{children:Object($.jsxs)(M.a.Body,{children:[Object($.jsxs)(M.a.Title,{children:["Trigger ",Object($.jsx)(x.a,{variant:"danger",onClick:t,children:"Delete"})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Trigger ID"}),Object($.jsx)(A.a,{value:r.name,onChange:function(e){c(C(r,"name",e.target.value))}})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Target Node On Trigger"}),Object($.jsx)(oe,{allowNone:!0,value:r.target_node,onChange:function(e){c(C(r,"target_node",e.target.value))}})]}),Object($.jsx)(te,{title:"On Trigger Effects",effects:r.on_trigger_effects,handleEffectAdded:function(t){return function(t,n){var i=e.trigger[t],a=void 0!==i?[].concat(Object(d.a)(i),[n]):[n];c(C(r,t,a))}("on_trigger_effects",t)},handleEffectsChanged:function(t,n,i){return function(t,n,i,a){var s=Object(l.a)(Object(l.a)({},n),{},Object(y.a)({},i,a)),o=e.trigger[t].slice();o[e.trigger[t].indexOf(n)]=s,c(C(r,t,o))}("on_trigger_effects",t,n,i)},handleEffectDeleted:function(t){return function(t,n){var i=e.trigger[t].filter((function(e){return e!==n}));c(C(r,t,i.length?i:void 0))}("on_trigger_effects",t)}}),Object($.jsx)(ne,{title:"Trigger Requirements",requirements:e.trigger.requirements,handleRequirementAdded:function(t){var n=e.trigger.requirements,i=void 0!==n?[].concat(Object(d.a)(n),[t]):[t];c(C(r,"requirements",i))},handleRequirementDeleted:function(t){var n=e.trigger.requirements.filter((function(e){return e!==t}));c(C(r,"requirements",n.length?n:void 0))},handleRequirementsChanged:function(t,n,i){var a=Object(l.a)(Object(l.a)({},t),{},Object(y.a)({},n,i)),s=e.trigger.requirements.slice();s[e.trigger.requirements.indexOf(t)]=a,c(C(r,"requirements",s))}})]})})}var be=n(79);function fe(e){var t,n=Object(s.e)(B),r=Object(u.a)(n,1)[0],c=Object(i.useState)(r.nodes.find((function(e){return e.name===r.starting_node}))||r.nodes[0]),a=Object(u.a)(c,2),d=a[0],j=a[1],O=Object(i.useState)(r.starting_qualities),g=Object(u.a)(O,2),v=g[0],A=g[1],m=Object(i.useState)(d?d.name:""),p=Object(u.a)(m,2),_=p[0],y=p[1],q=function(e){switch(e.operator){case"==":if(v[e.quality]===e.value)return!0;break;case"!=":if(v[e.quality]!==e.value)return!0;break;case"<=":if(v[e.quality]<=e.value)return!0;break;case">=":if(v[e.quality]>=e.value)return!0;break;case">":if(v[e.quality]>e.value)return!0;break;case"<":if(v[e.quality]<e.value)return!0;break;default:alert("Unknown operator")}},C=function e(t,n){switch(n){case"AND":var i,r=Object(o.a)(t);try{for(r.s();!(i=r.n()).done;){var c=i.value;if(void 0!==c.group_type){if(!e(c.requirements,c.group_type))return!1}else if(!q(c))return!1}}catch(l){r.e(l)}finally{r.f()}return!0;case"OR":var a,s=Object(o.a)(t);try{for(s.s();!(a=s.n()).done;){var d=a.value;if(void 0!==d.group_type){if(e(d,d.group_type))return!0}else if(q(d))return!0}}catch(l){s.e(l)}finally{s.f()}return!1;default:alert("wrong group_type")}},w=function(e){return void 0===e.requirements||C(e.requirements,"AND")},k=function e(t){if(void 0===d.on_exit_effects||!E(d.on_exit_effects))switch(t){case"WIN":alert("Here you would complete the adventure in real game and recieve loot.");break;case"FAIL":alert("Here you would lose the adventure in real game and get dealt half integrity as damage.");break;case"FAIL_DEATH":alert("Here you would lose the adventure in real game and blown up.");break;case"GO_BACK":e(_);break;default:var n=r.nodes.find((function(e){return e.name===t}));if(j(n),_!==n.name&&y(n.name),void 0!==n.on_enter_effects&&E(n.on_enter_effects))return}},R=[],D=function(){if(void 0!==r.triggers){var e,t=Object(o.a)(r.triggers);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(C(n.requirements,"AND")){if(!R.includes(n))return R.push(n),void 0!==n.on_trigger_effects&&E(n.on_trigger_effects)||void 0!==n.target_node&&k(n.target_node),!0;alert("Recursive trigger detected. ".concat(n.name))}}}catch(i){t.e(i)}finally{t.f()}}return R.length=0,!1},T=function(e){if(e===Object(e))switch(e.value_type){case z.random:return t=e.low,n=e.high,t=Math.ceil(t),n=Math.floor(n+1),Math.floor(Math.random()*(n-t)+t);default:alert("wrong value type")}var t,n;return e},E=function(e){var t,n=Object(l.a)({},v),i=Object(o.a)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value,c=T(r.value);switch(r.effect_type){case Y.Add:n[r.quality]=(n[r.quality]||0)+c;break;case Y.Set:n[r.quality]=c;break;case Y.Remove:delete n[r.quality];break;default:alert("wrong effect type")}}}catch(a){i.e(a)}finally{i.f()}return A(n),!!D()};return d?Object($.jsxs)(h.a,{children:[Object($.jsx)(be.a,{variant:"danger",children:"Delays are not implemented. Choices shown as disabled would not be visible in-game"}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(x.a,{onClick:function(){j(r.nodes.find((function(e){return e.name===r.starting_node}))||r.nodes[0]),A(r.starting_qualities),y(d.name)},children:"Restart"})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsxs)(M.a,{children:[Object($.jsx)(M.a.Img,{src:d.raw_image?d.raw_image:W[d.image]}),Object($.jsxs)(M.a.Body,{children:[Object($.jsx)(M.a.Text,{children:(t=d.description,t.replace(/\$\$(\S*)/g,(function(e,t){switch(t){case"SITE_NAME":return"SITE NAME WOULD GO HERE";default:return v[t]}})))}),Object($.jsx)(h.a,{children:d.choices.map((function(e){return Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(x.a,{disabled:!w(e),onClick:function(){return function(e){void 0!==e.on_selection_effects&&E(e.on_selection_effects)||k(e.exit_node)}(e)},children:e.name})})},e.id)}))})]})]})})}),Object($.jsx)(b.a,{children:Object($.jsxs)(ae.a,{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{children:[Object($.jsx)("th",{children:"Quality"}),Object($.jsx)("th",{children:"Value"})]})}),Object($.jsx)("tbody",{children:Object.keys(v).map((function(e){return Object($.jsxs)("tr",{children:[Object($.jsx)("td",{children:e}),Object($.jsx)("td",{children:v[e]})]},e)}))})]})})]}):Object($.jsx)(be.a,{variant:"danger",children:"You need at least one node to play."})}function Oe(){var e=Object(s.e)(B),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(s.f)(G),a=Object(s.f)(U),_=Object(i.useState)(""),y=Object(u.a)(_,2),q=y[0],w=y[1],k=Object(i.useState)(null),E=Object(u.a)(k,2),S=E[0],I=E[1],N=function e(t){var n,i=Object(o.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.id=R("req"),void 0!==r.group_type&&void 0!==r.requirements&&e(r.requirements)}}catch(c){i.e(c)}finally{i.f()}},Q=function(e){var t,n=Object(o.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.id=R("effect")}}catch(i){n.e(i)}finally{n.f()}},L=Object(i.useRef)(),M=Object(i.useRef)(),P=q||function(){if(c.length)return c[0].id.toString()}(),F=n.starting_node||function(){if(c.length)return c[0].name}(),K=Object(i.useState)(!1),H=Object(u.a)(K,2),V=H[0],W=H[1],Y=function(){W(!V)};return Object($.jsxs)($.Fragment,{children:[Object($.jsx)(j.a,{show:V,onHide:Y,children:Object($.jsx)(fe,{adventure:n})}),Object($.jsxs)(h.a,{children:[Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsxs)(O.a,{children:[Object($.jsx)(x.a,{onClick:function(){var e={adventure_name:n.name,author:n.author,starting_node:F,starting_qualities:n.starting_qualities,required_site_traits:n.required_site_traits,loot_categories:n.loot_types,scan_band_mods:n.band_modifiers,deep_scan_description:n.deep_scan_description,triggers:n.triggers,nodes:c},t=new Blob([JSON.stringify(e,(function(e,t){if("id"!==e)return t}))],{type:"application/json"}),i=URL.createObjectURL(t);M.current.href=i,M.current.download="".concat(n.name,".json"),M.current.click()},children:"Export"}),Object($.jsx)("a",{ref:M,style:{display:"none"},href:"/",children:"God is this really how JS supposed to work"}),Object($.jsx)(x.a,{onClick:function(){L.current.click()},children:"Import"}),Object($.jsx)(g.a.File,{onChange:function(e){var t=new FileReader;t.onload=function(e){var t=JSON.parse(e.target.result),i=function(e){var t,n=Object(o.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.id=R("Node");var r,c=Object(o.a)(i.choices);try{for(c.s();!(r=c.n()).done;){var a=r.value;a.id=R("choice"),void 0!==a.on_selection_effects&&Q(a.on_selection_effects),void 0!==a.requirements&&N(a.requirements)}}catch(s){c.e(s)}finally{c.f()}void 0!==i.on_enter_effects&&Q(i.on_enter_effects),void 0!==i.on_exit_effects&&Q(i.on_exit_effects)}}catch(s){n.e(s)}finally{n.f()}return e}(t.nodes),c=function(e){var t,n=Object(o.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.id=R("trigger"),void 0!==i.requirements&&N(i.requirements),void 0!==i.on_trigger_effects&&Q(i.on_trigger_effects)}}catch(r){n.e(r)}finally{n.f()}return e}(t.triggers),a=Object(l.a)(Object(l.a)({},n),{},{name:t.adventure_name,author:t.author,starting_node:t.starting_node,starting_qualities:t.starting_qualities,required_site_traits:t.required_site_traits,band_modifiers:t.scan_band_mods,loot_types:t.loot_categories,triggers:c,nodes:i});r(a)},t.readAsText(e.target.files[0])},accept:".json",ref:L,style:{display:"none"}}),Object($.jsx)(x.a,{onClick:Y,children:"Test"})]})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(se,{title:"Adventure Config",children:Object($.jsxs)(g.a,{children:[Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Adventure name"}),Object($.jsx)(g.a.Text,{muted:!0,children:"Adventure name, should be specific as possible since it needs to be unique among all adventures"}),Object($.jsx)(A.a,{placeholder:"New adventure",value:n.name,onChange:function(e){return r(C(n,"name",e.target.value))}})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Author"}),Object($.jsx)(g.a.Text,{muted:!0,children:"Your name"}),Object($.jsx)(A.a,{value:n.author,onChange:function(e){return r(C(n,"author",e.target.value))}})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Starting node"}),Object($.jsx)(g.a.Text,{muted:!0,children:"This is the node the adventure will being at. On Enter effects WILL fire for this node."}),Object($.jsx)(oe,{value:F,onChange:function(e){return r(C(n,"starting_node",e.target.value))},allowCustom:!1})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Starting qualities"}),Object($.jsx)(g.a.Text,{muted:!0,children:"These qualities will be set once before adventure begins on top of qualities provided by drone equipment."}),Object($.jsx)(de,{adventureProp:"starting_qualities"})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Required site traits"}),Object($.jsx)(g.a.Text,{muted:!0,children:"This adventure will only appear on exploration sites with all these traits"}),Object($.jsx)(le,{presetValues:J,adventureProp:"required_site_traits"})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Loot type"}),Object($.jsx)(g.a.Text,{muted:!0,children:"Generator type used for adventure loot when win node is reached."}),Object($.jsx)(le,{presetValues:Z,adventureProp:"loot_types"})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Scanning modifiers"}),Object($.jsx)(g.a.Text,{muted:!0,children:"These modifiers will be applied to point scan results of the exploration site with this adventure."}),Object($.jsx)(de,{presetKeys:X,adventureProp:"band_modifiers"})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)(g.a.Label,{children:"Deep scan description"}),Object($.jsx)(g.a.Text,{muted:!0,children:"This description will be added to exploration site's description after a deep scan."}),Object($.jsx)(A.a,{value:n.deep_scan_description,onChange:function(e){return r(C(n,"deep_scan_description",e.target.value))}})]})]})})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(se,{title:"Nodes",children:Object($.jsxs)(m.a.Container,{id:"nodes",activeKey:P,onSelect:function(e){return w(e)},children:[Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsxs)(p.a,{variant:"tabs",children:[c.map((function(e){return Object($.jsx)(p.a.Item,{draggable:!0,onDragEnd:function(e){I(null)},onDragStart:function(t){return function(e,t){I(t)}(0,e)},onDrop:function(){return function(e){if(null!=S){var t=c.indexOf(e),i=c.indexOf(S),a=c.slice(),s=[a[i],a[t]];a[t]=s[0],a[i]=s[1],r(C(n,"nodes",a))}}(e)},onDragOver:function(t){return function(e,t){null!=S&&t!==S&&e.preventDefault()}(t,e)},children:Object($.jsx)(p.a.Link,{eventKey:e.id,children:e.name})},e.id)})),Object($.jsx)(p.a.Item,{children:Object($.jsx)(p.a.Link,{onClick:function(){var e=Object(l.a)(Object(l.a)({},n),{},{nodes:[].concat(Object(d.a)(c),[new D])});r(e)},children:"Add Node"})})]})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(m.a.Content,{children:c.map((function(e){return Object($.jsx)(m.a.Pane,{eventKey:e.id,children:Object($.jsx)(je,{node:e,handleNodeDeletion:function(){return function(e){var t=c.findIndex((function(t){return t===e})),i=c.filter((function(t){return t!==e}));if(r(C(n,"nodes",i)),i.length){var a=Math.max(0,t-1);w(i[a].id)}}(e)}})},e.id)}))})})})]})})})}),Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(se,{title:"Triggers",startCollapsed:!0,children:Object($.jsxs)(h.a,{children:[Object($.jsx)(b.a,{children:Object($.jsx)(f.a,{children:Object($.jsx)(g.a.Text,{muted:!0,children:"Triggers are checks that happen after any quality changes. If requirements are met the effects and/or node changes are applied over the choice that made it happen."})})}),Object($.jsxs)(b.a,{children:[a.map((function(e){return Object($.jsx)(f.a,{xl:"auto",children:Object($.jsx)(he,{trigger:e,handleDeletion:function(){return function(e){var t=a.filter((function(t){return t!==e}));r(C(n,"triggers",t))}(e)}})},e.id)})),Object($.jsx)(f.a,{children:Object($.jsx)(x.a,{onClick:function(){var e=Object(l.a)(Object(l.a)({},n),{},{triggers:[].concat(Object(d.a)(a),[new T])});r(e)},children:"Add Trigger"})})]})]})})})})]})]})}var xe=function(){return Object($.jsx)(s.a,{children:Object($.jsx)(Oe,{})})},ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),i(e),r(e),c(e),a(e)}))};a.a.render(Object($.jsx)(r.a.StrictMode,{children:Object($.jsx)(xe,{})}),document.getElementById("root")),ge()}},[[69,1,2]]]);
//# sourceMappingURL=main.7b75fcdb.chunk.js.map