{"version":3,"sources":["Helpers.js","State.js","ExternalDefines.js","images/default.png","images/grue.png","images/signal_lost.png","images/trade.png","Components/EffectBuilder.js","Components/RequirementsBuilder.js","Components/Utility.js","Components/AdventureChoice.js","Components/AdventureNode.js","Components/AdventureTrigger.js","Components/AdventurePlayer.js","Components/AdventureEditor.js","App.js","reportWebVitals.js","index.js"],"names":["replaceItemInArray","arr","oldVal","newValue","modifed","slice","indexOf","updateProp","obj","prop_name","new_value","convertNumberValue","value","as_number","Number","isFinite","isNaN","global_ids","unique_id","category","NodeData","this","id","name","description","choices","image","image_raw","undefined","on_enter_effects","on_exit_effects","TriggerData","target_node","on_trigger_effects","requirements","ChoiceData","key","exit_node","on_selection_effects","delay","delay_message","EffectData","effect_type","quality","ReqGroupData","group_type","ReqData","operator","AdventureState","atom","default","starting_node","nodes","triggers","required_site_traits","loot_types","band_modifiers","starting_qualities","deep_scan_description","NodesSelector","selector","get","NodeSelector","selectorFamily","find","x","set","current","modified","TriggersSelector","TriggerSelector","special_nodes","site_traits","scan_bands","preset_images","grue","signal_lost","trader","EffectTypes","Add","Set","Remove","ValueTypes","raw","random","Effect","props","handleChange","handleDelete","value_type","effect","Object","InputGroup","FormControl","as","onChange","e","target","keys","map","k","Prepend","Text","low","high","value_type_controls","Append","Button","onClick","allowed_types","current_index","new_type","length","defaultForValueType","variant","EffectBuilder","handleEffectsChanged","handleEffectAdded","handleEffectDeleted","add_effect","effects","Card","Header","title","ListGroup","ListGroupItem","prop","RequirementsBuilder","handleRequirementsChanged","handleRequirementAdded","handleRequirementDeleted","add_req","req","ReqGroup","group","handleReqGroupChanged","handleReqGroupDeleted","SingleReq","requirement","handleReqChanged","handleReqDeleted","Item","ButtonGroup","deleteSubReq","deleted","new_reqs","filter","updateSubReq","old_req","changed_req","border","new_group","new_req","BasicCollapsible","useState","startCollapsed","sectionCollapsed","setSectionCollapsed","Container","Row","Col","className","children","NodeSelectionDropdown","allowNone","allowCustom","rest","useRecoilState","node","KeyValueList","presetKeys","adventureProp","adventure","setAdventure","store","newKey","setNewKey","setNewValue","store_keys","Table","size","newstore","remove_key","pk","SimpleList","presetValues","unique","FormGroup","remove_value","AdventureChoice","handleChoiceDeletion","handleChoiceChange","choice","exitNodeSelectValue","setExitNodeSelectValue","Body","added","effect_prop","new_effect","old_effects","new_effects","addEffect","old","old_effect","changed_prop","changed_effect","updateEffects","removed","deleteEffect","old_reqs","AdventureNode","handleNodeDeletion","setNode","current_image","raw_image","imageInput","useRef","image_name_text","Title","Image","src","width","height","Form","Control","readOnly","File","type","accept","ref","reader","FileReader","onload","uploaded_image","modified_node","result","alert","readAsDataURL","files","style","display","click","Label","rows","placeholder","parent_id","new_choices","removeChoice","choice_property","new_choice","old_choice","updateChoice","addChoice","AdventureTrigger","handleDeletion","trigger","setTrigger","AdventurePlayer","currentNode","setCurrentNode","qualities","setQualities","prevNode","setPrevNode","checkReq","check_group","req_group","checkChoice","navigateToNode","node_name","apply_effects","next_node","triggerGuard","checkTriggers","includes","push","extractValue","min","max","Math","ceil","floor","effect_list","extractedValue","a","b","c","Alert","Img","disabled","selectChoice","qname","AdventureEditor","activeTab","setActiveTab","draggedItem","setDraggedItem","regenerate_reqs","req_list","regenerate_effects","ImportInput","ExportLink","openTab","toString","getDefaultTab","startingNode","getDefaultStartingNode","playing","setPlaying","toggle_playing","Modal","show","onHide","data_object","adventure_name","loot_categories","scan_band_mods","blob","Blob","JSON","stringify","blob_url","URL","createObjectURL","href","download","parse","reindexed_nodes","node_list","regenerate_ids","reindexed_triggers","trigger_list","regenerate_trigger_ids","modified_adventure","readAsText","Tab","activeKey","onSelect","Nav","draggable","onDragEnd","onDragStart","start_dragging","onDrop","index_a","index_b","modified_nodes","switch_node","onDragOver","preventDefault","validate_drop","Link","eventKey","Content","Pane","changed_nodes","delete_node","xl","changed_triggers","delete_trigger","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"gXACO,SAASA,EAAmBC,EAAKC,EAAQC,GAC5C,IAAMC,EAAUH,EAAII,QAEpB,OADAD,EAAQH,EAAIK,QAAQJ,IAAWC,EACxBC,EAGJ,SAASG,EAAWC,EAAKC,EAAWC,GACvC,OAAO,2BAAKF,GAAZ,kBAAkBC,EAAYC,IAG3B,SAASC,EAAmBC,GAC/B,IAAMC,EAAYC,OAAOF,GACzB,OAAGE,OAAOC,SAASF,KAAeC,OAAOE,MAAMH,GACtCA,EAEFD,ECZJ,IAAMK,EAAa,GACnB,SAASC,EAAUC,GAEtB,OADAA,KAAYF,EAAaA,EAAWE,IAAa,EAAIF,EAAWE,GAAY,EACtE,GAAN,OAAUA,EAAV,YAAsBF,EAAWE,IAI9B,IAcMC,EACT,aAAe,oBACXC,KAAKC,GAAKJ,EAAU,QACpBG,KAAKE,KAAOF,KAAKC,GACjBD,KAAKG,YAAc,6BACnBH,KAAKI,QAAU,GACfJ,KAAKK,MAAQ,UACbL,KAAKM,eAAYC,EACjBP,KAAKQ,sBAAmBD,EACxBP,KAAKS,qBAAkBF,GAIlBG,EACT,aAAc,oBACVV,KAAKC,GAAKJ,EAAU,WACpBG,KAAKE,KAAO,UACZF,KAAKW,iBAAcJ,EACnBP,KAAKY,wBAAqBL,EAC1BP,KAAKa,kBAAeN,GAIfO,EACT,aAAe,oBACXd,KAAKC,GAAKJ,EAAU,UACpBG,KAAKe,IAAMf,KAAKC,GAChBD,KAAKE,KAAO,aACZF,KAAKgB,UAAY,OACjBhB,KAAKiB,0BAAuBV,EAC5BP,KAAKa,kBAAeN,EACpBP,KAAKkB,MAAQ,EACblB,KAAKmB,mBAAgBZ,GAIhBa,EACT,aAAe,oBACXpB,KAAKC,GAAKJ,EAAU,UACpBG,KAAKqB,YAAc,MACnBrB,KAAKsB,QAAU,UACftB,KAAKT,MAAQ,GAIRgC,EACT,aAAe,oBACXvB,KAAKC,GAAKJ,EAAU,OACpBG,KAAKwB,WAAa,MAClBxB,KAAKa,aAAe,IAIfY,EACT,aAAe,oBACXzB,KAAKC,GAAKJ,EAAU,OACpBG,KAAKsB,QAAU,UACftB,KAAK0B,SAAW,KAChB1B,KAAKT,MAAQ,GAIRoC,EAAiBC,YAAK,CAC/Bb,IAAK,YACLc,QAAS,IA7ET,aAAe,oBACX7B,KAAKE,KAAO,gBACZF,KAAK8B,cAAgB,GACrB9B,KAAK+B,MAAQ,GACb/B,KAAKgC,SAAW,GAChBhC,KAAKiC,qBAAuB,GAC5BjC,KAAKkC,WAAa,GAClBlC,KAAKmC,eAAiB,GACtBnC,KAAKoC,mBAAqB,GAC1BpC,KAAKqC,sBAAyB,MAuEzBC,EAAgBC,YAAS,CAClCxB,IAAK,QACLyB,IAAK,YAED,OADkBA,EADJ,EAAVA,KACkBb,GACLI,SAIZU,EAAeC,YAAe,CACvC3B,IAAK,cACLyB,IAAK,SAACvC,GAAD,OAAQ,YAET,OADkBuC,EADI,EAAVA,KACUb,GACLI,MAAMY,MAAK,SAAAC,GAAC,OAAIA,EAAE3C,KAAOA,OAE9C4C,IAAK,SAAC5C,GAAD,OAAQ,WAAenB,GAAc,IAA1B+D,EAAyB,EAAzBA,IACNC,GAAUN,EADqB,EAApBA,KACGb,GACdoB,EAAQ,2BAAQD,GAAR,IAAiBf,MAAOpD,EAAmBmE,EAAQf,MAAOe,EAAQf,MAAMY,MAAK,SAAAC,GAAC,OAAIA,EAAE3C,KAAOA,KAAKnB,KAC9G+D,EAAIlB,EAAgBoB,OAIfC,EAAmBT,YAAS,CACrCxB,IAAK,WACLyB,IAAK,YAED,OADkBA,EADJ,EAAVA,KACkBb,GACLK,YAIZiB,EAAkBP,YAAe,CAC1C3B,IAAK,iBACLyB,IAAK,SAACvC,GAAD,OAAQ,YAET,OADkBuC,EADI,EAAVA,KACUb,GACLK,SAASW,MAAK,SAAAC,GAAC,OAAIA,EAAE3C,KAAOA,OAEjD4C,IAAK,SAAC5C,GAAD,OAAQ,WAAenB,GAAc,IAA1B+D,EAAyB,EAAzBA,IACNC,GAAUN,EADqB,EAApBA,KACGb,GACdoB,EAAQ,2BAAQD,GAAR,IAAiBd,SAAUrD,EAAmBmE,EAAQd,SAAUc,EAAQd,SAASW,MAAK,SAAAC,GAAC,OAAIA,EAAE3C,KAAOA,KAAKnB,KACvH+D,EAAIlB,EAAgBoB,O,wCC7HfG,EAAgB,CAAC,OAAO,aAAa,MAAM,WAE3CC,EAAc,CAAC,QAAQ,qBAAqB,gBAAgB,QAAQ,YAAY,YAAY,WAAW,cAEvGC,EAAa,CAAC,yBAAyB,gCAAgC,0BAA0B,mBAAmB,qBAEpHlB,EAAa,CAAC,QAAQ,QAAQ,WAAW,UAAU,OAAO,UAG1DmB,EAAgB,CACzBxB,QCfW,ybDgBXyB,KEhBW,6TFiBXC,YGjBW,ieHkBXC,OIlBW,ksBJqBFC,EAAc,CACvBC,IAAM,MACNC,IAAM,MACNC,OAAS,UAGAC,EAAa,CACtBC,IAAM,MACNC,OAAS,U,OKxBb,SAASC,GAAOC,GACZ,IAAMC,EAAeD,EAAMC,aACrBC,EAAeF,EAAME,aACrBC,EAAaH,EAAMI,OAAO9E,QAAU+E,OAAOL,EAAMI,OAAO9E,OAAS0E,EAAMI,OAAO9E,MAAb,WAAmC,MAsC1G,OACI,eAACgF,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CAAaC,GAAG,SAASlF,MAAO0E,EAAMI,OAAOhD,YAAaqD,SAAU,SAAAC,GAAC,OAAIT,EAAa,cAAeS,EAAEC,OAAOrF,QAA9G,SACK+E,OAAOO,KAAKpB,GAAaqB,KAAI,SAAAC,GAAC,OAAK,iCAAiBtB,EAAYsB,IAAhBA,QAErD,cAACR,EAAA,EAAWS,QAAZ,UACI,cAACT,EAAA,EAAWU,KAAZ,wBAEJ,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAMI,OAAO/C,QAASoD,SAAU,SAAAC,GAAC,OAAIT,EAAa,UAAWS,EAAEC,OAAOrF,UAC1F,cAACgF,EAAA,EAAWS,QAAZ,UACI,cAACT,EAAA,EAAWU,KAAZ,sBA5BgB,SAAAb,GACxB,OAAQA,GACJ,IAAK,SACD,OACI,qCACI,cAACG,EAAA,EAAWU,KAAZ,qBACA,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAMI,OAAO9E,MAAM2F,IAAKR,SAAU,SAAAC,GAAC,OAAIT,EAAa,QAAD,YAAC,eAAaD,EAAMI,OAAO9E,OAA3B,IAAiC2F,IAAI5F,EAAmBqF,EAAEC,OAAOrF,aACxI,cAACgF,EAAA,EAAWU,KAAZ,iBACA,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAMI,OAAO9E,MAAM4F,KAAMT,SAAU,SAAAC,GAAC,OAAIT,EAAa,QAAD,YAAC,eAAYD,EAAMI,OAAO9E,OAA1B,IAAgC4F,KAAK7F,EAAmBqF,EAAEC,OAAOrF,gBAGrJ,IAAK,MACD,OAAQ,cAACiF,EAAA,EAAD,CAAajF,MAAO0E,EAAMI,OAAO9E,MAAOmF,SAAU,SAAAC,GAAC,OAAIT,EAAa,QAAS5E,EAAmBqF,EAAEC,OAAOrF,WACrH,QACI,OAAQ,cAACgF,EAAA,EAAWU,KAAZ,2BAgBXG,CAAoBhB,GAErB,eAACG,EAAA,EAAWc,OAAZ,WACI,cAACC,EAAA,EAAD,CAAQC,QAxCW,SAAAZ,GAC3B,IAAMa,EAAgBlB,OAAOO,KAAKhB,GAAYiB,KAAI,SAAAC,GAAC,OAAIlB,EAAWkB,MAC5DU,EAAgBD,EAAcvG,QAAQmF,GACtCsB,EAAWF,GAAeC,EAAc,GAAGD,EAAcG,QAC/DzB,EAAa,QAfW,SAAAE,GACxB,OAAOA,GACH,KAAKP,EAAWC,IACZ,OAAO,EACX,KAAKD,EAAWE,OACb,MAAO,CAAE,WAAcF,EAAWE,OAAQ,IAAO,EAAG,KAAQ,GAC/D,QACI,OAAO,GAQM6B,CAAoBF,KAoCjC,eACA,cAACJ,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAASpB,EAAlC,0BAKT,SAAS2B,GAAc7B,GAC1B,IAAM8B,EAAuB9B,EAAM8B,qBAC7BC,EAAoB/B,EAAM+B,kBAC1BC,EAAsBhC,EAAMgC,oBAClC,SAASC,IACLF,EAAkB,IAAI5E,GAG1B,OAAK6C,EAAMkC,QAcP,qCACI,cAACC,EAAA,EAAKC,OAAN,UAAcpC,EAAMqC,QACpB,eAACC,EAAA,EAAD,WACKtC,EAAMkC,QAAQrB,KAAI,SAAAT,GAAM,OACrB,cAACmC,EAAA,EAAD,UACI,cAACxC,GAAD,CACIK,OAAQA,EACRH,aAAc,SAACuC,EAAMlH,GAAP,OAAiBwG,EAAqB1B,EAAQoC,EAAMlH,IAClE4E,aAAc,SAACsC,EAAMlH,GAAP,OAAiB0G,EAAoB5B,EAAQoC,EAAMlH,OAJrD8E,EAAOpE,OAM/B,cAACuG,EAAA,EAAD,UACI,cAAClB,EAAA,EAAD,CAAQC,QAASW,EAAjB,oCAvBR,eAAC3B,EAAA,EAAD,WACI,cAACA,EAAA,EAAWS,QAAZ,UACI,cAACT,EAAA,EAAWU,KAAZ,UACKhB,EAAMqC,UAGf,cAAC/B,EAAA,EAAWc,OAAZ,UACI,cAACC,EAAA,EAAD,CAAQC,QAASW,EAAjB,gCChFb,SAASQ,GAAoBzC,GAChC,IAAM0C,EAA4B1C,EAAM0C,0BAClCC,EAAyB3C,EAAM2C,uBAC/BC,EAA2B5C,EAAM4C,yBAMvC,SAASC,IACPF,EAAuB,IAAInF,GAG7B,OAAKwC,EAAMpD,aAcT,qCACA,cAACuF,EAAA,EAAKC,OAAN,UAAcpC,EAAMqC,QACpB,eAACC,EAAA,EAAD,WACGtC,EAAMpD,aAAaiE,KAAI,SAAAiC,GACtB,OAAOA,EAAIlG,aACT,cAACmG,GAAD,CAEEC,MAAOF,EACPG,sBAAuB,SAAC9H,EAAUC,GAAX,OAAyBsH,EAA0BI,EAAK3H,EAAWC,IAC1F8H,sBAAuB,kBAAMN,EAAyBE,KAHjDA,EAAI9G,IAKV,cAACmH,GAAD,CAECC,YAAaN,EACbO,iBAAkB,SAAClI,EAAWC,GAAZ,OAA0BsH,EAA0BI,EAAK3H,EAAWC,IACtFkI,iBAAkB,kBAAMV,EAAyBE,KAH5CA,EAAI9G,OAMf,cAACsG,EAAA,EAAUiB,KAAX,UACE,eAACC,EAAA,EAAD,WACE,cAACnC,EAAA,EAAD,CAAQC,QA1ChB,WACEqB,EAAuB,IAAIrF,IAyCrB,2BACA,cAAC+D,EAAA,EAAD,CAAQC,QAASuB,EAAjB,uCAjCN,eAACvC,EAAA,EAAD,WACE,cAACA,EAAA,EAAWS,QAAZ,UACE,cAACT,EAAA,EAAWU,KAAZ,UACGhB,EAAMqC,UAGX,cAAC/B,EAAA,EAAWc,OAAZ,UACE,cAACC,EAAA,EAAD,CAAQC,QAASuB,EAAjB,mCAkCR,SAASM,GAAUnD,GACjB,IAAMsD,EAAmBtD,EAAMsD,iBACzBD,EAAmBrD,EAAMqD,iBAC/B,OACE,eAAC/C,EAAA,EAAD,WACE,cAACA,EAAA,EAAWS,QAAZ,UACE,cAACT,EAAA,EAAWU,KAAZ,wBAEF,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAMoD,YAAY/F,QAASoD,SAAU,SAAAC,GAAC,OAAI2C,EAAiB,UAAW3C,EAAEC,OAAOrF,UACnG,eAACiF,EAAA,EAAD,CAAaC,GAAG,SAASlF,MAAO0E,EAAMoD,YAAY3F,SAAUgD,SAAU,SAAAC,GAAC,OAAI2C,EAAiB,WAAY3C,EAAEC,OAAOrF,QAAjH,UACE,wCACA,wCACA,uCACA,uCACA,wCACA,2CAEF,cAACiF,EAAA,EAAD,CAAajF,MAAO0E,EAAMoD,YAAY9H,MAAOmF,SAAU,SAAAC,GAAC,OAAI2C,EAAiB,QAAShI,EAAmBqF,EAAEC,OAAOrF,WAClH,cAACgF,EAAA,EAAWc,OAAZ,UACE,cAACC,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAAS,kBAAMgC,EAAiBtD,EAAMoD,cAA/D,yBAMR,SAASL,GAAS/C,GAChB,IAAMkD,EAAwBlD,EAAMkD,sBAC9BD,EAAwBjD,EAAMiD,sBAc9BQ,EAAe,SAACC,GACpB,IAAMC,EAAW3D,EAAMgD,MAAMpG,aAAagH,QAAO,SAAAjF,GAAC,OAAIA,IAAM+E,KAC5DT,EAAsB,eAAeU,IAGjCE,EAAe,SAACC,EAAQtB,EAAKpH,GACjC,IAAM2I,EAAW,2BAAOD,GAAP,kBAAiBtB,EAAMpH,IAClCuI,EAAW3D,EAAMgD,MAAMpG,aAAa7B,QAC1C4I,EAAS3D,EAAMgD,MAAMpG,aAAa5B,QAAQ8I,IAAYC,EACtDd,EAAsB,eAAeU,IAGvC,OACE,eAACxB,EAAA,EAAD,CAAM6B,OAAO,OAAb,UACE,cAAC7B,EAAA,EAAKC,OAAN,UACE,eAAC9B,EAAA,EAAD,WACE,eAACC,EAAA,EAAD,CAAaC,GAAG,SAASlF,MAAO0E,EAAMgD,MAAMzF,WAAYkD,SAAU,SAAAC,GAAC,OAAIuC,EAAsB,aAAavC,EAAEC,OAAOrF,QAAnH,UACE,yCACA,2CAEF,cAACgF,EAAA,EAAWU,KAAZ,oBACA,cAACV,EAAA,EAAWc,OAAZ,UACE,cAACC,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAAS,kBAAM4B,EAAsBlD,EAAMgD,QAApE,2BAIN,eAACV,EAAA,EAAD,WACE,cAACA,EAAA,EAAUiB,KAAX,UACGvD,EAAMgD,MAAMpG,aAAaiE,KAAI,SAAAiC,GAC5B,OAAOA,EAAIlG,aACR,cAACmG,GAAD,CAECC,MAAOF,EACPI,sBAAuBO,EACvBR,sBAAuB,SAACT,EAAKpH,GAAN,OAAoByI,EAAaf,EAAIN,EAAKpH,KAH5D0H,EAAI9G,IAKV,cAACmH,GAAD,CAECC,YAAaN,EACbQ,iBAAkBG,EAClBJ,iBAAkB,SAACb,EAAKpH,GAAN,OAAoByI,EAAaf,EAAIN,EAAKpH,KAHvD0H,EAAI9G,SAOjB,cAACsG,EAAA,EAAUiB,KAAX,UACE,eAACC,EAAA,EAAD,WACE,cAACnC,EAAA,EAAD,CAAQC,QA1DE,WAClB,IAAM2C,EAAY,IAAI3G,EAChBqG,EAAQ,sBAAO3D,EAAMgD,MAAMpG,cAAnB,CAAiCqH,IAC/ChB,EAAsB,eAAeU,IAuD7B,2BACA,cAACtC,EAAA,EAAD,CAAQC,QArDA,WAChB,IAAM4C,EAAU,IAAI1G,EACdmG,EAAQ,sBAAO3D,EAAMgD,MAAMpG,cAAnB,CAAiCsH,IAC/CjB,EAAsB,eAAeU,IAkD7B,uC,sBC7IP,SAASQ,GAAiBnE,GAAO,IAAD,EACYoE,mBAASpE,EAAMqE,gBAD3B,mBAC5BC,EAD4B,KACXC,EADW,KAEnC,OACI,eAACC,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,UACI,cAACC,EAAA,EAAD,UACI,cAACvC,EAAA,EAAKC,OAAN,CAAad,QAAS,kBAAMiD,GAAqBD,IAAjD,SAAoE,cAACE,EAAA,EAAD,UAAW,eAACC,EAAA,EAAD,WAAK,cAACC,EAAA,EAAD,CAAKC,UAAU,YAAf,SAA4B3E,EAAMqC,QAAY,cAACqC,EAAA,EAAD,CAAKC,UAAU,cAAf,SAA8BL,EAAmB,SAAM,sBAGjM,cAACG,EAAA,EAAD,UACI,cAACC,EAAA,EAAD,UACI,cAACF,EAAA,EAAD,CAAWG,UAAWL,EAAmB,SAAW,GAApD,SACI,cAACG,EAAA,EAAD,UACI,cAACC,EAAA,EAAD,UACK1E,EAAM4E,sBAUhC,SAASC,GAAsB7E,GAAO,IAAD,EAKpCA,EAHA8E,iBAFoC,WAKpC9E,EAFA+E,mBAHoC,SAIjCC,EAJiC,aAKpChF,EALoC,+BAOxBiF,YAAe5G,GAAxBP,EAPiC,oBAQpC,OAAQ,eAACyC,EAAA,EAAD,2BAAiByE,GAAjB,IAAuBxE,GAAG,SAA1B,UACH1C,EAAM+C,KAAI,SAAAqE,GAAI,OAAK,iCAAuBA,EAAKjJ,MAAfiJ,EAAKlJ,SACnC8I,GAAc,wBAAQxJ,MAAM,GAAd,oBACdyJ,GAAgB9F,EAAc4B,KAAI,SAAA5E,GAAI,OAAK,iCAAoBA,GAAPA,UAIhE,SAASkJ,GAAanF,GAAO,IAE5BoF,EAEApF,EAFAoF,WACAC,EACArF,EADAqF,cAH2B,EAMEJ,YAAevH,GANjB,mBAMxB4H,EANwB,KAMdC,EANc,KAQzBC,EAAQF,EAAUD,GARO,EASJjB,mBAASgB,EAAaA,EAAW,GAAK,IATlC,mBASxBK,EATwB,KASjBC,EATiB,OAUAtB,mBAAS,IAVT,mBAUxBvJ,EAVwB,KAUf8K,EAVe,KAWzBC,EAAavF,OAAOO,KAAK4E,GAY/B,OAAQ,eAACK,GAAA,EAAD,CAAOC,KAAK,KAAZ,UACI,gCACI,+BACI,yCACA,uCACA,4BAGR,kCACCF,EAAW/E,KAAI,SAAA/D,GAAG,OACnB,+BACQ,6BAAKA,IACL,6BAAK0I,EAAM1I,KACX,6BAAI,cAACuE,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAAS,kBAlBvC,SAAAxE,GACf,IAAMiJ,EAAQ,eAAOP,UACdO,EAASjJ,GAChByI,EAAatK,EAAWqK,EAAUD,EAAcU,IAeYC,CAAWlJ,IAAnD,wBAHHA,MAMT,+BACI,6BAAKsI,EAAc,cAAC7E,EAAA,EAAD,CAAaC,GAAG,SAASlF,MAAOmK,EAAQhF,SAAU,SAAAC,GAAC,OAAIgF,EAAUhF,EAAEC,OAAOrF,QAA1E,SAAoF8J,EAAWvE,KAAI,SAAAoF,GAAE,OAAK,iCAAkBA,GAALA,QAAuC,cAAC1F,EAAA,EAAD,CAAajF,MAAOmK,EAAQhF,SAAU,SAAAC,GAAC,OAAIgF,EAAUhF,EAAEC,OAAOrF,YAC/O,6BAAI,cAACiF,EAAA,EAAD,CAAajF,MAAOT,EAAU4F,SAAU,SAAAC,GAAC,OAAIiF,EAAYtK,EAAmBqF,EAAEC,OAAOrF,aACzF,6BAAI,cAAC+F,EAAA,EAAD,CAAQC,QA7BJ,WACpB,IAAMyE,EAAQ,2BAAOP,GAAP,kBAAcC,EAAQ5K,IACpC0K,EAAatK,EAAWqK,EAAUD,EAAcU,KA2BhC,4BAOjB,SAASG,GAAWlG,GAAO,IAE1BmG,EAGAnG,EAHAmG,aACAd,EAEArF,EAFAqF,cAHyB,EAKzBrF,EADAoG,cAJyB,WAOInB,YAAevH,GAPnB,mBAOtB4H,EAPsB,KAOZC,EAPY,KAQvBC,EAAQF,EAAUD,IAAkB,GARb,EASEjB,mBAAS+B,EAAeA,EAAa,GAAK,IAT5C,mBAStBtL,EATsB,KASb8K,EATa,KAuB7B,OAAQ,eAACU,EAAA,EAAD,WACCb,EAAM3E,KAAI,SAAA/D,GAAG,OACV,eAACwD,EAAA,EAAD,WACI,cAACA,EAAA,EAAWU,KAAZ,UAAkBlE,IAClB,cAACwD,EAAA,EAAWc,OAAZ,UACI,cAACC,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAAS,kBAVjC,SAAAxE,GACjB,IAAMiJ,EAAWP,EAAM5B,QAAO,SAAAjF,GAAC,OAAIA,IAAM7B,KACzCyI,EAAatK,EAAWqK,EAAUD,EAAcU,IAQQO,CAAaxJ,IAArD,mBAHSA,MAOrB,eAACwD,EAAA,EAAD,WACI,cAACA,EAAA,EAAWS,QAAZ,UACKoF,EAAgB,cAAC5F,EAAA,EAAD,CAAaC,GAAG,SAASlF,MAAOT,EAAU4F,SAAU,SAAAC,GAAC,OAAIiF,EAAYtK,EAAmBqF,EAAEC,OAAOrF,SAAjG,SAA4G6K,EAAatF,KAAI,SAAAoF,GAAE,OAAK,iCAAkBA,GAALA,QAAuC,cAAC1F,EAAA,EAAD,CAAajF,MAAOT,EAAU4F,SAAU,SAAAC,GAAC,OAAIiF,EAAYtK,EAAmBqF,EAAEC,OAAOrF,aAElS,cAACgF,EAAA,EAAWc,OAAZ,UACI,cAACC,EAAA,EAAD,CAAQC,QA1BF,WAClB,KAAG8E,GAAUZ,EAAMxK,QAAQH,IAAa,GAAxC,CAEA,IAAMkL,EAAQ,sBAAOP,GAAP,CAAa3K,IAC3B0K,EAAatK,EAAWqK,EAAUD,EAAcU,MAsBpC,yBC7Hb,SAASQ,GAAgBvG,GAC5B,IAAMwG,EAAuBxG,EAAMwG,qBAC7BC,EAAqBzG,EAAMyG,mBAFE,EAuCmBrC,mBAASpE,EAAM0G,OAAO3J,WAvCzC,mBAuC5B4J,EAvC4B,KAuCPC,EAvCO,KA+CnC,OACE,cAACzE,EAAA,EAAD,UACE,eAACA,EAAA,EAAK0E,KAAN,WACE,eAACvG,EAAA,EAAD,WACE,cAACA,EAAA,EAAWS,QAAZ,UACE,cAACT,EAAA,EAAWU,KAAZ,uBAEF,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAM0G,OAAOzK,KAAMwE,SAAU,SAACC,GAAD,OAAO+F,EAAmB,OAAQ/F,EAAEC,OAAOrF,UAC5F,cAACgF,EAAA,EAAWc,OAAZ,UACE,cAACC,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAASkF,EAAlC,yBAGJ,eAAClG,EAAA,EAAD,WACE,cAACA,EAAA,EAAWS,QAAZ,UACE,cAACT,EAAA,EAAWU,KAAZ,0BAEF,cAAC6D,GAAD,CAAuBvJ,MAAOqL,EAAqBlG,SAtBpC,SAACC,GACtBkG,EAAuBlG,EAAEC,OAAOrF,OAChCmL,EAAmB,YAAa/F,EAAEC,OAAOrF,QAoB0CwJ,WAAW,OAE1F,eAACxE,EAAA,EAAD,WACE,cAACA,EAAA,EAAWS,QAAZ,UACE,cAACT,EAAA,EAAWU,KAAZ,0BAEF,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAM0G,OAAOzJ,MAAOwD,SAAU,SAACC,GAAD,OAAO+F,EAAmB,QAASpL,EAAmBqF,EAAEC,OAAOrF,WACjH,cAACgF,EAAA,EAAWU,KAAZ,sBACA,cAACT,EAAA,EAAD,CAAajF,MAAO0E,EAAM0G,OAAOxJ,cAAeuD,SAAU,SAACC,GAAD,OAAO+F,EAAmB,gBAAiB/F,EAAEC,OAAOrF,aAEhH,cAACuG,GAAD,CACIQ,MAAM,oBACNH,QAASlC,EAAM0G,OAAO1J,qBACtB+E,kBAAmB,SAAA+E,GAAK,OAvEhB,SAACC,EAAaC,GAC9B,IAAMC,EAAcjH,EAAM0G,OAAOK,GAC3BG,OAA8B5K,IAAhB2K,EAAA,sBAAgCA,GAAhC,CAA6CD,IAAc,CAACA,GAChFP,EAAmBM,EAAaG,GAoEIC,CAAU,uBAAwBL,IAC9DhF,qBAAsB,SAACsF,EAAK5E,EAAMpH,GAAZ,OAnEV,SAAC2L,EAAaM,EAAYC,EAAclM,GAC5D,IAAMmM,EAAc,2BAAQF,GAAR,kBAAqBC,EAAelM,IAClD8L,EAAclH,EAAM0G,OAAOK,GAAahM,QAC9CmM,EAAYlH,EAAM0G,OAAOK,GAAa/L,QAAQqM,IAAeE,EAC7Dd,EAAmBM,EAAaG,GA+DwBM,CAAc,uBAAwBJ,EAAK5E,EAAMpH,IACjG4G,oBAAqB,SAAA0B,GAAO,OA9DjB,SAACqD,EAAaU,GACjC,IAAMP,EAAclH,EAAM0G,OAAOK,GAAanD,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KAChEhB,EAAmBM,EAAaG,EAAYxF,OAASwF,OAAc5K,GA4D3BoL,CAAa,uBAAwBhE,MACzE,cAACjB,GAAD,CACEJ,MAAM,eACNzF,aAAcoD,EAAM0G,OAAO9J,aAC3B+F,uBA5De,SAAAmE,GACrB,IAAMa,EAAW3H,EAAM0G,OAAO9J,aACxB+G,OAAwBrH,IAAbqL,EAAA,sBAA6BA,GAA7B,CAAuCb,IAAS,CAACA,GAClEL,EAAmB,eAAgB9C,IA0D7Bf,yBAvDkB,SAAA6E,GACxB,IAAM9D,EAAW3D,EAAM0G,OAAO9J,aAAagH,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KAC7DhB,EAAmB,eAAgB9C,EAASjC,OAASiC,OAAWrH,IAsD1DoG,0BAnDmB,SAACoB,EAASwD,EAAclM,GACjD,IAAM2I,EAAW,2BAAQD,GAAR,kBAAkBwD,EAAelM,IAC5CuI,EAAW3D,EAAM0G,OAAO9J,aAAa7B,QAC3C4I,EAAS3D,EAAM0G,OAAO9J,aAAa5B,QAAQ8I,IAAYC,EACvD0C,EAAmB,eAAgB9C,WClClC,SAASiE,GAAc5H,GAC1B,IAAM6H,EAAqB7H,EAAM6H,mBADA,EAGT5C,YAAezG,EAAawB,EAAMkF,KAAKlJ,KAH9B,mBAG1BkJ,EAH0B,KAGpB4C,EAHoB,KAyB3BX,EAAY,SAACJ,EAAaC,GAC5B,IAAMC,EAAcjH,EAAMkF,KAAK6B,GACzBG,OAA8B5K,IAAhB2K,EAAA,sBAAgCA,GAAhC,CAA6CD,IAAc,CAACA,GAChFc,EAAQ7M,EAAWiK,EAAM6B,EAAaG,KAGpCM,EAAgB,SAACT,EAAaM,EAAYC,EAAclM,GAC1D,IAAMmM,EAAc,2BAAQF,GAAR,kBAAqBC,EAAelM,IAClD8L,EAAclH,EAAMkF,KAAK6B,GAAahM,QAC5CmM,EAAYlH,EAAMkF,KAAK6B,GAAa/L,QAAQqM,IAAeE,EAC3DO,EAAQ7M,EAAWiK,EAAM6B,EAAaG,KAGpCQ,EAAe,SAACX,EAAaU,GAC/B,IAAMP,EAAclH,EAAMkF,KAAK6B,GAAanD,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KAC9DK,EAAQ7M,EAAWiK,EAAM6B,EAAaG,EAAYxF,OAASwF,OAAc5K,KAGvEyL,EAAgB7C,EAAK8C,UAAY9C,EAAK8C,UAAY5I,EAAc8F,EAAK9I,OACrE6L,EAAaC,mBAqCbC,EAAkBjD,EAAK8C,UAAY,oBAAsB9C,EAAK9I,MACpE,OACI,mCACY,cAAC+F,EAAA,EAAD,UACI,eAACA,EAAA,EAAK0E,KAAN,WACI,eAAC1E,EAAA,EAAKiG,MAAN,WAAalD,EAAKjJ,KAAlB,IAAwB,cAACoF,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAASuG,EAAlC,uBACxB,cAACQ,EAAA,EAAD,CAAOC,IAAKP,EAAeQ,MAAM,QAAQC,OAAO,UAChD,eAAClI,EAAA,EAAD,WACI,cAACA,EAAA,EAAWS,QAAZ,UACI,cAACT,EAAA,EAAWU,KAAZ,sBAEJ,cAACyH,EAAA,EAAKC,QAAN,CAAclI,GAAG,SAASlF,MAAO6M,EAAiBQ,cAA6BrM,IAAnB4I,EAAK8C,UAAyBvH,SAfjG,SAAAC,GACjBoH,EAAQ7M,EAAWiK,EAAK,QAAQxE,EAAEC,OAAOrF,SAcjB,SACK+E,OAAOO,KAAKxB,GAAeyB,KAAI,SAAAC,GAAC,OAAK,iCAAiBA,GAAJA,QAEvD,cAAC2H,EAAA,EAAKG,KAAN,CAAWC,KAAK,OAAOC,OAAO,YAAYC,IAAKd,EAAYxH,SA9C9D,SAACC,GACtB,IAAIsI,EAAS,IAAIC,WACjBD,EAAOE,OAAS,SAACxI,GACb,IAAIyI,EAAiB,IAAId,IACzBc,EAAeD,OAAS,WACpB,GAA4B,MAAzBC,EAAeZ,OAA2C,MAA1BY,EAAeX,OAAlD,CAIA,IAAMY,EAAa,2BAAOlE,GAAP,IACf8C,UAAUtH,EAAEC,OAAO0I,OACnBjN,MAAM,OAEV0L,EAAQsB,QAPJE,MAAM,iDASdH,EAAeb,IAAM5H,EAAEC,OAAO0I,QAElCL,EAAOO,cAAc7I,EAAEC,OAAO6I,MAAM,KA6B2EC,MAAO,CAACC,QAAQ,UACvG,eAACpJ,EAAA,EAAWc,OAAZ,WACI,cAACC,EAAA,EAAD,CAAQC,QApDZ,WACxB2G,EAAWpJ,QAAQ8K,SAmDS,oBACA,cAACtI,EAAA,EAAD,CAAQC,QA7BpB,WAChB,IAAM8H,EAAa,2BAAOlE,GAAP,IACf8C,eAAU1L,EACVF,MAAM,YAEV0L,EAAQsB,IAwBoB,yBAGR,eAAC/C,EAAA,EAAD,WACI,cAACoC,EAAA,EAAKmB,MAAN,sBACA,cAACrJ,EAAA,EAAD,CAAajF,MAAO4J,EAAKjJ,KAAMwE,SAlGlC,SAACC,GACtB,IAAM0I,EAAgBnO,EAAWiK,EAAM,OAAQxE,EAAEC,OAAOrF,OACxDwM,EAAQsB,SAkGY,eAAC/C,EAAA,EAAD,WACI,cAACoC,EAAA,EAAKmB,MAAN,0BACA,cAACrJ,EAAA,EAAD,CAAaC,GAAG,WAAWqJ,KAAM,EAAGC,YAAY,0BAA0BxO,MAAO4J,EAAKhJ,YAAauE,SAAU,SAACC,GAAD,OAAOoH,EAAQ7M,EAAWiK,EAAM,cAAexE,EAAEC,OAAOrF,cAEzK,cAACuG,GAAD,CACIQ,MAAM,mBACNH,QAASgD,EAAK3I,iBACdwF,kBAAmB,SAAA+E,GAAK,OAAIK,EAAU,mBAAoBL,IAC1DhF,qBAAsB,SAACsF,EAAK5E,EAAMpH,GAAZ,OAA0BoM,EAAc,mBAAoBJ,EAAK5E,EAAMpH,IAC7F4G,oBAAqB,SAAA0B,GAAO,OAAIgE,EAAa,mBAAoBhE,MACrE,cAAC7B,GAAD,CACIQ,MAAM,kBACNH,QAASgD,EAAK1I,gBACduN,UAAW7E,EAAKlJ,GAChB+F,kBAAmB,SAAA+E,GAAK,OAAIK,EAAU,kBAAmBL,IACzDhF,qBAAsB,SAACsF,EAAK5E,EAAMpH,GAAZ,OAA0BoM,EAAc,kBAAmBJ,EAAK5E,EAAMpH,IAC5F4G,oBAAqB,SAAA0B,GAAO,OAAIgE,EAAa,kBAAmBhE,MACpE,cAACvB,EAAA,EAAKC,OAAN,sBACK8C,EAAK/I,QAAQ0E,KAAI,SAAA6F,GAAM,OAChB,cAACH,GAAD,CAEIG,OAAQA,EACRF,qBAAsB,kBAhHzC,SAACiB,GAClB,IAAMuC,EAAchK,EAAMkF,KAAK/I,QAAQyH,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KACzDK,EAAQ7M,EAAWiK,EAAM,UAAW8E,IA8G4BC,CAAavD,IACzCD,mBAAoB,SAACyD,EAAiB9O,GAClC,IAAM+O,EAAU,2BAAQzD,GAAR,kBAAiBwD,EAAkB9O,KA9G1E,SAACgP,EAAYD,GAC9B,IAAMH,EAAchK,EAAMkF,KAAK/I,QAAQpB,QACvCiP,EAAYhK,EAAMkF,KAAK/I,QAAQnB,QAAQoP,IAAeD,EACtDrC,EAAQ7M,EAAWiK,EAAM,UAAW8E,IA4GIK,CAAa3D,EAAQyD,KALpBzD,EAAO1K,OAQxB,cAACqF,EAAA,EAAD,CAAQC,QAAS,kBA3H3B,SAAC6I,GACf,IAAMH,EAAW,sBAAOhK,EAAMkF,KAAK/I,SAAlB,CAA2BgO,IAC5CrC,EAAQ7M,EAAWiK,EAAM,UAAW8E,IAyHWM,CAAU,IAAIzN,IAArC,+BCrIzB,SAAS0N,GAAiBvK,GAC7B,IAAMwK,EAAiBxK,EAAMwK,eADO,EAGNvF,YAAejG,EAAgBgB,EAAMyK,QAAQzO,KAHvC,mBAG7ByO,EAH6B,KAGpBC,EAHoB,KAkDpC,OACI,cAACvI,EAAA,EAAD,UACI,eAACA,EAAA,EAAK0E,KAAN,WACI,eAAC1E,EAAA,EAAKiG,MAAN,sBAAoB,cAAC/G,EAAA,EAAD,CAAQO,QAAQ,SAASN,QAASkJ,EAAlC,uBACpB,eAACnE,EAAA,EAAD,WACI,cAACoC,EAAA,EAAKmB,MAAN,yBACA,cAACrJ,EAAA,EAAD,CAAajF,MAAOmP,EAAQxO,KAAMwE,SAnDtB,SAACC,GACzBgK,EAAWzP,EAAWwP,EAAS,OAAQ/J,EAAEC,OAAOrF,cAoDxC,eAAC+K,EAAA,EAAD,WACI,cAACoC,EAAA,EAAKmB,MAAN,qCACA,cAAC/E,GAAD,CAAuBC,WAAW,EAAMxJ,MAAOmP,EAAQ/N,YAAa+D,SAnDjD,SAACC,GAChCgK,EAAWzP,EAAWwP,EAAS,cAAe/J,EAAEC,OAAOrF,cAoD/C,cAACuG,GAAD,CACIQ,MAAM,qBACNH,QAASuI,EAAQ9N,mBACjBoF,kBAAmB,SAAA+E,GAAK,OApDtB,SAACC,EAAaC,GAC5B,IAAMC,EAAcjH,EAAMyK,QAAQ1D,GAC5BG,OAA8B5K,IAAhB2K,EAAA,sBAAgCA,GAAhC,CAA6CD,IAAc,CAACA,GAChF0D,EAAWzP,EAAWwP,EAAS1D,EAAaG,IAiDJC,CAAU,qBAAsBL,IAC5DhF,qBAAsB,SAACsF,EAAK5E,EAAMpH,GAAZ,OA/ChB,SAAC2L,EAAaM,EAAYC,EAAclM,GAC1D,IAAMmM,EAAc,2BAAQF,GAAR,kBAAqBC,EAAelM,IAClD8L,EAAclH,EAAMyK,QAAQ1D,GAAahM,QAC/CmM,EAAYlH,EAAMyK,QAAQ1D,GAAa/L,QAAQqM,IAAeE,EAC9DmD,EAAWzP,EAAWwP,EAAS1D,EAAaG,IA2CgBM,CAAc,qBAAsBJ,EAAK5E,EAAMpH,IAC/F4G,oBAAqB,SAAA0B,GAAO,OAzCvB,SAACqD,EAAaU,GAC/B,IAAMP,EAAclH,EAAMyK,QAAQ1D,GAAanD,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KACjEiD,EAAWzP,EAAWwP,EAAS1D,EAAaG,EAAYxF,OAASwF,OAAc5K,IAuCnCoL,CAAa,qBAAsBhE,MACvE,cAACjB,GAAD,CACIJ,MAAM,uBACNzF,aAAcoD,EAAMyK,QAAQ7N,aAC5B+F,uBAxCO,SAAAmE,GACnB,IAAMa,EAAW3H,EAAMyK,QAAQ7N,aACzB+G,OAAwBrH,IAAbqL,EAAA,sBAA6BA,GAA7B,CAAuCb,IAAS,CAACA,GAClE4D,EAAWzP,EAAWwP,EAAQ,eAAgB9G,KAsClCf,yBAnCU,SAAA6E,GACtB,IAAM9D,EAAW3D,EAAMyK,QAAQ7N,aAAagH,QAAO,SAAAjF,GAAC,OAAIA,IAAM8I,KAC9DiD,EAAWzP,EAAWwP,EAAQ,eAAiB9G,EAASjC,OAASiC,OAAWrH,KAkChEoG,0BA/BW,SAACoB,EAASwD,EAAclM,GAC/C,IAAM2I,EAAW,2BAAQD,GAAR,kBAAkBwD,EAAelM,IAC5CuI,EAAW3D,EAAMyK,QAAQ7N,aAAa7B,QAC5C4I,EAAS3D,EAAMyK,QAAQ7N,aAAa5B,QAAQ8I,IAAYC,EACxD2G,EAAWzP,EAAWwP,EAAQ,eAAiB9G,Y,aCjDhD,SAASgH,GAAgB3K,GAAQ,IAAD,EAEfiF,YAAevH,GAA5B4H,EAF4B,sBAIElB,mBAASkB,EAAUxH,MAAMY,MAAK,SAAAwG,GAAI,OAAIA,EAAKjJ,OAASqJ,EAAUzH,kBAAkByH,EAAUxH,MAAM,IAJlG,mBAI5B8M,EAJ4B,KAIhBC,EAJgB,OAKFzG,mBAASkB,EAAUnH,oBALjB,mBAK5B2M,EAL4B,KAKlBC,EALkB,OAMJ3G,mBAASwG,EAAcA,EAAY3O,KAAO,IANtC,mBAM5B+O,EAN4B,KAMnBC,EANmB,KAc7BC,EAAW,SAAApI,GACb,OAAOA,EAAIrF,UACP,IAAK,KACD,GAAGqN,EAAUhI,EAAIzF,WAAayF,EAAIxH,MAC9B,OAAO,EACX,MACJ,IAAK,KACD,GAAGwP,EAAUhI,EAAIzF,WAAayF,EAAIxH,MAC9B,OAAO,EACX,MACJ,IAAK,KACD,GAAGwP,EAAUhI,EAAIzF,UAAYyF,EAAIxH,MAC7B,OAAO,EACX,MACJ,IAAK,KACD,GAAGwP,EAAUhI,EAAIzF,UAAYyF,EAAIxH,MAC7B,OAAO,EACX,MACJ,IAAK,IACD,GAAGwP,EAAUhI,EAAIzF,SAAWyF,EAAIxH,MAC5B,OAAO,EACX,MACJ,IAAK,IACD,GAAGwP,EAAUhI,EAAIzF,SAAWyF,EAAIxH,MAC5B,OAAO,EACX,MACJ,QACIgO,MAAM,sBAIZ6B,EAAc,SAAdA,EAAeC,EAAU7N,GAC3B,OAAOA,GACH,IAAK,MAAL,oBACmB6N,GADnB,IACI,IAAI,EAAJ,qBAAyB,CAAC,IAAlBtI,EAAiB,QACrB,QAAsBxG,IAAnBwG,EAAIvF,aACC4N,EAAYrI,EAAIlG,aAAakG,EAAIvF,YACjC,OAAO,EAEf,IAAI2N,EAASpI,GACT,OAAO,GAPnB,8BASI,OAAO,EACX,IAAK,KAAL,oBACmBsI,GADnB,IACI,IAAI,EAAJ,qBAAyB,CAAC,IAAlBtI,EAAiB,QACrB,QAAsBxG,IAAnBwG,EAAIvF,YACA4N,EAAYrI,EAAIA,EAAIvF,YACnB,OAAO,EAEf,GAAG2N,EAASpI,GACR,OAAO,GAPnB,8BASI,OAAO,EACX,QACIwG,MAAM,sBAIZ+B,EAAc,SAAA3E,GAChB,YAA2BpK,IAAxBoK,EAAO9J,cAEHuO,EAAYzE,EAAO9J,aAAa,QAGrC0O,EAAiB,SAAjBA,EAAiBC,GACnB,QAAmCjP,IAAhCsO,EAAYpO,kBACRgP,EAAcZ,EAAYpO,iBAGjC,OAAO+O,GACH,IAAK,MACDjC,MAAM,wEACN,MACJ,IAAK,OACDA,MAAM,0FACN,MACJ,IAAK,aACDA,MAAM,gEACN,MACJ,IAAK,UACDgC,EAAeN,EAAS/O,MACxB,MACJ,QACI,IAAMwP,EAAYnG,EAAUxH,MAAMY,MAAK,SAAAwG,GAAI,OAAIA,EAAKjJ,OAASsP,KAI7D,GAHAV,EAAeY,GACZT,IAAaS,EAAUxP,MACtBgP,EAAYQ,EAAUxP,WACQK,IAA/BmP,EAAUlP,kBACNiP,EAAcC,EAAUlP,kBACvB,SAIdmP,EAAe,GACfC,EAAgB,WAClB,QAA0BrP,IAAvBgJ,EAAUvH,SAAuB,CAAC,IAAD,gBACZuH,EAAUvH,UADE,IAChC,2BAAwC,CAAC,IAAhC0M,EAA+B,QACpC,GAAIU,EAAYV,EAAQ7N,aAAa,OAArC,CAEA,IAAG8O,EAAaE,SAASnB,GAKzB,OADAiB,EAAaG,KAAKpB,QACgBnO,IAA/BmO,EAAQ9N,oBACJ6O,EAAcf,EAAQ9N,0BAGFL,IAAxBmO,EAAQ/N,aACP4O,EAAeb,EAAQ/N,cAHZ,EANX4M,MAAM,+BAAD,OAAgCmB,EAAQxO,SALrB,+BAmBpC,OADAyP,EAAahK,OAAS,GACf,GAULoK,EAAe,SAAAxQ,GACjB,GAAGA,IAAU+E,OAAO/E,GAChB,OAAOA,EAAM6E,YACT,KAAKP,EAAWE,OACZ,OAVMiM,EAUczQ,EAAM2F,IAVf+K,EAUmB1Q,EAAM4F,KAThD6K,EAAME,KAAKC,KAAKH,GAChBC,EAAMC,KAAKE,MAAMH,GACVC,KAAKE,MAAMF,KAAKnM,UAAYkM,EAAMD,GAAOA,GAQxC,QACIzC,MAAM,oBAZD,IAACyC,EAAKC,EAevB,OAAO1Q,GAGLkQ,EAAgB,SAAAY,GAAgB,IAAD,gBACdA,GADc,IACjC,2BAAgC,CAAC,IAAxBhM,EAAuB,QACtBiM,EAAiBP,EAAa1L,EAAO9E,OAC3C,OAAO8E,EAAOhD,aACV,KAAKoC,EAAYC,IACb,IAAM6M,EAAC,2BAAOxB,GAAP,kBAAkB1K,EAAO/C,SAAUyN,EAAU1K,EAAO/C,UAAY,GAAGgP,IAC1EtB,EAAauB,GACb,MACJ,KAAK9M,EAAYE,IACb,IAAM6M,EAAC,2BAAOzB,GAAP,kBAAkB1K,EAAO/C,QAASgP,IACzCtB,EAAawB,GACb,MACJ,KAAK/M,EAAYG,OACb,IAAM6M,EAAC,eAAO1B,UACP0B,EAAEpM,EAAO/C,SAChB0N,EAAayB,GACb,MACJ,QACIlD,MAAM,uBAlBe,8BAqBjC,QAAGqC,KAaP,OAAIf,EAIA,eAACpG,EAAA,EAAD,WACI,cAACiI,GAAA,EAAD,CAAO7K,QAAQ,SAAf,gGACA,cAAC6C,EAAA,EAAD,UACI,cAACC,EAAA,EAAD,UACI,cAACrD,EAAA,EAAD,CAAQC,QAxLH,WACjBuJ,EAAevF,EAAUxH,MAAMY,MAAK,SAAAwG,GAAI,OAAIA,EAAKjJ,OAASqJ,EAAUzH,kBAAkByH,EAAUxH,MAAM,IACtGiN,EAAazF,EAAUnH,oBACvB8M,EAAYL,EAAY3O,OAqLZ,yBAGR,cAACwI,EAAA,EAAD,UACI,cAACC,EAAA,EAAD,UACI,eAACvC,EAAA,EAAD,WACI,cAACA,EAAA,EAAKuK,IAAN,CAAUpE,IAAKsC,EAAY5C,UAAY4C,EAAY5C,UAAY5I,EAAcwL,EAAYxO,SACzF,eAAC+F,EAAA,EAAK0E,KAAN,WACI,cAAC1E,EAAA,EAAKnB,KAAN,UAAY4J,EAAY1O,cACxB,cAACsI,EAAA,EAAD,UACKoG,EAAYzO,QAAQ0E,KAAI,SAAA6F,GAAM,OAC3B,cAACjC,EAAA,EAAD,UAAqB,cAACC,EAAA,EAAD,UAAK,cAACrD,EAAA,EAAD,CAAQsL,UAAWtB,EAAY3E,GAASpF,QAAS,kBA3BtF,SAACoF,QACiBpK,IAAhCoK,EAAO1J,sBACHwO,EAAc9E,EAAO1J,uBAG5BsO,EAAe5E,EAAO3J,WAsBuF6P,CAAalG,IAApE,SAA8EA,EAAOzK,UAArGyK,EAAO1K,mBAOzC,cAACyI,EAAA,EAAD,UACI,eAACoB,GAAA,EAAD,WACI,gCACI,+BACI,yCACA,4CAGR,gCACKxF,OAAOO,KAAKkK,GAAWjK,KAAI,SAAAgM,GAAK,OAAK,+BAAgB,6BAAKA,IAAW,6BAAK/B,EAAU+B,OAAtCA,gBAlCvD,cAACJ,GAAA,EAAD,CAAO7K,QAAQ,SAAf,iDCpLT,SAASkL,KAAmB,IAAD,EACG7H,YAAevH,GADlB,mBACvB4H,EADuB,KACbC,EADa,OAEdN,YAAe5G,GAAxBP,EAFuB,sBAGXmH,YAAelG,GAA3BhB,EAHuB,sBAKGqG,mBAAS,IALZ,mBAKvB2I,EALuB,KAKbC,EALa,OAMO5I,mBAAS,MANhB,mBAMvB6I,EANuB,KAMXC,EANW,KA2DxBC,EAAkB,SAAlBA,EAAkBC,GAAa,IAAD,gBACnBA,GADmB,IAClC,IAAI,EAAJ,qBAAwB,CAAC,IAAjBtK,EAAgB,QACtBA,EAAI9G,GAAKJ,EAAU,YACGU,IAAnBwG,EAAIvF,iBACmBjB,IAArBwG,EAAIlG,cACLuQ,EAAgBrK,EAAIlG,eALQ,gCAU9ByQ,EAAqB,SAAAnL,GAAY,IAAD,gBAClBA,GADkB,IACpC,IAAI,EAAJ,qBAA0B,SACjBlG,GAAKJ,EAAU,WAFY,gCA8DhC0R,EAAcpF,mBAKdqF,EAAarF,mBA8BbsF,EAAUT,GAJM,WACpB,GAAGjP,EAAM4D,OACP,OAAO5D,EAAM,GAAG9B,GAAGyR,WAEMC,GAMvBC,EAAerI,EAAUzH,eAJA,WAC7B,GAAGC,EAAM4D,OACP,OAAO5D,EAAM,GAAG7B,KAE4B2R,GA5KlB,EA+KDxJ,oBAAS,GA/KR,mBA+KvByJ,EA/KuB,KA+KfC,EA/Ke,KAiLxBC,GAAiB,WACrBD,GAAYD,IAGd,OACA,qCACA,cAACG,EAAA,EAAD,CAAOC,KAAMJ,EAASK,OAAQH,GAA9B,SACE,cAACpD,GAAD,CAAiBrF,UAAWA,MAE9B,eAACd,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACA,eAAClB,EAAA,EAAD,WACI,cAACnC,EAAA,EAAD,CAAQC,QA7JK,WACnB,IAAM6M,EAAc,CAClBC,eAAgB9I,EAAUrJ,KAC1B4B,cAAe8P,EACfxP,mBAAoBmH,EAAUnH,mBAC9BH,qBAAsBsH,EAAUtH,qBAChCqQ,gBAAkB/I,EAAUrH,WAC5BqQ,eAAiBhJ,EAAUpH,eAC3BE,sBAAwBkH,EAAUlH,sBAClCL,SAAWuH,EAAUvH,SACrBD,MAAOA,GAQHyQ,EAAO,IAAIC,KAAK,CAACC,KAAKC,UAAUP,GALnB,SAACrR,EAAKxB,GACvB,GAAY,OAARwB,EAEJ,OAAOxB,MAEwD,CAAEuN,KAAM,qBACnE8F,EAAWC,IAAIC,gBAAgBN,GAErChB,EAAW1O,QAAQiQ,KAAOH,EAC1BpB,EAAW1O,QAAQkQ,SAAnB,UAAiCzJ,EAAUrJ,KAA3C,SACAsR,EAAW1O,QAAQ8K,SAsIb,oBACA,mBAAGZ,IAAKwE,EAAY9D,MAAO,CAACC,QAAQ,QAASoF,KAAK,IAAlD,wDACA,cAACzN,EAAA,EAAD,CAAQC,QA5DI,WAClBgM,EAAYzO,QAAQ8K,SA2Dd,oBACA,cAAClB,EAAA,EAAKG,KAAN,CACEnI,SAtFW,SAAAC,GACnB,IAAIsI,EAAS,IAAIC,WACjBD,EAAOE,OAAS,SAACxI,GACf,IAAM2I,EAASoF,KAAKO,MAAMtO,EAAEC,OAAO0I,QAE7B4F,EAtCa,SAAAC,GAAa,IAAD,gBACjBA,GADiB,IACjC,IAAI,EAAJ,qBAA0B,CAAC,IAAnBhK,EAAkB,QACxBA,EAAKlJ,GAAKJ,EAAU,QADI,oBAENsJ,EAAK/I,SAFC,IAExB,IAAI,EAAJ,qBAA+B,CAAC,IAAxBuK,EAAuB,QAC7BA,EAAO1K,GAAKJ,EAAU,eACaU,IAAhCoK,EAAO1J,sBACRqQ,EAAmB3G,EAAO1J,2BAEDV,IAAxBoK,EAAO9J,cACRuQ,EAAgBzG,EAAO9J,eARH,mCAWKN,IAA1B4I,EAAK3I,kBACN8Q,EAAmBnI,EAAK3I,uBACED,IAAzB4I,EAAK1I,iBACN6Q,EAAmBnI,EAAK1I,kBAfK,8BAiBjC,OAAO0S,EAqBmBC,CAAe9F,EAAOvL,OACxCsR,EAnBqB,SAAAC,GAAiB,IAAD,gBAC1BA,GAD0B,IAC7C,IAAI,EAAJ,qBAAgC,CAAC,IAAzB5E,EAAwB,QAC9BA,EAAQzO,GAAKJ,EAAU,gBACKU,IAAzBmO,EAAQ7N,cACTuQ,EAAgB1C,EAAQ7N,mBAEQN,IAA/BmO,EAAQ9N,oBACT0Q,EAAmB5C,EAAQ9N,qBAPc,8BAU7C,OAAO0S,EASsBC,CAAuBjG,EAAOtL,UAEnDwR,EAAkB,2BAAOjK,GAAP,IACtBrJ,KAAKoN,EAAO+E,eACZvQ,cAAcwL,EAAOxL,cACrBM,mBAAmBkL,EAAOlL,mBAC1BH,qBAAqBqL,EAAOrL,qBAC5BE,eAAemL,EAAOiF,eACtBrQ,WAAWoL,EAAOgF,gBAClBtQ,SAASqR,EACTtR,MAAMmR,IAER1J,EAAagK,IAEfvG,EAAOwG,WAAW9O,EAAEC,OAAO6I,MAAM,KAmEzBV,OAAO,QACPC,IAAKuE,EACL7D,MAAQ,CAACC,QAAQ,UACnB,cAACrI,EAAA,EAAD,CAAQC,QAASyM,GAAjB,yBAIN,cAACtJ,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACA,cAACP,GAAD,CAAkB9B,MAAM,mBAAxB,SACI,eAACoG,EAAA,EAAD,WACE,eAACpC,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,6BACA,cAACrJ,EAAA,EAAD,CAAauJ,YAAY,gBAAgBxO,MAAOgK,EAAUrJ,KAAMwE,SAAU,SAACC,GAAD,OAAO6E,EAAatK,EAAWqK,EAAU,OAAO5E,EAAEC,OAAOrF,cAErI,eAAC+K,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,4BACA,cAAC/E,GAAD,CAAuBvJ,MAAOqS,EAAclN,SAAU,SAACC,GAAD,OAAO6E,EAAatK,EAAWqK,EAAU,gBAAgB5E,EAAEC,OAAOrF,SAASyJ,aAAa,OAEhJ,eAACsB,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,iCACA,cAACzE,GAAD,CAAcE,cAAc,0BAE9B,eAACgB,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,mCACA,cAAC1D,GAAD,CAAYC,aAAcjH,EAAamG,cAAc,4BAEvD,eAACgB,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,wBACA,cAAC1D,GAAD,CAAYC,aAAclI,EAAYoH,cAAc,kBAEtD,eAACgB,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,iCACA,cAACzE,GAAD,CAAcC,WAAYjG,EAAYkG,cAAc,sBAEtD,eAACgB,EAAA,EAAD,WACE,cAACoC,EAAA,EAAKmB,MAAN,oCACA,cAACrJ,EAAA,EAAD,CAAajF,MAAOgK,EAAUlH,sBAAuBqC,SAAU,SAACC,GAAD,OAAO6E,EAAatK,EAAWqK,EAAU,wBAAwB5E,EAAEC,OAAOrF,uBAMnJ,cAACmJ,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACE,cAACP,GAAD,CAAkB9B,MAAM,QAAxB,SACA,eAACoN,EAAA,EAAIjL,UAAL,CAAexI,GAAG,QAAQ0T,UAAWlC,EAASmC,SAAU,SAAAjP,GAAC,OAAIsM,EAAatM,IAA1E,UACE,cAAC+D,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACE,eAACkL,EAAA,EAAD,CAAKhO,QAAQ,OAAb,UACG9D,EAAM+C,KAAI,SAAAqE,GAAI,OACb,cAAC0K,EAAA,EAAIrM,KAAL,CAEEsM,WAAS,EACTC,UAAW,SAAApP,GA1G3BwM,EAAe,OA2GC6C,YAAa,SAAArP,GAAC,OAhHT,SAACA,EAAEwE,GACxBgI,EAAehI,GA+GmB8K,CAAetP,EAAEwE,IACnC+K,OAAQ,kBAzGN,SAAC/K,GACnB,GAAkB,MAAf+H,EAAoB,CACrB,IAAMiD,EAAUpS,EAAM9C,QAAQkK,GACxBiL,EAAUrS,EAAM9C,QAAQiS,GACxBmD,EAAiBtS,EAAM/C,QAHR,EAI+B,CAACqV,EAAeD,GAASC,EAAeF,IAA3FE,EAAeF,GAJK,KAIIE,EAAeD,GAJnB,KAKrB5K,EAAatK,EAAWqK,EAAU,QAAQ8K,KAmGdC,CAAYnL,IAC1BoL,WAAY,SAAA5P,GAAC,OAhGT,SAACA,EAAEwE,GACL,MAAf+H,GAAuB/H,IAAS+H,GACjCvM,EAAE6P,iBA8F6BC,CAAc9P,EAAEwE,IANnC,SAQE,cAAC0K,EAAA,EAAIa,KAAL,CAAUC,SAAUxL,EAAKlJ,GAAzB,SAA8BkJ,EAAKjJ,QAP9BiJ,EAAKlJ,OASd,cAAC4T,EAAA,EAAIrM,KAAL,UACE,cAACqM,EAAA,EAAIa,KAAL,CAAUnP,QAzPT,WACf,IAAMiO,EAAkB,2BAAOjK,GAAP,IACtBxH,MAAM,GAAD,mBAAKA,GAAL,CAAW,IAAIhC,MAEtByJ,EAAagK,IAqPC,+BAKR,cAAC9K,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACE,cAAC+K,EAAA,EAAIkB,QAAL,UACK7S,EAAM+C,KAAI,SAAAqE,GAAI,OACb,cAACuK,EAAA,EAAImB,KAAL,CAAUF,SAAUxL,EAAKlJ,GAAzB,SACE,cAAC4L,GAAD,CACE1C,KAAMA,EACN2C,mBAAoB,kBA/PtB,SAAC3C,GACnB,IAAM2L,EAAgB/S,EAAM8F,QAAO,SAAAjF,GAAC,OAAIA,IAAMuG,KAC9CK,EAAatK,EAAWqK,EAAU,QAAQuL,IA6PIC,CAAY5L,OAHRA,EAAKlJ,sBAavD,cAACyI,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,UACA,cAACP,GAAD,CAAkB9B,MAAM,WAAWgC,gBAAc,EAAjD,SACE,cAACG,EAAA,EAAD,UACE,eAACC,EAAA,EAAD,WACG1G,EAAS8C,KAAI,SAAA4J,GAAO,OACnB,cAAC/F,EAAA,EAAD,CAAsBqM,GAAG,OAAzB,SAAgC,cAACxG,GAAD,CAAkBE,QAASA,EAASD,eAAgB,kBAnQzE,SAACC,GACtB,IAAMuG,EAAmBjT,EAAS6F,QAAO,SAAAjF,GAAC,OAAIA,IAAM8L,KACpDlF,EAAatK,EAAWqK,EAAU,WAAW0L,IAiQuDC,CAAexG,OAA/FA,EAAQzO,OAEpB,cAAC0I,EAAA,EAAD,UACE,cAACrD,EAAA,EAAD,CAAQC,QA7QA,WAClB,IAAMiO,EAAkB,2BAAOjK,GAAP,IACtBvH,SAAS,GAAD,mBAAKA,GAAL,CAAc,IAAItB,MAE5B8I,EAAagK,IAyQH,4CC1RD2B,OARf,WACE,OACE,cAAC,IAAD,UACE,cAACpE,GAAD,OCDSqE,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCCdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFC,SAASC,eAAe,SAM1Bb,O","file":"static/js/main.d317e3bf.chunk.js","sourcesContent":["//Helpers\r\nexport function replaceItemInArray(arr, oldVal, newValue) {\r\n    const modifed = arr.slice()\r\n    modifed[arr.indexOf(oldVal)] = newValue\r\n    return modifed\r\n}\r\n\r\nexport function updateProp(obj, prop_name, new_value) {\r\n    return { ...obj, [prop_name]: new_value }\r\n}\r\n\r\nexport function convertNumberValue(value){\r\n    const as_number = Number(value)\r\n    if(Number.isFinite(as_number) && !Number.isNaN(as_number)){\r\n      return as_number\r\n    }\r\n    return value;\r\n  }","import { atom, selector, selectorFamily} from 'recoil'\r\nimport {replaceItemInArray} from './Helpers'\r\n\r\n/// Eugh\r\nexport const global_ids = {};\r\nexport function unique_id(category) {\r\n    category in global_ids ? global_ids[category] += 1 : global_ids[category] = 0\r\n    return `${category} ${global_ids[category]}`\r\n}\r\n\r\n//Data classes\r\nexport class AdventureData {\r\n    constructor() {\r\n        this.name = \"New adventure\"\r\n        this.starting_node = \"\"\r\n        this.nodes = []\r\n        this.triggers = []\r\n        this.required_site_traits = []\r\n        this.loot_types = []\r\n        this.band_modifiers = {}\r\n        this.starting_qualities = {}\r\n        this.deep_scan_description  = \"\"\r\n    }\r\n}\r\n\r\nexport class NodeData {\r\n    constructor() {\r\n        this.id = unique_id(\"Node\")\r\n        this.name = this.id\r\n        this.description = \"Node description goes here\"\r\n        this.choices = []\r\n        this.image = \"default\"\r\n        this.image_raw = undefined\r\n        this.on_enter_effects = undefined\r\n        this.on_exit_effects = undefined\r\n    }\r\n}\r\n\r\nexport class TriggerData{\r\n    constructor(){\r\n        this.id = unique_id(\"trigger\")\r\n        this.name = \"Trigger\"\r\n        this.target_node = undefined\r\n        this.on_trigger_effects = undefined\r\n        this.requirements = undefined\r\n    }\r\n}\r\n\r\nexport class ChoiceData {\r\n    constructor() {\r\n        this.id = unique_id(\"choice\")\r\n        this.key = this.id\r\n        this.name = \"New Choice\"\r\n        this.exit_node = \"FAIL\"\r\n        this.on_selection_effects = undefined\r\n        this.requirements = undefined\r\n        this.delay = 0\r\n        this.delay_message = undefined\r\n    }\r\n}\r\n\r\nexport class EffectData {\r\n    constructor() {\r\n        this.id = unique_id(\"effect\")\r\n        this.effect_type = \"Add\"\r\n        this.quality = \"Quality\"\r\n        this.value = 1\r\n    }\r\n}\r\n\r\nexport class ReqGroupData {\r\n    constructor() {\r\n        this.id = unique_id(\"req\")\r\n        this.group_type = \"AND\"\r\n        this.requirements = []\r\n    }\r\n}\r\n\r\nexport class ReqData {\r\n    constructor() {\r\n        this.id = unique_id(\"req\")\r\n        this.quality = \"Quality\"\r\n        this.operator = \"==\"\r\n        this.value = 1\r\n    }\r\n}\r\n\r\nexport const AdventureState = atom({\r\n    key: \"adventure\",\r\n    default: new AdventureData(),\r\n})\r\n\r\nexport const NodesSelector = selector({\r\n    key: \"nodes\",\r\n    get: ({ get }) => {\r\n        const adventure = get(AdventureState)\r\n        return adventure.nodes\r\n    }\r\n})\r\n\r\nexport const NodeSelector = selectorFamily({\r\n    key: \"single_node\",\r\n    get: (id) => ({ get }) => {\r\n        const adventure = get(AdventureState);\r\n        return adventure.nodes.find(x => x.id === id)\r\n    },\r\n    set: (id) => ({ set, get }, newValue) => {\r\n        const current = get(AdventureState)\r\n        const modified = { ...current, nodes: replaceItemInArray(current.nodes, current.nodes.find(x => x.id === id), newValue) }\r\n        set(AdventureState, modified)\r\n    }\r\n})\r\n\r\nexport const TriggersSelector = selector({\r\n    key: \"triggers\",\r\n    get: ({ get }) => {\r\n        const adventure = get(AdventureState)\r\n        return adventure.triggers\r\n    }\r\n})\r\n\r\nexport const TriggerSelector = selectorFamily({\r\n    key: \"single_trigger\",\r\n    get: (id) => ({ get }) => {\r\n        const adventure = get(AdventureState);\r\n        return adventure.triggers.find(x => x.id === id)\r\n    },\r\n    set: (id) => ({ set, get }, newValue) => {\r\n        const current = get(AdventureState)\r\n        const modified = { ...current, triggers: replaceItemInArray(current.triggers, current.triggers.find(x => x.id === id), newValue) }\r\n        set(AdventureState, modified)\r\n    }\r\n})\r\n","import signal_lost from './images/signal_lost.png'\r\nimport grue from './images/grue.png'\r\nimport trader from './images/trade.png'\r\nimport default_image from './images/default.png'\r\n\r\nexport const special_nodes = [\"FAIL\",\"FAIL_DEATH\",\"WIN\",\"GO_BACK\"]\r\n\r\nexport const site_traits = [\"ruins\",\"technology present\",\"space station\",\"alien\",\"habitable\",\"spaceship\",\"in space\",\"on surface\"]\r\n\r\nexport const scan_bands = [\"Plasma absorption band\",\"Hydrocarbons/Molecular oxygen\",\"Narrow-band radio waves\",\"Exotic Radiation\",\"Increased Density\"]\r\n\r\nexport const loot_types = [\"maint\",\"drugs\",\"research\",\"weapons\",\"pets\",\"unique\"]\r\n\r\n\r\nexport const preset_images = {\r\n    default : default_image,\r\n    grue : grue,\r\n    signal_lost : signal_lost,\r\n    trader : trader\r\n}\r\n\r\nexport const EffectTypes = {\r\n    Add : \"Add\",\r\n    Set : \"Set\",\r\n    Remove : \"Remove\",\r\n}\r\n\r\nexport const ValueTypes = {\r\n    raw : \"raw\",\r\n    random : \"random\"\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC7SURBVGje7ZdBDsJADAPjH2T//1lAgNrlxMVDiTynnjKyu6m6FUIIIfyA9aCtCq0XhMNo0bMoWRt7j3Za7rOPJ5fkNNj3Vk5zbVGOtiCJra9trFHSm6TdEvkka46kR0i2uX8t2bZRri+kPpax3FCSdjtESdwOpK0a05agtuwOJIiAIEUEKSKIGMmQtooIIiKIprQFSSqS71FHcjVJCD6gHzvmsuiOogVcSSO5ngQ5XcyeMDegEEIIYTBVNw34EbwIRO7ZAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP8AAP8hAFWgYwIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABbSURBVGje7dPBDYAgEEVBtAKXCmT7L1LucgRi4kwDL/nZLQAAAAAAAPxQXOsbR8SGSG3rKy0zB+m5G/ZG3q/G5A3PQeTMDRNGjeU312+htuWRjLbheQAA+KxSHrpcA/wdxXfnAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsIAAA7CARUoSoAAAADZSURBVGje7ZNRFoQgCADhBnD/y66AWenbLb935vXK1BwhEQAAAAAAAACAv0LdXLzR2tVsPepuItWZ9Gb0xgxzvww+k7Prk978LvHo1rjvSTQWb4/cYry1q9bLjnMvdWvzwhMRy4bEhqSamb5cZpHUhD66Jck0D4m8kNTIjqTy3CXxK9QsM9hDXCXqcyrfae6SfgZK4qfED6+67UnWf/IkcZmjfCPR83SlREeuJkk/XVUuW5Lc81QnkUG9FYMf5XSZuxPJWD4e9lNSIehUqAAAAAAAAAAAAFdEPmbgEwxTT+ziAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP/YAH8zAHXkPMkAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAF8SURBVGje7dkLbsMgDAZg8AnwDbzd/5BTk3aD+A9Ngp2ChvuSIuoP2W4TtWHGjBkzZsyYMWxE5uSYnpfwEuKa3il7vnmxz643b4rsVJ6+TbLnm9fdbUb05i2RvbGJ+pDIpaZUxsYO+X37DQgqtkYoCBkjeoRHQFCxNSLLbTgk6s9OG4KKvYOQM0KhfwQVW3/X34LI6945Qs4IKvZ6ltmsegj07xFUbI1I9jBC9HXFAAgs9j5CjggFc+R5McZmCCp2BbnWlGOIDITkxX4aWef/8l9pCuyoQigMhGTFjtaI1BAuVhXPPSPkhsBicxUhayTlq/pGYLHryPmmICQqRFwRNkfoIHK2KbCjCqFgjzBCslNME/J6yZG0rioPnWyKHEKEi0guyFeJcBOyFi++Rc79mgrHpkCWznMzosZGI6HFwGMDkNBg4LFhgKBLsaMBx6apNgeQ5IHwHQhKGM0RMDYbxOaPhu3YuCB7qCvCn0DSRCoRP4LwqMiMGb1GCD/OSlYEGoUISwAAAABJRU5ErkJggg==\"","import { Button, Card, ListGroup, FormControl, ListGroupItem, InputGroup } from 'react-bootstrap'\r\nimport { EffectData } from './../State'\r\nimport { convertNumberValue} from '../Helpers'\r\nimport { ValueTypes,EffectTypes } from '../ExternalDefines'\r\n\r\nfunction Effect(props) {\r\n    const handleChange = props.handleChange\r\n    const handleDelete = props.handleDelete\r\n    const value_type = props.effect.value === Object(props.effect.value) ? props.effect.value[\"value_type\"] : \"raw\"\r\n\r\n    const defaultForValueType = value_type => {\r\n        switch(value_type){\r\n            case ValueTypes.raw:\r\n                return 0\r\n            case ValueTypes.random:\r\n               return { \"value_type\": ValueTypes.random, \"low\": 0, \"high\": 0 }\r\n            default:\r\n                return 0\r\n        }\r\n    }\r\n\r\n    const toggleSpecialValueType = e => {\r\n        const allowed_types = Object.keys(ValueTypes).map(k => ValueTypes[k])\r\n        const current_index = allowed_types.indexOf(value_type)\r\n        const new_type = allowed_types[(current_index+1)%allowed_types.length]\r\n        handleChange(\"value\",defaultForValueType(new_type))\r\n    }\r\n\r\n    const value_type_controls = value_type => {\r\n        switch (value_type) {\r\n            case \"random\":\r\n                return (\r\n                    <>\r\n                        <InputGroup.Text>Random</InputGroup.Text>\r\n                        <FormControl value={props.effect.value.low} onChange={e => handleChange(\"value\", {...props.effect.value,low:convertNumberValue(e.target.value)})} />\r\n                        <InputGroup.Text>To</InputGroup.Text>\r\n                        <FormControl value={props.effect.value.high} onChange={e => handleChange(\"value\",{...props.effect.value,high:convertNumberValue(e.target.value)})} />\r\n                    </>\r\n                )\r\n            case \"raw\":\r\n                return (<FormControl value={props.effect.value} onChange={e => handleChange(\"value\", convertNumberValue(e.target.value))} />)\r\n            default:\r\n                return (<InputGroup.Text>Unsupported</InputGroup.Text>)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <InputGroup>\r\n            <FormControl as=\"select\" value={props.effect.effect_type} onChange={e => handleChange(\"effect_type\", e.target.value)}>\r\n                {Object.keys(EffectTypes).map(k => (<option key={k}>{EffectTypes[k]}</option>))}\r\n            </FormControl>\r\n            <InputGroup.Prepend>\r\n                <InputGroup.Text>Quality</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.effect.quality} onChange={e => handleChange(\"quality\", e.target.value)} />\r\n            <InputGroup.Prepend>\r\n                <InputGroup.Text>Value</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            {value_type_controls(value_type)}\r\n\r\n            <InputGroup.Append>\r\n                <Button onClick={toggleSpecialValueType}>*</Button>\r\n                <Button variant=\"danger\" onClick={handleDelete}>Delete</Button>\r\n            </InputGroup.Append>\r\n        </InputGroup>)\r\n}\r\n\r\nexport function EffectBuilder(props) {\r\n    const handleEffectsChanged = props.handleEffectsChanged\r\n    const handleEffectAdded = props.handleEffectAdded\r\n    const handleEffectDeleted = props.handleEffectDeleted\r\n    function add_effect() {\r\n        handleEffectAdded(new EffectData())\r\n    }\r\n\r\n    if (!props.effects)\r\n        return (\r\n            <InputGroup>\r\n                <InputGroup.Prepend>\r\n                    <InputGroup.Text>\r\n                        {props.title}\r\n                    </InputGroup.Text>\r\n                </InputGroup.Prepend>\r\n                <InputGroup.Append>\r\n                    <Button onClick={add_effect}>Create Effect</Button>\r\n                </InputGroup.Append>\r\n            </InputGroup>\r\n        )\r\n    return (\r\n        <>\r\n            <Card.Header>{props.title}</Card.Header>\r\n            <ListGroup>\r\n                {props.effects.map(effect => (\r\n                    <ListGroupItem key={effect.id}>\r\n                        <Effect\r\n                            effect={effect}\r\n                            handleChange={(prop, value) => handleEffectsChanged(effect, prop, value)}\r\n                            handleDelete={(prop, value) => handleEffectDeleted(effect, prop, value)} />\r\n                    </ListGroupItem>))}\r\n                <ListGroupItem>\r\n                    <Button onClick={add_effect}>Add New Effect</Button>\r\n                </ListGroupItem>\r\n            </ListGroup>\r\n        </>)\r\n}","import {ReqGroupData,ReqData} from '../State'\r\nimport {InputGroup,Button,Card,ListGroup,FormControl,ButtonGroup} from 'react-bootstrap'\r\nimport {convertNumberValue} from '../Helpers'\r\n\r\nexport function RequirementsBuilder(props) {\r\n    const handleRequirementsChanged = props.handleRequirementsChanged\r\n    const handleRequirementAdded = props.handleRequirementAdded\r\n    const handleRequirementDeleted = props.handleRequirementDeleted\r\n  \r\n    function add_req_group() {\r\n      handleRequirementAdded(new ReqGroupData())\r\n    }\r\n  \r\n    function add_req() {\r\n      handleRequirementAdded(new ReqData())\r\n    }\r\n  \r\n    if (!props.requirements) {\r\n      return (\r\n      <InputGroup>\r\n        <InputGroup.Prepend>\r\n          <InputGroup.Text>\r\n            {props.title}\r\n          </InputGroup.Text>\r\n        </InputGroup.Prepend>\r\n        <InputGroup.Append>\r\n          <Button onClick={add_req}>Add Requirements</Button>\r\n        </InputGroup.Append>\r\n      </InputGroup>)\r\n    }\r\n    return (\r\n      <>\r\n      <Card.Header>{props.title}</Card.Header>\r\n      <ListGroup>\r\n        {props.requirements.map(req => {\r\n          return req.requirements ? (\r\n            <ReqGroup\r\n              key={req.id} \r\n              group={req}\r\n              handleReqGroupChanged={(prop_name,new_value) => handleRequirementsChanged(req, prop_name, new_value)}\r\n              handleReqGroupDeleted={() => handleRequirementDeleted(req)}\r\n              />) :\r\n            (<SingleReq \r\n              key={req.id}\r\n              requirement={req}\r\n              handleReqChanged={(prop_name, new_value) => handleRequirementsChanged(req, prop_name, new_value)}\r\n              handleReqDeleted={() => handleRequirementDeleted(req)}\r\n            />)\r\n        })}\r\n        <ListGroup.Item>\r\n          <ButtonGroup>\r\n            <Button onClick={add_req_group}>Add Req Group</Button>\r\n            <Button onClick={add_req}>Add Single Req</Button>\r\n          </ButtonGroup>\r\n        </ListGroup.Item>\r\n      </ListGroup></>)\r\n  }\r\n\r\n\r\n  \r\n  function SingleReq(props) {\r\n    const handleReqDeleted = props.handleReqDeleted\r\n    const handleReqChanged = props.handleReqChanged\r\n    return (\r\n      <InputGroup>\r\n        <InputGroup.Prepend>\r\n          <InputGroup.Text>Quality</InputGroup.Text>\r\n        </InputGroup.Prepend>\r\n        <FormControl value={props.requirement.quality} onChange={e => handleReqChanged(\"quality\", e.target.value)} />\r\n        <FormControl as=\"select\" value={props.requirement.operator} onChange={e => handleReqChanged(\"operator\", e.target.value)}>\r\n          <option>==</option>\r\n          <option>!=</option>\r\n          <option>&gt;</option>\r\n          <option>&lt;</option>\r\n          <option>&gt;=</option>\r\n          <option>&lt;=</option>\r\n        </FormControl>\r\n        <FormControl value={props.requirement.value} onChange={e => handleReqChanged(\"value\", convertNumberValue(e.target.value))}/>\r\n        <InputGroup.Append>\r\n          <Button variant=\"danger\" onClick={() => handleReqDeleted(props.requirement)}>Delete</Button>\r\n        </InputGroup.Append>\r\n      </InputGroup>\r\n    )\r\n  }\r\n  \r\n  function ReqGroup(props) {\r\n    const handleReqGroupDeleted = props.handleReqGroupDeleted\r\n    const handleReqGroupChanged = props.handleReqGroupChanged\r\n\r\n    const addSubGroup = () => {\r\n      const new_group = new ReqGroupData()\r\n      const new_reqs = [...props.group.requirements, new_group]\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const addSubReq = () => {\r\n      const new_req = new ReqData()\r\n      const new_reqs = [...props.group.requirements, new_req]\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const deleteSubReq = (deleted) =>{\r\n      const new_reqs = props.group.requirements.filter(x => x !== deleted)\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const updateSubReq = (old_req,prop,new_value) =>{\r\n      const changed_req = {...old_req, [prop]:new_value}\r\n      const new_reqs = props.group.requirements.slice()\r\n      new_reqs[props.group.requirements.indexOf(old_req)] = changed_req\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    return (\r\n      <Card border=\"dark\">\r\n        <Card.Header>\r\n          <InputGroup>\r\n            <FormControl as=\"select\" value={props.group.group_type} onChange={e => handleReqGroupChanged(\"group_type\",e.target.value)}> \r\n              <option>AND</option>\r\n              <option>OR</option>\r\n            </FormControl>\r\n            <InputGroup.Text>Group</InputGroup.Text>\r\n            <InputGroup.Append>\r\n              <Button variant=\"danger\" onClick={() => handleReqGroupDeleted(props.group)} >Delete</Button>\r\n            </InputGroup.Append>\r\n          </InputGroup>\r\n        </Card.Header>\r\n        <ListGroup>\r\n          <ListGroup.Item>\r\n            {props.group.requirements.map(req =>{\r\n              return req.requirements ? \r\n                (<ReqGroup\r\n                  key={req.id}\r\n                  group={req}\r\n                  handleReqGroupDeleted={deleteSubReq}\r\n                  handleReqGroupChanged={(prop,new_value) => updateSubReq(req,prop,new_value)}\r\n                />) : \r\n                (<SingleReq\r\n                  key={req.id} \r\n                  requirement={req}\r\n                  handleReqDeleted={deleteSubReq}\r\n                  handleReqChanged={(prop,new_value) => updateSubReq(req,prop,new_value)}\r\n                />)\r\n            })}\r\n          </ListGroup.Item>\r\n          <ListGroup.Item>\r\n            <ButtonGroup>\r\n              <Button onClick={addSubGroup}>Add Req Group</Button>\r\n              <Button onClick={addSubReq}>Add Single Req</Button>\r\n            </ButtonGroup>\r\n          </ListGroup.Item>\r\n        </ListGroup>\r\n      </Card>\r\n    )\r\n  }","import React,{useState} from 'react'\r\nimport { Card, FormControl, Row,Container,Col, InputGroup,Button, FormGroup,Table } from 'react-bootstrap'\r\nimport {useRecoilState} from 'recoil'\r\nimport {AdventureState, NodesSelector} from '../State'\r\nimport {special_nodes} from '../ExternalDefines'\r\nimport {convertNumberValue,updateProp} from '../Helpers'\r\n\r\nexport function BasicCollapsible(props){\r\n    const [sectionCollapsed,setSectionCollapsed] = useState(props.startCollapsed)\r\n    return(\r\n        <Container>\r\n            <Row>\r\n                <Col>\r\n                    <Card.Header onClick={() => setSectionCollapsed(!sectionCollapsed)}><Container><Row><Col className=\"flex-grow\">{props.title}</Col><Col className=\"flex-grow-0\">{sectionCollapsed ? \"▼\" : \"▲\"}</Col></Row></Container></Card.Header>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col>\r\n                    <Container className={sectionCollapsed ? \"d-none\" : \"\"}>\r\n                        <Row>\r\n                            <Col>\r\n                                {props.children}\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                </Col>\r\n            </Row>\r\n        </Container>)\r\n  }\r\n\r\n\r\nexport function NodeSelectionDropdown(props){\r\n    const {\r\n        allowNone = false,\r\n        allowCustom = true,\r\n        ...rest\r\n    } = props;\r\n\r\n    const [nodes] = useRecoilState(NodesSelector)\r\n        return (<FormControl {...rest} as=\"select\">\r\n            {nodes.map(node => (<option key={node.id}>{node.name}</option>))}\r\n            {!!allowNone && (<option value=\"\">None</option>)}\r\n            {!!allowCustom && (special_nodes.map(name => (<option key={name}>{name}</option>)))}\r\n        </FormControl>)\r\n}\r\n\r\nexport function KeyValueList(props){\r\n    const {\r\n        presetKeys,\r\n        adventureProp,\r\n    } = props;\r\n\r\n    const [adventure,setAdventure] = useRecoilState(AdventureState)\r\n    \r\n    const store = adventure[adventureProp]\r\n    const [newKey,setNewKey] = useState(presetKeys ? presetKeys[0] : \"\")\r\n    const [newValue,setNewValue] = useState(\"\")\r\n    const store_keys = Object.keys(store)\r\n\r\n    const add_new_kv_pair = () => {\r\n        const newstore = {...store,[newKey]:newValue}\r\n        setAdventure(updateProp(adventure,adventureProp,newstore))\r\n    }\r\n\r\n    const remove_key = key => {\r\n        const newstore = {...store}\r\n        delete newstore[key]\r\n        setAdventure(updateProp(adventure,adventureProp,newstore))\r\n    }\r\n    return (<Table size=\"sm\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Quality</th>\r\n                        <th>Value</th>\r\n                        <th></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                {store_keys.map(key => (\r\n                <tr key={key}>\r\n                        <td>{key}</td>\r\n                        <td>{store[key]}</td>\r\n                        <td><Button variant=\"danger\" onClick={() => remove_key(key)}>Delete</Button></td>\r\n                </tr>\r\n                ))}\r\n                <tr>\r\n                    <td>{presetKeys ? (<FormControl as=\"select\" value={newKey} onChange={e => setNewKey(e.target.value)} >{presetKeys.map(pk => (<option key={pk}>{pk}</option>))}</FormControl>) : (<FormControl value={newKey} onChange={e => setNewKey(e.target.value)}></FormControl>)}</td>\r\n                    <td><FormControl value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))}></FormControl></td>\r\n                    <td><Button onClick={add_new_kv_pair}>Add</Button></td>\r\n                </tr>\r\n                </tbody>\r\n            </Table>)\r\n}\r\n\r\n\r\nexport function SimpleList(props){\r\n    const {\r\n        presetValues,\r\n        adventureProp,\r\n        unique= true\r\n    } = props;\r\n\r\n    const [adventure,setAdventure] = useRecoilState(AdventureState)\r\n    const store = adventure[adventureProp] || []\r\n    const [newValue,setNewValue] = useState(presetValues ? presetValues[0] : \"\")\r\n\r\n    const add_new_value = () => {\r\n        if(unique && store.indexOf(newValue) >= 0)\r\n            return\r\n        const newstore = [...store,newValue]\r\n        setAdventure(updateProp(adventure,adventureProp,newstore))\r\n    }\r\n\r\n    const remove_value = key => {\r\n        const newstore = store.filter(x => x !== key)\r\n        setAdventure(updateProp(adventure,adventureProp,newstore))\r\n    }\r\n\r\n    return (<FormGroup>\r\n            {store.map(key => (\r\n                <InputGroup key={key}>\r\n                    <InputGroup.Text>{key}</InputGroup.Text>\r\n                    <InputGroup.Append>\r\n                        <Button variant=\"danger\" onClick={() => remove_value(key)}>X</Button>\r\n                    </InputGroup.Append>\r\n                </InputGroup>\r\n            ))}\r\n            <InputGroup>\r\n                <InputGroup.Prepend>\r\n                    {presetValues ? (<FormControl as=\"select\" value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))} >{presetValues.map(pk => (<option key={pk}>{pk}</option>))}</FormControl>) : (<FormControl value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))}></FormControl>)}\r\n                </InputGroup.Prepend>\r\n                <InputGroup.Append>\r\n                    <Button onClick={add_new_value}>Add</Button>\r\n                </InputGroup.Append>\r\n            </InputGroup>\r\n        </FormGroup>)\r\n}","import React,{useState} from 'react'\r\nimport {Button, Card, InputGroup, FormControl } from 'react-bootstrap'\r\nimport {EffectBuilder} from './EffectBuilder'\r\nimport {RequirementsBuilder} from './RequirementsBuilder'\r\nimport {convertNumberValue} from '../Helpers'\r\nimport { NodeSelectionDropdown } from './Utility'\r\n\r\nexport function AdventureChoice(props) {\r\n    const handleChoiceDeletion = props.handleChoiceDeletion\r\n    const handleChoiceChange = props.handleChoiceChange\r\n  \r\n  \r\n    const addEffect = (effect_prop, new_effect) => {\r\n      const old_effects = props.choice[effect_prop]\r\n      const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n      handleChoiceChange(effect_prop, new_effects)\r\n    }\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n      const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n      const new_effects = props.choice[effect_prop].slice()\r\n      new_effects[props.choice[effect_prop].indexOf(old_effect)] = changed_effect\r\n      handleChoiceChange(effect_prop, new_effects)\r\n    }\r\n    const deleteEffect = (effect_prop, removed) => {\r\n      const new_effects = props.choice[effect_prop].filter(x => x !== removed)\r\n      handleChoiceChange(effect_prop, new_effects.length ? new_effects : undefined)\r\n    }\r\n  \r\n  \r\n    const addRequirement = added => {\r\n      const old_reqs = props.choice.requirements\r\n      const new_reqs = old_reqs !== undefined ? [...old_reqs, added] : [added]\r\n      handleChoiceChange(\"requirements\", new_reqs)\r\n    }\r\n  \r\n    const deleteRequirement = removed => {\r\n      const new_reqs = props.choice.requirements.filter(x => x !== removed)\r\n      handleChoiceChange(\"requirements\", new_reqs.length ? new_reqs : undefined)\r\n    }\r\n  \r\n    const updateRequirements = (old_req, changed_prop, new_value) => {\r\n      const changed_req = { ...old_req, [changed_prop]: new_value }\r\n      const new_reqs = props.choice.requirements.slice()\r\n      new_reqs[props.choice.requirements.indexOf(old_req)] = changed_req\r\n      handleChoiceChange(\"requirements\", new_reqs)\r\n    }\r\n    const [exitNodeSelectValue, setExitNodeSelectValue] = useState(props.choice.exit_node);\r\n  \r\n    const changeExitNode = (e) => {\r\n      setExitNodeSelectValue(e.target.value)\r\n      handleChoiceChange(\"exit_node\", e.target.value)\r\n    }\r\n  \r\n  \r\n    return (\r\n      <Card>\r\n        <Card.Body>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Choice</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.choice.name} onChange={(e) => handleChoiceChange(\"name\", e.target.value)} />\r\n            <InputGroup.Append>\r\n              <Button variant=\"danger\" onClick={handleChoiceDeletion}>Delete</Button>\r\n            </InputGroup.Append>\r\n          </InputGroup>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Exit Node</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <NodeSelectionDropdown value={exitNodeSelectValue} onChange={changeExitNode} allowNone={false}/>\r\n          </InputGroup>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Delay(ds)</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.choice.delay} onChange={(e) => handleChoiceChange(\"delay\", convertNumberValue(e.target.value))} />\r\n            <InputGroup.Text>Message</InputGroup.Text>\r\n            <FormControl value={props.choice.delay_message} onChange={(e) => handleChoiceChange(\"delay_message\", e.target.value)} />\r\n          </InputGroup>\r\n          <EffectBuilder\r\n              title=\"Selection Effects\"\r\n              effects={props.choice.on_selection_effects}\r\n              handleEffectAdded={added => addEffect(\"on_selection_effects\", added)}\r\n              handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_selection_effects\", old, prop, new_value)}\r\n              handleEffectDeleted={deleted => deleteEffect(\"on_selection_effects\", deleted)}/>\r\n          <RequirementsBuilder\r\n            title=\"Requirements\"\r\n            requirements={props.choice.requirements}\r\n            handleRequirementAdded={addRequirement}\r\n            handleRequirementDeleted={deleteRequirement}\r\n            handleRequirementsChanged={updateRequirements}\r\n          />\r\n        </Card.Body>\r\n      </Card>)\r\n  }","import React, { useRef } from 'react';\r\nimport { Button, Card,Image, FormControl, FormGroup, Form, InputGroup, Container,Col,Row } from 'react-bootstrap'\r\nimport { useRecoilState } from 'recoil'\r\nimport { updateProp } from '../Helpers'\r\nimport { NodeSelector, ChoiceData } from '../State'\r\nimport { AdventureChoice } from './AdventureChoice'\r\nimport { EffectBuilder } from './EffectBuilder'\r\nimport {preset_images} from '../ExternalDefines'\r\n\r\n\r\nexport function AdventureNode(props) {\r\n    const handleNodeDeletion = props.handleNodeDeletion\r\n\r\n    const [node, setNode] = useRecoilState(NodeSelector(props.node.id))\r\n\r\n    const update_node_name = (e) => {\r\n        const modified_node = updateProp(node, \"name\", e.target.value)\r\n        setNode(modified_node)\r\n    }\r\n\r\n    const addChoice = (new_choice) => {\r\n        const new_choices = [...props.node.choices, new_choice]\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n\r\n    const removeChoice = (removed) => {\r\n        const new_choices = props.node.choices.filter(x => x !== removed)\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n    const updateChoice = (old_choice, new_choice) => {\r\n        const new_choices = props.node.choices.slice()\r\n        new_choices[props.node.choices.indexOf(old_choice)] = new_choice\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n\r\n    const addEffect = (effect_prop, new_effect) => {\r\n        const old_effects = props.node[effect_prop]\r\n        const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n        setNode(updateProp(node, effect_prop, new_effects))\r\n    }\r\n\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n        const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n        const new_effects = props.node[effect_prop].slice()\r\n        new_effects[props.node[effect_prop].indexOf(old_effect)] = changed_effect\r\n        setNode(updateProp(node, effect_prop, new_effects))\r\n    }\r\n\r\n    const deleteEffect = (effect_prop, removed) => {\r\n        const new_effects = props.node[effect_prop].filter(x => x !== removed)\r\n        setNode(updateProp(node, effect_prop, new_effects.length ? new_effects : undefined))\r\n    }\r\n\r\n    const current_image = node.raw_image ? node.raw_image : preset_images[node.image]\r\n    const imageInput = useRef()\r\n    const try_uploading_image = () => {\r\n        imageInput.current.click() //god why\r\n    }\r\n\r\n    const setUploadedImage = (e) => {\r\n        var reader = new FileReader()\r\n        reader.onload = (e) => {\r\n            var uploaded_image = new Image()\r\n            uploaded_image.onload = () =>{\r\n                if(uploaded_image.width !== 200 || uploaded_image.height !== 100){\r\n                    alert(`Adventure images need to be be 200x100 pngs.`)\r\n                    return\r\n                }\r\n                const modified_node = {...node,\r\n                    raw_image:e.target.result,\r\n                    image:null\r\n                }\r\n                setNode(modified_node)\r\n            }\r\n            uploaded_image.src = e.target.result\r\n        }\r\n        reader.readAsDataURL(e.target.files[0])\r\n    }\r\n\r\n    const reset_image = () => {\r\n        const modified_node = {...node,\r\n            raw_image:undefined,\r\n            image:\"default\"\r\n        }\r\n        setNode(modified_node)\r\n    }\r\n\r\n    const update_image = e => {\r\n        setNode(updateProp(node,\"image\",e.target.value))\r\n    }\r\n\r\n    const image_name_text = node.raw_image ? \"custom image data\" : node.image\r\n    return (\r\n        <>\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <Card.Title>{node.name} <Button variant=\"danger\" onClick={handleNodeDeletion}>Delete</Button></Card.Title>\r\n                            <Image src={current_image} width=\"400px\" height=\"200px\"/>\r\n                            <InputGroup>\r\n                                <InputGroup.Prepend>\r\n                                    <InputGroup.Text>Image</InputGroup.Text>\r\n                                </InputGroup.Prepend>\r\n                                <Form.Control as=\"select\" value={image_name_text} readOnly={node.raw_image !== undefined} onChange={update_image}>\r\n                                    {Object.keys(preset_images).map(k => (<option key={k}>{k}</option>))}\r\n                                    </Form.Control>\r\n                                <Form.File type='file' accept=\"image/png\" ref={imageInput} onChange={setUploadedImage} style={{display:\"none\"}}/>\r\n                                <InputGroup.Append>\r\n                                    <Button onClick={try_uploading_image}>Custom</Button>\r\n                                    <Button onClick={reset_image}>Reset</Button>\r\n                                </InputGroup.Append>\r\n                            </InputGroup>\r\n                            <FormGroup>\r\n                                <Form.Label>Node ID</Form.Label>\r\n                                <FormControl value={node.name} onChange={update_node_name} />\r\n                            </FormGroup>\r\n                            <FormGroup>\r\n                                <Form.Label>Description</Form.Label>\r\n                                <FormControl as=\"textarea\" rows={5} placeholder=\"Describe whatever here.\" value={node.description} onChange={(e) => setNode(updateProp(node, \"description\", e.target.value))} />\r\n                            </FormGroup>\r\n                            <EffectBuilder\r\n                                title=\"On Enter Effects\"\r\n                                effects={node.on_enter_effects}\r\n                                handleEffectAdded={added => addEffect(\"on_enter_effects\", added)}\r\n                                handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_enter_effects\", old, prop, new_value)}\r\n                                handleEffectDeleted={deleted => deleteEffect(\"on_enter_effects\", deleted)} />\r\n                            <EffectBuilder\r\n                                title=\"On Exit Effects\"\r\n                                effects={node.on_exit_effects}\r\n                                parent_id={node.id}\r\n                                handleEffectAdded={added => addEffect(\"on_exit_effects\", added)}\r\n                                handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_exit_effects\", old, prop, new_value)}\r\n                                handleEffectDeleted={deleted => deleteEffect(\"on_exit_effects\", deleted)} />\r\n                            <Card.Header>Choices</Card.Header>\r\n                                {node.choices.map(choice => (\r\n                                        <AdventureChoice\r\n                                            key={choice.id}\r\n                                            choice={choice}\r\n                                            handleChoiceDeletion={() => removeChoice(choice)}\r\n                                            handleChoiceChange={(choice_property, new_value) => {\r\n                                                const new_choice = { ...choice, [choice_property]: new_value }\r\n                                                updateChoice(choice, new_choice)\r\n                                            }}\r\n                                        />))}\r\n                                <Button onClick={() => addChoice(new ChoiceData())}>Add Choice</Button>\r\n                        </Card.Body>\r\n                    </Card>\r\n            </>\r\n    )\r\n}","import React from 'react';\r\nimport { Button, Card, FormControl, FormGroup, Form } from 'react-bootstrap'\r\nimport { useRecoilState } from 'recoil'\r\nimport { updateProp } from '../Helpers'\r\nimport { TriggerSelector } from '../State'\r\nimport { RequirementsBuilder } from './RequirementsBuilder'\r\nimport { EffectBuilder } from './EffectBuilder'\r\nimport {NodeSelectionDropdown} from './Utility'\r\n\r\n\r\nexport function AdventureTrigger(props) {\r\n    const handleDeletion = props.handleDeletion\r\n\r\n    const [trigger, setTrigger] = useRecoilState(TriggerSelector(props.trigger.id))\r\n\r\n    const update_trigger_name = (e) => {\r\n        setTrigger(updateProp(trigger, \"name\", e.target.value))\r\n    }\r\n\r\n    const update_trigger_target_node = (e) => {\r\n        setTrigger(updateProp(trigger, \"target_node\", e.target.value))\r\n    }\r\n\r\n    const addEffect = (effect_prop, new_effect) => {\r\n        const old_effects = props.trigger[effect_prop]\r\n        const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects))\r\n    }\r\n\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n        const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n        const new_effects = props.trigger[effect_prop].slice()\r\n        new_effects[props.trigger[effect_prop].indexOf(old_effect)] = changed_effect\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects))\r\n    }\r\n\r\n    const deleteEffect = (effect_prop, removed) => {\r\n        const new_effects = props.trigger[effect_prop].filter(x => x !== removed)\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects.length ? new_effects : undefined))\r\n    }\r\n\r\n    const addRequirement = added => {\r\n        const old_reqs = props.trigger.requirements\r\n        const new_reqs = old_reqs !== undefined ? [...old_reqs, added] : [added]\r\n        setTrigger(updateProp(trigger,\"requirements\", new_reqs))\r\n    }\r\n\r\n    const deleteRequirement = removed => {\r\n        const new_reqs = props.trigger.requirements.filter(x => x !== removed)\r\n        setTrigger(updateProp(trigger,\"requirements\",  new_reqs.length ? new_reqs : undefined))\r\n    }\r\n\r\n    const updateRequirements = (old_req, changed_prop, new_value) => {\r\n        const changed_req = { ...old_req, [changed_prop]: new_value }\r\n        const new_reqs = props.trigger.requirements.slice()\r\n        new_reqs[props.trigger.requirements.indexOf(old_req)] = changed_req\r\n        setTrigger(updateProp(trigger,\"requirements\",  new_reqs))\r\n    }\r\n\r\n\r\n    return (\r\n        <Card>\r\n            <Card.Body>\r\n                <Card.Title>Trigger <Button variant=\"danger\" onClick={handleDeletion}>Delete</Button></Card.Title>\r\n                <FormGroup>\r\n                    <Form.Label>Trigger ID</Form.Label>\r\n                    <FormControl value={trigger.name} onChange={update_trigger_name} />\r\n                </FormGroup>\r\n                <FormGroup>\r\n                    <Form.Label>Target Node On Trigger</Form.Label>\r\n                    <NodeSelectionDropdown allowNone={true} value={trigger.target_node} onChange={update_trigger_target_node}/>\r\n                </FormGroup>\r\n                <EffectBuilder\r\n                    title=\"On Trigger Effects\"\r\n                    effects={trigger.on_trigger_effects}\r\n                    handleEffectAdded={added => addEffect(\"on_trigger_effects\", added)}\r\n                    handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_trigger_effects\", old, prop, new_value)}\r\n                    handleEffectDeleted={deleted => deleteEffect(\"on_trigger_effects\", deleted)} />\r\n                <RequirementsBuilder\r\n                    title=\"Trigger Requirements\"\r\n                    requirements={props.trigger.requirements}\r\n                    handleRequirementAdded={addRequirement}\r\n                    handleRequirementDeleted={deleteRequirement}\r\n                    handleRequirementsChanged={updateRequirements}\r\n                />\r\n            </Card.Body>\r\n        </Card>\r\n\r\n    )\r\n}","import React, { useState } from 'react';\r\nimport { Button, Col, Container, Row, Card,Alert,Table } from 'react-bootstrap'\r\nimport {preset_images,EffectTypes,ValueTypes} from '../ExternalDefines'\r\nimport {useRecoilState} from 'recoil'\r\nimport { AdventureState } from '../State';\r\n\r\n\r\nexport function AdventurePlayer(props) {\r\n\r\n    const [adventure] = useRecoilState(AdventureState)\r\n\r\n    const [currentNode,setCurrentNode] = useState(adventure.nodes.find(node => node.name === adventure.starting_node) || adventure.nodes[0])\r\n    const [qualities,setQualities] = useState(adventure.starting_qualities)\r\n    const [prevNode,setPrevNode] = useState(currentNode ? currentNode.name : \"\")\r\n    \r\n    const restart_test = () => {\r\n        setCurrentNode(adventure.nodes.find(node => node.name === adventure.starting_node) || adventure.nodes[0])\r\n        setQualities(adventure.starting_qualities)\r\n        setPrevNode(currentNode.name)\r\n    }\r\n\r\n    const checkReq = req => {\r\n        switch(req.operator){\r\n            case \"==\":\r\n                if(qualities[req.quality] === req.value)\r\n                    return true\r\n                break\r\n            case \"!=\":\r\n                if(qualities[req.quality] !== req.value)\r\n                    return true\r\n                break\r\n            case \"<=\":\r\n                if(qualities[req.quality] <= req.value)\r\n                    return true\r\n                break\r\n            case \">=\":\r\n                if(qualities[req.quality] >= req.value)\r\n                    return true\r\n                break\r\n            case \">\":\r\n                if(qualities[req.quality] > req.value)\r\n                    return true\r\n                break\r\n            case \"<\":\r\n                if(qualities[req.quality] < req.value)\r\n                    return true\r\n                break\r\n            default:\r\n                alert(\"Unknown operator\")\r\n        }\r\n    }\r\n\r\n    const check_group = (req_group,group_type) => {\r\n        switch(group_type){\r\n            case \"AND\":\r\n                for(let req of req_group){\r\n                    if(req.group_type !== undefined){\r\n                        if(!check_group(req.requirements,req.group_type))\r\n                            return false;\r\n                    }\r\n                    if(!checkReq(req))\r\n                        return false\r\n                }\r\n                return true;\r\n            case \"OR\":\r\n                for(let req of req_group){\r\n                    if(req.group_type !== undefined){\r\n                        if(check_group(req,req.group_type))\r\n                            return true;\r\n                    }\r\n                    if(checkReq(req))\r\n                        return true;\r\n                }\r\n                return false;\r\n            default:\r\n                alert(\"wrong group_type\")\r\n        }\r\n    }\r\n\r\n    const checkChoice = choice => {\r\n        if(choice.requirements === undefined)\r\n            return true\r\n        return check_group(choice.requirements,\"AND\")\r\n    }\r\n\r\n    const navigateToNode = node_name => {\r\n        if(currentNode.on_exit_effects !== undefined){\r\n            if(apply_effects(currentNode.on_exit_effects))\r\n                return\r\n        }\r\n        switch(node_name){\r\n            case \"WIN\":\r\n                alert(\"Here you would complete the adventure in real game and recieve loot.\")\r\n                break\r\n            case \"FAIL\":\r\n                alert(\"Here you would lose the adventure in real game and get dealt half integrity as damage.\")\r\n                break\r\n            case \"FAIL_DEATH\":\r\n                alert(\"Here you would lose the adventure in real game and blown up.\")\r\n                break\r\n            case \"GO_BACK\":\r\n                navigateToNode(prevNode.name)\r\n                break\r\n            default:\r\n                const next_node = adventure.nodes.find(node => node.name === node_name)\r\n                setCurrentNode(next_node)\r\n                if(prevNode !== next_node.name)\r\n                    setPrevNode(next_node.name)\r\n                if(next_node.on_enter_effects !== undefined){\r\n                    if(apply_effects(next_node.on_enter_effects))\r\n                        return\r\n                }\r\n        }\r\n    }\r\n    const triggerGuard = []\r\n    const checkTriggers = () => {\r\n        if(adventure.triggers !== undefined){\r\n            for (let trigger of adventure.triggers) {\r\n                if(!check_group(trigger.requirements,\"AND\"))\r\n                    continue\r\n                if(triggerGuard.includes(trigger)){\r\n                    alert(`Recursive trigger detected. ${trigger.name}`)\r\n                    continue\r\n                }\r\n                triggerGuard.push(trigger)\r\n                if(trigger.on_trigger_effects !== undefined){\r\n                    if(apply_effects(trigger.on_trigger_effects))\r\n                        return true\r\n                }\r\n                if(trigger.target_node !== undefined)\r\n                    navigateToNode(trigger.target_node)\r\n                    return true\r\n            }\r\n        }\r\n        triggerGuard.length = 0\r\n        return false;\r\n    }\r\n\r\n    ///thanks mdn\r\n    const getRandomInt = (min, max) => {\r\n        min = Math.ceil(min);\r\n        max = Math.floor(max);\r\n        return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive\r\n    }\r\n\r\n    const extractValue = value => {\r\n        if(value === Object(value)){\r\n            switch(value.value_type){\r\n                case ValueTypes.random:\r\n                    return getRandomInt(value.low,value.high)\r\n                default:\r\n                    alert(\"wrong value type\")\r\n            }\r\n        }\r\n        return value;\r\n    }\r\n\r\n    const apply_effects = effect_list => {\r\n        for (let effect of effect_list) {\r\n            const extractedValue = extractValue(effect.value)\r\n            switch(effect.effect_type){\r\n                case EffectTypes.Add:\r\n                    const a = {...qualities,[effect.quality]:(qualities[effect.quality] || 0)+extractedValue}\r\n                    setQualities(a)\r\n                    break;\r\n                case EffectTypes.Set:\r\n                    const b = {...qualities,[effect.quality]:extractedValue}\r\n                    setQualities(b)\r\n                    break;\r\n                case EffectTypes.Remove:\r\n                    const c = {...qualities}\r\n                    delete c[effect.quality]\r\n                    setQualities(c)\r\n                    break;\r\n                default:\r\n                    alert(\"wrong effect type\")\r\n            }\r\n        }\r\n        if(checkTriggers())\r\n            return true\r\n        return false;\r\n    }\r\n\r\n    const selectChoice = (choice) => {\r\n        if(choice.on_selection_effects !== undefined){\r\n            if(apply_effects(choice.on_selection_effects))\r\n                return\r\n        }\r\n        navigateToNode(choice.exit_node)\r\n    }\r\n\r\n    if(!currentNode)\r\n        return (<Alert variant=\"danger\">You need at least one node to play.</Alert>)\r\n\r\n    return (\r\n        <Container>\r\n            <Alert variant=\"danger\">Delays are not implemented. Choices shown as disabled would not be visible in-game</Alert>\r\n            <Row>\r\n                <Col>\r\n                    <Button onClick={restart_test}>Restart</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col>\r\n                    <Card>\r\n                        <Card.Img src={currentNode.raw_image ? currentNode.raw_image : preset_images[currentNode.image]}/>\r\n                        <Card.Body>\r\n                            <Card.Text>{currentNode.description}</Card.Text>\r\n                            <Container>\r\n                                {currentNode.choices.map(choice => (\r\n                                    <Row key={choice.id}><Col><Button disabled={!checkChoice(choice)} onClick={() => selectChoice(choice)}>{choice.name}</Button></Col></Row>\r\n                                ))}\r\n                            </Container>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Quality</th>\r\n                            <th>Value</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {Object.keys(qualities).map(qname => (<tr key={qname}><td>{qname}</td><td>{qualities[qname]}</td></tr>)) }\r\n                    </tbody>\r\n                </Table>\r\n            </Row>\r\n        </Container>\r\n    )\r\n}","import React,{useRef, useState} from 'react'\r\nimport { Button, Col, Container, Row, Tab, Nav, FormControl, FormGroup, Form, ButtonGroup,Modal } from 'react-bootstrap'\r\nimport {useRecoilState} from 'recoil'\r\nimport {AdventureState,NodesSelector,NodeData,TriggersSelector,TriggerData, unique_id} from './../State'\r\nimport {updateProp} from './../Helpers'\r\nimport {AdventureNode} from './AdventureNode'\r\nimport {AdventureTrigger} from './AdventureTrigger'\r\nimport {BasicCollapsible,NodeSelectionDropdown, KeyValueList, SimpleList} from './Utility'\r\nimport {scan_bands, loot_types, site_traits} from '../ExternalDefines'\r\nimport { AdventurePlayer } from './AdventurePlayer'\r\n\r\n\r\nexport function AdventureEditor() {\r\n    const [adventure,setAdventure] = useRecoilState(AdventureState);\r\n    const [nodes] = useRecoilState(NodesSelector)\r\n    const [triggers] = useRecoilState(TriggersSelector)\r\n\r\n    const [activeTab,setActiveTab] = useState(\"\")\r\n    const [draggedItem,setDraggedItem] = useState(null)\r\n   \r\n    const add_node = () => {\r\n      const modified_adventure = {...adventure,\r\n        nodes:[...nodes,new NodeData()]\r\n      }\r\n      setAdventure(modified_adventure)\r\n    }\r\n    const delete_node = (node) => {\r\n      const changed_nodes = nodes.filter(x => x !== node)\r\n      setAdventure(updateProp(adventure,\"nodes\",changed_nodes))\r\n    }\r\n\r\n    const add_trigger = () => {\r\n      const modified_adventure = {...adventure,\r\n        triggers:[...triggers,new TriggerData()]\r\n      }\r\n      setAdventure(modified_adventure)\r\n\r\n    }\r\n    const delete_trigger = (trigger) => {\r\n      const changed_triggers = triggers.filter(x => x !== trigger)\r\n      setAdventure(updateProp(adventure,\"triggers\",changed_triggers))\r\n      \r\n    }\r\n\r\n    \r\n    const handleExport = () => {\r\n      const data_object = {\r\n        adventure_name: adventure.name,\r\n        starting_node: startingNode,\r\n        starting_qualities: adventure.starting_qualities,\r\n        required_site_traits: adventure.required_site_traits,\r\n        loot_categories : adventure.loot_types,\r\n        scan_band_mods : adventure.band_modifiers,\r\n        deep_scan_description : adventure.deep_scan_description,\r\n        triggers : adventure.triggers,\r\n        nodes: nodes\r\n      }\r\n      //Internal stuff, byond doesn't care about this\r\n      const remove_ids = (key, value) => {\r\n        if (key === \"id\")\r\n          return undefined\r\n        return value;\r\n      }\r\n      const blob = new Blob([JSON.stringify(data_object, remove_ids)], { type: 'application/json' })\r\n      const blob_url = URL.createObjectURL(blob)\r\n      \r\n      ExportLink.current.href = blob_url\r\n      ExportLink.current.download = `${adventure.name}.json`\r\n      ExportLink.current.click();\r\n    }\r\n\r\n    const regenerate_reqs = req_list => {\r\n      for(var req of req_list){\r\n        req.id = unique_id(\"req\")\r\n        if(req.group_type !== undefined){\r\n          if(req.requirements !== undefined)\r\n            regenerate_reqs(req.requirements)\r\n        }\r\n      }\r\n    }\r\n\r\n    const regenerate_effects = effects => {\r\n      for(var effect of effects){\r\n        effect.id = unique_id(\"effect\")\r\n      }\r\n    }\r\n    /// Regenerates temporary ids\r\n    const regenerate_ids = node_list =>{\r\n      for(var node of node_list){\r\n        node.id = unique_id(\"Node\")\r\n        for(var choice of node.choices){\r\n          choice.id = unique_id(\"choice\")\r\n          if(choice.on_selection_effects !== undefined){\r\n            regenerate_effects(choice.on_selection_effects)\r\n          }\r\n          if(choice.requirements !== undefined){\r\n            regenerate_reqs(choice.requirements)\r\n          }\r\n        }\r\n        if(node.on_enter_effects !== undefined)\r\n          regenerate_effects(node.on_enter_effects)\r\n        if(node.on_exit_effects !== undefined)\r\n          regenerate_effects(node.on_exit_effects)\r\n      }\r\n      return node_list\r\n    }\r\n\r\n    const regenerate_trigger_ids = trigger_list => {\r\n      for(var trigger of trigger_list){\r\n        trigger.id = unique_id(\"trigger\")\r\n        if(trigger.requirements !== undefined){\r\n          regenerate_reqs(trigger.requirements)\r\n        }\r\n        if(trigger.on_trigger_effects !== undefined){\r\n          regenerate_effects(trigger.on_trigger_effects)\r\n        }\r\n      }\r\n      return trigger_list\r\n    }\r\n  \r\n    const handleImport = e => {\r\n      var reader = new FileReader()\r\n      reader.onload = (e) =>{\r\n        const result = JSON.parse(e.target.result)\r\n\r\n        const reindexed_nodes = regenerate_ids(result.nodes)\r\n        const reindexed_triggers = regenerate_trigger_ids(result.triggers)\r\n\r\n        const modified_adventure = {...adventure,\r\n          name:result.adventure_name,\r\n          starting_node:result.starting_node,\r\n          starting_qualities:result.starting_qualities,\r\n          required_site_traits:result.required_site_traits,\r\n          band_modifiers:result.scan_band_mods,\r\n          loot_types:result.loot_categories,\r\n          triggers:reindexed_triggers,\r\n          nodes:reindexed_nodes\r\n        }\r\n        setAdventure(modified_adventure)\r\n      }\r\n      reader.readAsText(e.target.files[0])\r\n    }\r\n\r\n    const ImportInput = useRef()\r\n    const clickImport = () => {\r\n      ImportInput.current.click()\r\n    }\r\n\r\n    const ExportLink = useRef()\r\n\r\n    const start_dragging = (e,node) => {\r\n      setDraggedItem(node)\r\n    } \r\n\r\n    const end_dragging = () => {\r\n      setDraggedItem(null)\r\n    }\r\n\r\n    const switch_node = (node) => {\r\n      if(draggedItem != null){\r\n        const index_a = nodes.indexOf(node)\r\n        const index_b = nodes.indexOf(draggedItem)\r\n        const modified_nodes = nodes.slice();\r\n        [modified_nodes[index_a],modified_nodes[index_b]] = [modified_nodes[index_b],modified_nodes[index_a]]\r\n        setAdventure(updateProp(adventure,\"nodes\",modified_nodes))\r\n      }\r\n    }\r\n\r\n    const validate_drop = (e,node) => {\r\n      if(draggedItem != null && node !== draggedItem){\r\n        e.preventDefault()\r\n      }\r\n    }\r\n\r\n    const getDefaultTab = () => {\r\n      if(nodes.length)\r\n        return nodes[0].id.toString()\r\n    }\r\n    const openTab = activeTab || getDefaultTab()\r\n    \r\n    const getDefaultStartingNode = () => {\r\n      if(nodes.length)\r\n        return nodes[0].name\r\n    }\r\n    const startingNode = adventure.starting_node || getDefaultStartingNode()\r\n\r\n\r\n    const [playing,setPlaying] = useState(false)\r\n\r\n    const toggle_playing = () => {\r\n      setPlaying(!playing)\r\n    }\r\n\r\n    return (\r\n    <>\r\n    <Modal show={playing} onHide={toggle_playing}>\r\n      <AdventurePlayer adventure={adventure}/>\r\n    </Modal>\r\n    <Container>\r\n      <Row>\r\n        <Col>\r\n        <ButtonGroup>\r\n            <Button onClick={handleExport}>Export</Button>\r\n            <a ref={ExportLink} style={{display:\"none\"}} href=\"/\">God is this really how JS supposed to work</a>\r\n            <Button onClick={clickImport}>Import</Button>\r\n            <Form.File\r\n              onChange={handleImport}\r\n              accept=\".json\"\r\n              ref={ImportInput}\r\n              style ={{display:\"none\"}}/>\r\n            <Button onClick={toggle_playing}>Test</Button>\r\n        </ButtonGroup>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n        <BasicCollapsible title=\"Adventure Config\">\r\n            <Form>\r\n              <FormGroup>\r\n                <Form.Label>Adventure name</Form.Label>\r\n                <FormControl placeholder=\"New adventure\" value={adventure.name} onChange={(e) => setAdventure(updateProp(adventure,\"name\",e.target.value))} />\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Starting node</Form.Label>\r\n                <NodeSelectionDropdown value={startingNode} onChange={(e) => setAdventure(updateProp(adventure,\"starting_node\",e.target.value))} allowCustom={false}/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Starting qualities</Form.Label>\r\n                <KeyValueList adventureProp=\"starting_qualities\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Required site traits</Form.Label>\r\n                <SimpleList presetValues={site_traits} adventureProp=\"required_site_traits\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Loot type</Form.Label>\r\n                <SimpleList presetValues={loot_types} adventureProp=\"loot_types\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Scanning modifiers</Form.Label>\r\n                <KeyValueList presetKeys={scan_bands} adventureProp=\"band_modifiers\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Deep scan description</Form.Label>\r\n                <FormControl value={adventure.deep_scan_description} onChange={(e) => setAdventure(updateProp(adventure,\"deep_scan_description\",e.target.value))} />\r\n              </FormGroup>\r\n            </Form>\r\n        </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n          <BasicCollapsible title=\"Nodes\">\r\n          <Tab.Container id=\"nodes\" activeKey={openTab} onSelect={e => setActiveTab(e)}>\r\n            <Row>\r\n              <Col>\r\n                <Nav variant=\"tabs\">\r\n                  {nodes.map(node => (\r\n                    <Nav.Item \r\n                      key={node.id} \r\n                      draggable \r\n                      onDragEnd={e => end_dragging(e,node)} \r\n                      onDragStart={e => start_dragging(e,node)} \r\n                      onDrop={() => switch_node(node)}\r\n                      onDragOver={e => validate_drop(e,node)}\r\n                      >\r\n                      <Nav.Link eventKey={node.id}>{node.name}</Nav.Link>\r\n                    </Nav.Item>))}\r\n                  <Nav.Item>\r\n                    <Nav.Link onClick={add_node}>Add Node</Nav.Link>\r\n                  </Nav.Item>\r\n                </Nav>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col>\r\n                <Tab.Content>\r\n                    {nodes.map(node => (\r\n                      <Tab.Pane eventKey={node.id} key={node.id}>\r\n                        <AdventureNode \r\n                          node={node}\r\n                          handleNodeDeletion={() => delete_node(node)}\r\n                          />\r\n                      </Tab.Pane>))}\r\n                  </Tab.Content>\r\n              </Col>\r\n            </Row>\r\n          </Tab.Container>\r\n          </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n        <BasicCollapsible title=\"Triggers\" startCollapsed>\r\n          <Container>\r\n            <Row>\r\n              {triggers.map(trigger => (\r\n                <Col key={trigger.id} xl=\"auto\"><AdventureTrigger trigger={trigger} handleDeletion={() => delete_trigger(trigger)}/></Col>\r\n              ))}\r\n              <Col>\r\n                <Button onClick={add_trigger}>Add Trigger</Button>\r\n              </Col>\r\n            </Row>\r\n          </Container>\r\n        </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n    </Container></>)\r\n  }","import './App.css';\r\nimport {RecoilRoot} from 'recoil'\r\nimport {AdventureEditor} from './Components/AdventureEditor'\r\n\r\n/*\r\nTODO:\r\nBasic validation of loops/invalid node ids and such.\r\nStyling this to look good aaahhh!!!\r\n*/\r\n\r\nfunction App(){\r\n  return (\r\n    <RecoilRoot>\r\n      <AdventureEditor/>\r\n    </RecoilRoot>\r\n  )\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}