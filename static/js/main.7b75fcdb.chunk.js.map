{"version":3,"sources":["Helpers.tsx","State.tsx","ExternalDefines.tsx","images/default.png","images/grue.png","images/signal_lost.png","images/trade.png","Components/EffectBuilder.tsx","Components/RequirementsBuilder.tsx","Components/Utility.tsx","Components/AdventureChoice.tsx","Components/AdventureNode.tsx","Components/AdventureTrigger.tsx","Components/AdventurePlayer.tsx","Components/AdventureEditor.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["replaceItemInArray","arr","oldVal","newValue","modifed","slice","indexOf","updateProp","obj","prop_name","new_value","convertNumberValue","value","as_number","Number","isFinite","isNaN","global_ids","unique_id","category","NodeData","id","name","description","choices","image","raw_image","on_enter_effects","on_exit_effects","this","undefined","TriggerData","target_node","on_trigger_effects","requirements","ChoiceData","key","exit_node","on_selection_effects","delay","delay_message","EffectData","effect_type","quality","ReqGroupData","group_type","ReqData","operator","AdventureState","atom","default","starting_node","nodes","triggers","required_site_traits","loot_types","band_modifiers","starting_qualities","deep_scan_description","author","NodesSelector","selector","get","NodeSelector","selectorFamily","find","x","set","current","modified","TriggersSelector","TriggerSelector","special_nodes","site_traits","scan_bands","preset_images","grue","signal_lost","trader","EffectTypes","Add","Set","Remove","ValueTypes","raw","random","Effect","props","handleChange","handleDelete","value_type","effect","Object","InputGroup","FormControl","as","onChange","e","target","keys","map","k","Prepend","Text","low","high","value_type_controls","Append","Button","onClick","allowed_types","current_index","new_type","length","defaultForValueType","variant","EffectBuilder","handleEffectsChanged","handleEffectAdded","handleEffectDeleted","add_effect","effects","Card","Header","title","ListGroup","ListGroupItem","prop","RequirementsBuilder","handleRequirementsChanged","handleRequirementAdded","handleRequirementDeleted","add_req","req","ReqGroup","group","handleReqGroupChanged","handleReqGroupDeleted","SingleReq","requirement","handleReqChanged","handleReqDeleted","Item","ButtonGroup","deleteSubReq","deleted","new_reqs","filter","updateSubReq","old_req","changed_req","border","new_group","new_req","BasicCollapsible","useState","startCollapsed","sectionCollapsed","setSectionCollapsed","Container","Row","Col","className","children","NodeSelectionDropdown","allowNone","allowCustom","rest","useRecoilValue","node","KeyValueList","presetKeys","adventureProp","useRecoilState","adventure","setAdventure","store","newKey","setNewKey","setNewValue","store_keys","Table","size","newstore","remove_key","pk","SimpleList","presetValues","unique","FormGroup","remove_value","AdventureChoice","handleChoiceDeletion","handleChoiceChange","choice","exitNodeSelectValue","setExitNodeSelectValue","Body","Form","muted","added","effect_prop","new_effect","old_effects","new_effects","addEffect","old","old_effect","changed_prop","changed_effect","updateEffects","removed","deleteEffect","old_reqs","AdventureNode","handleNodeDeletion","setNode","current_image","imageInput","useRef","image_name_text","Title","Image","src","width","height","Control","readOnly","File","type","accept","ref","reader","FileReader","onload","uploaded_image","document","createElement","modified_node","result","alert","readAsDataURL","files","style","display","click","Label","rows","placeholder","parent_id","new_choices","removeChoice","choice_property","new_choice","old_choice","updateChoice","addChoice","AdventureTrigger","handleDeletion","trigger","setTrigger","AdventurePlayer","text","currentNode","setCurrentNode","qualities","setQualities","prevNode","setPrevNode","checkReq","check_group","req_group","checkChoice","navigateToNode","node_name","apply_effects","next_node","triggerGuard","checkTriggers","includes","push","extractValue","min","max","Math","ceil","floor","effect_list","resulting_qualities","extractedValue","Alert","Img","replace","match","g1","disabled","selectChoice","qname","AdventureEditor","activeTab","setActiveTab","draggedItem","setDraggedItem","regenerate_reqs","req_list","regenerate_effects","ImportInput","ExportLink","openTab","toString","getDefaultTab","startingNode","getDefaultStartingNode","playing","setPlaying","toggle_playing","Modal","show","onHide","data_object","adventure_name","loot_categories","scan_band_mods","blob","Blob","JSON","stringify","blob_url","URL","createObjectURL","href","download","parse","reindexed_nodes","node_list","regenerate_ids","reindexed_triggers","trigger_list","regenerate_trigger_ids","modified_adventure","readAsText","Tab","activeKey","onSelect","Nav","draggable","onDragEnd","onDragStart","start_dragging","onDrop","index_a","index_b","modified_nodes","switch_node","onDragOver","preventDefault","validate_drop","Link","eventKey","Content","Pane","old_index","findIndex","changed_nodes","new_index","delete_node","xl","changed_triggers","delete_trigger","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7b75fcdb.chunk.js","sourcesContent":["//Helpers\r\nexport function replaceItemInArray<T>(arr: Array<T>, oldVal : T, newValue : T) {\r\n    const modifed = arr.slice()\r\n    modifed[arr.indexOf(oldVal)] = newValue\r\n    return modifed\r\n}\r\n\r\nexport function updateProp<X>(obj : X, prop_name : string, new_value : any) {\r\n    return { ...obj, [prop_name]: new_value }\r\n}\r\n\r\nexport function convertNumberValue(value : string){\r\n    const as_number = Number(value)\r\n    if(Number.isFinite(as_number) && !Number.isNaN(as_number)){\r\n      return as_number\r\n    }\r\n    return value;\r\n  }","import { atom, selector, selectorFamily, SerializableParam} from 'recoil'\r\nimport {replaceItemInArray} from './Helpers'\r\n\r\n/// Eugh\r\nexport const global_ids : Record<string,number> = {};\r\nexport function unique_id(category : string) {\r\n    category in global_ids ? global_ids[category] += 1 : global_ids[category] = 0\r\n    return `${category} ${global_ids[category]}`\r\n}\r\n\r\n//Data classes\r\nexport class AdventureData {\r\n    name : string;\r\n    starting_node : string;\r\n    nodes : Array<NodeData>;\r\n    triggers : Array<TriggerData>;\r\n    required_site_traits : Array<string>;\r\n    loot_types : Array<string>;\r\n    band_modifiers : Record<string,number>;\r\n    starting_qualities : Record<string,number|string>;\r\n    deep_scan_description : string;\r\n    author : string;\r\n\r\n    constructor() {\r\n        this.name = \"New adventure\"\r\n        this.starting_node = \"\"\r\n        this.nodes = []\r\n        this.triggers = []\r\n        this.required_site_traits = []\r\n        this.loot_types = []\r\n        this.band_modifiers = {}\r\n        this.starting_qualities = {}\r\n        this.deep_scan_description  = \"\"\r\n        this.author = \"Anonymous\"\r\n    }\r\n}\r\n\r\nexport class NodeData {\r\n    id : string;\r\n    name : string;\r\n    description : string;\r\n    choices : Array<ChoiceData>;\r\n    image : string;\r\n    raw_image : string | undefined;\r\n    on_enter_effects : Array<EffectData> | undefined;\r\n    on_exit_effects : Array<EffectData> | undefined;\r\n\r\n    constructor() {\r\n        this.id = unique_id(\"Node\")\r\n        this.name = this.id\r\n        this.description = \"Node description goes here\"\r\n        this.choices = []\r\n        this.image = \"default\"\r\n        this.raw_image = undefined\r\n        this.on_enter_effects = undefined\r\n        this.on_exit_effects = undefined\r\n    }\r\n}\r\n\r\nexport class TriggerData{\r\n    id : string;\r\n    name : string;\r\n    target_node : string | undefined;\r\n    on_trigger_effects : Array<EffectData> | undefined;\r\n    requirements : Array<ReqData | ReqGroupData> | undefined;\r\n    constructor(){\r\n        this.id = unique_id(\"trigger\")\r\n        this.name = \"Trigger\"\r\n        this.target_node = undefined\r\n        this.on_trigger_effects = undefined\r\n        this.requirements = undefined\r\n    }\r\n}\r\n\r\nexport class ChoiceData {\r\n    id : string;\r\n    key : string;\r\n    name : string;\r\n    exit_node : string;\r\n    on_selection_effects : Array<EffectData> | undefined;\r\n    requirements : Array<ReqData | ReqGroupData> | undefined;\r\n    delay : number;\r\n    delay_message : string | undefined;\r\n\r\n    constructor() {\r\n        this.id = unique_id(\"choice\")\r\n        this.key = this.id\r\n        this.name = \"New Choice\"\r\n        this.exit_node = \"FAIL\"\r\n        this.on_selection_effects = undefined\r\n        this.requirements = undefined\r\n        this.delay = 0\r\n        this.delay_message = undefined\r\n    }\r\n}\r\n\r\nexport class EffectData {\r\n    id : string;\r\n    effect_type : string;\r\n    quality : string;\r\n    value : string | number;\r\n    constructor() {\r\n        this.id = unique_id(\"effect\")\r\n        this.effect_type = \"Add\"\r\n        this.quality = \"Quality\"\r\n        this.value = 1\r\n    }\r\n}\r\n\r\nexport class ReqGroupData {\r\n    id : string;\r\n    group_type : string;\r\n    requirements : Array<ReqData | ReqGroupData>;\r\n    constructor() {\r\n        this.id = unique_id(\"req\")\r\n        this.group_type = \"AND\"\r\n        this.requirements = []\r\n    }\r\n}\r\n\r\nexport class ReqData {\r\n    id : string;\r\n    quality : string;\r\n    operator : string;\r\n    value : string | number;\r\n    constructor() {\r\n        this.id = unique_id(\"req\")\r\n        this.quality = \"Quality\"\r\n        this.operator = \"==\"\r\n        this.value = 1\r\n    }\r\n}\r\n\r\nexport const AdventureState = atom({\r\n    key: \"adventure\",\r\n    default: new AdventureData(),\r\n})\r\n\r\nexport const NodesSelector = selector({\r\n    key: \"nodes\",\r\n    get: ({ get }) => {\r\n        const adventure = get(AdventureState)\r\n        return adventure.nodes\r\n    }\r\n})\r\n\r\nexport const NodeSelector = selectorFamily<NodeData,SerializableParam>({\r\n    key: \"single_node\",\r\n    get: (id) => ({ get }) => {\r\n        const adventure = get(AdventureState);\r\n        return adventure.nodes.find(x => x.id === id);\r\n    },\r\n    set: (id) => ({ set, get }, newValue) => {\r\n        const current = get(AdventureState)\r\n        const modified = { ...current, nodes: replaceItemInArray(current.nodes, current.nodes.find(x => x.id === id), newValue) }\r\n        set(AdventureState, modified)\r\n    }\r\n})\r\n\r\nexport const TriggersSelector = selector({\r\n    key: \"triggers\",\r\n    get: ({ get }) => {\r\n        const adventure = get(AdventureState)\r\n        return adventure.triggers\r\n    }\r\n})\r\n\r\nexport const TriggerSelector = selectorFamily<TriggerData,SerializableParam>({\r\n    key: \"single_trigger\",\r\n    get: (id) => ({ get }) => {\r\n        const adventure = get(AdventureState);\r\n        return adventure.triggers.find(x => x.id === id);\r\n    },\r\n    set: (id) => ({ set, get }, newValue) => {\r\n        const current = get(AdventureState)\r\n        const modified = { ...current, triggers: replaceItemInArray(current.triggers, current.triggers.find(x => x.id === id), newValue) }\r\n        set(AdventureState, modified)\r\n    }\r\n})\r\n","import signal_lost from './images/signal_lost.png'\r\nimport grue from './images/grue.png'\r\nimport trader from './images/trade.png'\r\nimport default_image from './images/default.png'\r\n\r\nexport const special_nodes = [\"FAIL\",\"FAIL_DEATH\",\"WIN\",\"GO_BACK\"]\r\n\r\nexport const site_traits = [\"ruins\",\"technology present\",\"space station\",\"alien\",\"habitable\",\"spaceship\",\"in space\",\"on surface\"]\r\n\r\nexport const scan_bands = [\"Plasma absorption band\",\"Hydrocarbons/Molecular oxygen\",\"Narrow-band radio waves\",\"Exotic Radiation\",\"Increased Density\"]\r\n\r\nexport const loot_types = [\"maint\",\"drugs\",\"trade_contract\",\"weapons\",\"pets\",\"unique\",\"cash\",\"materials\"]\r\n\r\n\r\nexport const preset_images = {\r\n    default : default_image,\r\n    grue : grue,\r\n    signal_lost : signal_lost,\r\n    trader : trader\r\n}\r\n\r\nexport const EffectTypes = {\r\n    Add : \"Add\",\r\n    Set : \"Set\",\r\n    Remove : \"Remove\",\r\n}\r\n\r\nexport const ValueTypes = {\r\n    raw : \"raw\",\r\n    random : \"random\"\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC7SURBVGje7ZdBDsJADAPjH2T//1lAgNrlxMVDiTynnjKyu6m6FUIIIfyA9aCtCq0XhMNo0bMoWRt7j3Za7rOPJ5fkNNj3Vk5zbVGOtiCJra9trFHSm6TdEvkka46kR0i2uX8t2bZRri+kPpax3FCSdjtESdwOpK0a05agtuwOJIiAIEUEKSKIGMmQtooIIiKIprQFSSqS71FHcjVJCD6gHzvmsuiOogVcSSO5ngQ5XcyeMDegEEIIYTBVNw34EbwIRO7ZAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP8AAP8hAFWgYwIAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABbSURBVGje7dPBDYAgEEVBtAKXCmT7L1LucgRi4kwDL/nZLQAAAAAAAPxQXOsbR8SGSG3rKy0zB+m5G/ZG3q/G5A3PQeTMDRNGjeU312+htuWRjLbheQAA+KxSHrpcA/wdxXfnAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURQAAAP8AABv/jSIAAAAJcEhZcwAADsIAAA7CARUoSoAAAADZSURBVGje7ZNRFoQgCADhBnD/y66AWenbLb935vXK1BwhEQAAAAAAAACAv0LdXLzR2tVsPepuItWZ9Gb0xgxzvww+k7Prk978LvHo1rjvSTQWb4/cYry1q9bLjnMvdWvzwhMRy4bEhqSamb5cZpHUhD66Jck0D4m8kNTIjqTy3CXxK9QsM9hDXCXqcyrfae6SfgZK4qfED6+67UnWf/IkcZmjfCPR83SlREeuJkk/XVUuW5Lc81QnkUG9FYMf5XSZuxPJWD4e9lNSIehUqAAAAAAAAAAAAFdEPmbgEwxTT+ziAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkBAMAAAAxqGI4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP/YAH8zAHXkPMkAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAF8SURBVGje7dkLbsMgDAZg8AnwDbzd/5BTk3aD+A9Ngp2ChvuSIuoP2W4TtWHGjBkzZsyYMWxE5uSYnpfwEuKa3il7vnmxz643b4rsVJ6+TbLnm9fdbUb05i2RvbGJ+pDIpaZUxsYO+X37DQgqtkYoCBkjeoRHQFCxNSLLbTgk6s9OG4KKvYOQM0KhfwQVW3/X34LI6945Qs4IKvZ6ltmsegj07xFUbI1I9jBC9HXFAAgs9j5CjggFc+R5McZmCCp2BbnWlGOIDITkxX4aWef/8l9pCuyoQigMhGTFjtaI1BAuVhXPPSPkhsBicxUhayTlq/pGYLHryPmmICQqRFwRNkfoIHK2KbCjCqFgjzBCslNME/J6yZG0rioPnWyKHEKEi0guyFeJcBOyFi++Rc79mgrHpkCWznMzosZGI6HFwGMDkNBg4LFhgKBLsaMBx6apNgeQ5IHwHQhKGM0RMDYbxOaPhu3YuCB7qCvCn0DSRCoRP4LwqMiMGb1GCD/OSlYEGoUISwAAAABJRU5ErkJggg==\"","import { Button, Card, ListGroup, FormControl, ListGroupItem, InputGroup } from 'react-bootstrap'\r\nimport { EffectData } from '../State'\r\nimport { convertNumberValue} from '../Helpers'\r\nimport { ValueTypes,EffectTypes } from '../ExternalDefines'\r\n\r\nfunction Effect(props) {\r\n    const handleChange = props.handleChange\r\n    const handleDelete = props.handleDelete\r\n    const value_type = props.effect.value === Object(props.effect.value) ? props.effect.value[\"value_type\"] : \"raw\"\r\n\r\n    const defaultForValueType = value_type => {\r\n        switch(value_type){\r\n            case ValueTypes.raw:\r\n                return 0\r\n            case ValueTypes.random:\r\n               return { \"value_type\": ValueTypes.random, \"low\": 0, \"high\": 0 }\r\n            default:\r\n                return 0\r\n        }\r\n    }\r\n\r\n    const toggleSpecialValueType = e => {\r\n        const allowed_types = Object.keys(ValueTypes).map(k => ValueTypes[k])\r\n        const current_index = allowed_types.indexOf(value_type)\r\n        const new_type = allowed_types[(current_index+1)%allowed_types.length]\r\n        handleChange(\"value\",defaultForValueType(new_type))\r\n    }\r\n\r\n    const value_type_controls = value_type => {\r\n        switch (value_type) {\r\n            case \"random\":\r\n                return (\r\n                    <>\r\n                        <InputGroup.Text>Random</InputGroup.Text>\r\n                        <FormControl value={props.effect.value.low} onChange={e => handleChange(\"value\", {...props.effect.value,low:convertNumberValue(e.target.value)})} />\r\n                        <InputGroup.Text>To</InputGroup.Text>\r\n                        <FormControl value={props.effect.value.high} onChange={e => handleChange(\"value\",{...props.effect.value,high:convertNumberValue(e.target.value)})} />\r\n                    </>\r\n                )\r\n            case \"raw\":\r\n                return (<FormControl value={props.effect.value} onChange={e => handleChange(\"value\", convertNumberValue(e.target.value))} />)\r\n            default:\r\n                return (<InputGroup.Text>Unsupported</InputGroup.Text>)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <InputGroup>\r\n            <FormControl as=\"select\" value={props.effect.effect_type} onChange={e => handleChange(\"effect_type\", e.target.value)}>\r\n                {Object.keys(EffectTypes).map(k => (<option key={k}>{EffectTypes[k]}</option>))}\r\n            </FormControl>\r\n            <InputGroup.Prepend>\r\n                <InputGroup.Text>Quality</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.effect.quality} onChange={e => handleChange(\"quality\", e.target.value)} />\r\n            <InputGroup.Prepend>\r\n                <InputGroup.Text>Value</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            {value_type_controls(value_type)}\r\n\r\n            <InputGroup.Append>\r\n                <Button onClick={toggleSpecialValueType}>*</Button>\r\n                <Button variant=\"danger\" onClick={handleDelete}>Delete</Button>\r\n            </InputGroup.Append>\r\n        </InputGroup>)\r\n}\r\n\r\nexport function EffectBuilder(props) {\r\n    const handleEffectsChanged = props.handleEffectsChanged\r\n    const handleEffectAdded = props.handleEffectAdded\r\n    const handleEffectDeleted = props.handleEffectDeleted\r\n    function add_effect() {\r\n        handleEffectAdded(new EffectData())\r\n    }\r\n\r\n    if (!props.effects)\r\n        return (\r\n            <InputGroup>\r\n                <InputGroup.Prepend>\r\n                    <InputGroup.Text>\r\n                        {props.title}\r\n                    </InputGroup.Text>\r\n                </InputGroup.Prepend>\r\n                <InputGroup.Append>\r\n                    <Button onClick={add_effect}>Create Effect</Button>\r\n                </InputGroup.Append>\r\n            </InputGroup>\r\n        )\r\n    return (\r\n        <>\r\n            <Card.Header>{props.title}</Card.Header>\r\n            <ListGroup>\r\n                {props.effects.map(effect => (\r\n                    <ListGroupItem key={effect.id}>\r\n                        <Effect\r\n                            effect={effect}\r\n                            handleChange={(prop, value) => handleEffectsChanged(effect, prop, value)}\r\n                            handleDelete={(prop, value) => handleEffectDeleted(effect, prop, value)} />\r\n                    </ListGroupItem>))}\r\n                <ListGroupItem>\r\n                    <Button onClick={add_effect}>Add New Effect</Button>\r\n                </ListGroupItem>\r\n            </ListGroup>\r\n        </>)\r\n}","import {ReqGroupData,ReqData} from '../State'\r\nimport {InputGroup,Button,Card,ListGroup,FormControl,ButtonGroup} from 'react-bootstrap'\r\nimport {convertNumberValue} from '../Helpers'\r\n\r\nexport function RequirementsBuilder(props) {\r\n    const handleRequirementsChanged = props.handleRequirementsChanged\r\n    const handleRequirementAdded = props.handleRequirementAdded\r\n    const handleRequirementDeleted = props.handleRequirementDeleted\r\n  \r\n    function add_req_group() {\r\n      handleRequirementAdded(new ReqGroupData())\r\n    }\r\n  \r\n    function add_req() {\r\n      handleRequirementAdded(new ReqData())\r\n    }\r\n  \r\n    if (!props.requirements) {\r\n      return (\r\n      <InputGroup>\r\n        <InputGroup.Prepend>\r\n          <InputGroup.Text>\r\n            {props.title}\r\n          </InputGroup.Text>\r\n        </InputGroup.Prepend>\r\n        <InputGroup.Append>\r\n          <Button onClick={add_req}>Add Requirements</Button>\r\n        </InputGroup.Append>\r\n      </InputGroup>)\r\n    }\r\n    return (\r\n      <>\r\n      <Card.Header>{props.title}</Card.Header>\r\n      <ListGroup>\r\n        {props.requirements.map(req => {\r\n          return req.requirements ? (\r\n            <ReqGroup\r\n              key={req.id} \r\n              group={req}\r\n              handleReqGroupChanged={(prop_name,new_value) => handleRequirementsChanged(req, prop_name, new_value)}\r\n              handleReqGroupDeleted={() => handleRequirementDeleted(req)}\r\n              />) :\r\n            (<SingleReq \r\n              key={req.id}\r\n              requirement={req}\r\n              handleReqChanged={(prop_name, new_value) => handleRequirementsChanged(req, prop_name, new_value)}\r\n              handleReqDeleted={() => handleRequirementDeleted(req)}\r\n            />)\r\n        })}\r\n        <ListGroup.Item>\r\n          <ButtonGroup>\r\n            <Button onClick={add_req_group}>Add Req Group</Button>\r\n            <Button onClick={add_req}>Add Single Req</Button>\r\n          </ButtonGroup>\r\n        </ListGroup.Item>\r\n      </ListGroup></>)\r\n  }\r\n\r\n\r\n  \r\n  function SingleReq(props) {\r\n    const handleReqDeleted = props.handleReqDeleted\r\n    const handleReqChanged = props.handleReqChanged\r\n    return (\r\n      <InputGroup>\r\n        <InputGroup.Prepend>\r\n          <InputGroup.Text>Quality</InputGroup.Text>\r\n        </InputGroup.Prepend>\r\n        <FormControl value={props.requirement.quality} onChange={e => handleReqChanged(\"quality\", e.target.value)} />\r\n        <FormControl as=\"select\" value={props.requirement.operator} onChange={e => handleReqChanged(\"operator\", e.target.value)}>\r\n          <option>==</option>\r\n          <option>!=</option>\r\n          <option>&gt;</option>\r\n          <option>&lt;</option>\r\n          <option>&gt;=</option>\r\n          <option>&lt;=</option>\r\n        </FormControl>\r\n        <FormControl value={props.requirement.value} onChange={e => handleReqChanged(\"value\", convertNumberValue(e.target.value))}/>\r\n        <InputGroup.Append>\r\n          <Button variant=\"danger\" onClick={() => handleReqDeleted(props.requirement)}>Delete</Button>\r\n        </InputGroup.Append>\r\n      </InputGroup>\r\n    )\r\n  }\r\n  \r\n  function ReqGroup(props) {\r\n    const handleReqGroupDeleted = props.handleReqGroupDeleted\r\n    const handleReqGroupChanged = props.handleReqGroupChanged\r\n\r\n    const addSubGroup = () => {\r\n      const new_group = new ReqGroupData()\r\n      const new_reqs = [...props.group.requirements, new_group]\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const addSubReq = () => {\r\n      const new_req = new ReqData()\r\n      const new_reqs = [...props.group.requirements, new_req]\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const deleteSubReq = (deleted) =>{\r\n      const new_reqs = props.group.requirements.filter(x => x !== deleted)\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    const updateSubReq = (old_req,prop,new_value) =>{\r\n      const changed_req = {...old_req, [prop]:new_value}\r\n      const new_reqs = props.group.requirements.slice()\r\n      new_reqs[props.group.requirements.indexOf(old_req)] = changed_req\r\n      handleReqGroupChanged(\"requirements\",new_reqs)\r\n    }\r\n  \r\n    return (\r\n      <Card border=\"dark\">\r\n        <Card.Header>\r\n          <InputGroup>\r\n            <FormControl as=\"select\" value={props.group.group_type} onChange={e => handleReqGroupChanged(\"group_type\",e.target.value)}> \r\n              <option>AND</option>\r\n              <option>OR</option>\r\n            </FormControl>\r\n            <InputGroup.Text>Group</InputGroup.Text>\r\n            <InputGroup.Append>\r\n              <Button variant=\"danger\" onClick={() => handleReqGroupDeleted(props.group)} >Delete</Button>\r\n            </InputGroup.Append>\r\n          </InputGroup>\r\n        </Card.Header>\r\n        <ListGroup>\r\n          <ListGroup.Item>\r\n            {props.group.requirements.map(req =>{\r\n              return req.requirements ? \r\n                (<ReqGroup\r\n                  key={req.id}\r\n                  group={req}\r\n                  handleReqGroupDeleted={deleteSubReq}\r\n                  handleReqGroupChanged={(prop,new_value) => updateSubReq(req,prop,new_value)}\r\n                />) : \r\n                (<SingleReq\r\n                  key={req.id} \r\n                  requirement={req}\r\n                  handleReqDeleted={deleteSubReq}\r\n                  handleReqChanged={(prop,new_value) => updateSubReq(req,prop,new_value)}\r\n                />)\r\n            })}\r\n          </ListGroup.Item>\r\n          <ListGroup.Item>\r\n            <ButtonGroup>\r\n              <Button onClick={addSubGroup}>Add Req Group</Button>\r\n              <Button onClick={addSubReq}>Add Single Req</Button>\r\n            </ButtonGroup>\r\n          </ListGroup.Item>\r\n        </ListGroup>\r\n      </Card>\r\n    )\r\n  }","import React, { useState } from 'react'\r\nimport { Card, FormControl, Row, Container, Col, InputGroup, Button, FormGroup, Table } from 'react-bootstrap'\r\nimport { useRecoilState, useRecoilValue } from 'recoil'\r\nimport { AdventureData, AdventureState, NodesSelector } from '../State'\r\nimport { special_nodes } from '../ExternalDefines'\r\nimport { convertNumberValue, updateProp } from '../Helpers'\r\n\r\nexport function BasicCollapsible(props) {\r\n    const [sectionCollapsed, setSectionCollapsed] = useState(props.startCollapsed)\r\n    return (\r\n        <Container>\r\n            <Row>\r\n                <Col>\r\n                    <Card.Header onClick={() => setSectionCollapsed(!sectionCollapsed)}><Container><Row><Col className=\"flex-grow\">{props.title}</Col><Col className=\"flex-grow-0\">{sectionCollapsed ? \"▼\" : \"▲\"}</Col></Row></Container></Card.Header>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col>\r\n                    <Container className={sectionCollapsed ? \"d-none\" : \"\"}>\r\n                        <Row>\r\n                            <Col>\r\n                                {props.children}\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                </Col>\r\n            </Row>\r\n        </Container>)\r\n}\r\n\r\n\r\nexport function NodeSelectionDropdown(props) {\r\n    const {\r\n        allowNone = false,\r\n        allowCustom = true,\r\n        ...rest\r\n    } = props;\r\n\r\n    const nodes = useRecoilValue(NodesSelector)\r\n\r\n    return (<FormControl {...rest} as=\"select\">\r\n        {nodes.map(node => (<option key={node.id}>{node.name}</option>))}\r\n        {!!allowNone && (<option value=\"\">None</option>)}\r\n        {!!allowCustom && (special_nodes.map(name => (<option key={name}>{name}</option>)))}\r\n    </FormControl>)\r\n}\r\n\r\nexport function KeyValueList(props) {\r\n    const {\r\n        presetKeys,\r\n        adventureProp,\r\n    } = props;\r\n\r\n    const [adventure, setAdventure] = useRecoilState(AdventureState)\r\n\r\n    const store = adventure[adventureProp]\r\n    const [newKey, setNewKey] = useState(presetKeys ? presetKeys[0] : \"\")\r\n    const [newValue, setNewValue] = useState<number | string>(\"\")\r\n    const store_keys = Object.keys(store)\r\n\r\n    const add_new_kv_pair = () => {\r\n        const newstore = { ...store, [newKey]: newValue }\r\n        setAdventure(updateProp(adventure, adventureProp, newstore))\r\n    }\r\n\r\n    const remove_key = key => {\r\n        const newstore = { ...store }\r\n        delete newstore[key]\r\n        setAdventure(updateProp(adventure, adventureProp, newstore))\r\n    }\r\n    return (<Table size=\"sm\">\r\n        <thead>\r\n            <tr>\r\n                <th>Quality</th>\r\n                <th>Value</th>\r\n                <th></th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            {store_keys.map(key => (\r\n                <tr key={key}>\r\n                    <td>{key}</td>\r\n                    <td>{store[key]}</td>\r\n                    <td><Button variant=\"danger\" onClick={() => remove_key(key)}>Delete</Button></td>\r\n                </tr>\r\n            ))}\r\n            <tr>\r\n                <td>{presetKeys ? (<FormControl as=\"select\" value={newKey} onChange={e => setNewKey(e.target.value)} >{presetKeys.map(pk => (<option key={pk}>{pk}</option>))}</FormControl>) : (<FormControl value={newKey} onChange={e => setNewKey(e.target.value)}></FormControl>)}</td>\r\n                <td><FormControl value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))}></FormControl></td>\r\n                <td><Button onClick={add_new_kv_pair}>Add</Button></td>\r\n            </tr>\r\n        </tbody>\r\n    </Table>)\r\n}\r\n\r\nexport function SimpleList(props) {\r\n    const {\r\n        presetValues,\r\n        adventureProp,\r\n        unique = true\r\n    } = props;\r\n\r\n    const [adventure, setAdventure] = useRecoilState(AdventureState)\r\n    const store = adventure[adventureProp] || [] \r\n    const [newValue, setNewValue] = useState(presetValues ? presetValues[0] : \"\")\r\n\r\n    const add_new_value = () => {\r\n        if (unique && store.indexOf(newValue) >= 0)\r\n            return\r\n        const newstore = [...store, newValue]\r\n        setAdventure(updateProp(adventure, adventureProp, newstore))\r\n    }\r\n\r\n    const remove_value = key => {\r\n        const newstore = store.filter(x => x !== key)\r\n        setAdventure(updateProp(adventure, adventureProp, newstore))\r\n    }\r\n\r\n    return (<FormGroup>\r\n        {store.map(key => (\r\n            <InputGroup key={key}>\r\n                <InputGroup.Text>{key}</InputGroup.Text>\r\n                <InputGroup.Append>\r\n                    <Button variant=\"danger\" onClick={() => remove_value(key)}>X</Button>\r\n                </InputGroup.Append>\r\n            </InputGroup>\r\n        ))}\r\n        <InputGroup>\r\n            <InputGroup.Prepend>\r\n                {presetValues ? (<FormControl as=\"select\" value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))} >{presetValues.map(pk => (<option key={pk}>{pk}</option>))}</FormControl>) : (<FormControl value={newValue} onChange={e => setNewValue(convertNumberValue(e.target.value))}></FormControl>)}\r\n            </InputGroup.Prepend>\r\n            <InputGroup.Append>\r\n                <Button onClick={add_new_value}>Add</Button>\r\n            </InputGroup.Append>\r\n        </InputGroup>\r\n    </FormGroup>)\r\n}","import React,{useState} from 'react'\r\nimport {Button, Card, InputGroup, FormControl,Form } from 'react-bootstrap'\r\nimport {EffectBuilder} from './EffectBuilder'\r\nimport {RequirementsBuilder} from './RequirementsBuilder'\r\nimport {convertNumberValue} from '../Helpers'\r\nimport { NodeSelectionDropdown } from './Utility'\r\n\r\nexport function AdventureChoice(props) {\r\n    const handleChoiceDeletion = props.handleChoiceDeletion\r\n    const handleChoiceChange = props.handleChoiceChange\r\n  \r\n  \r\n    const addEffect = (effect_prop, new_effect) => {\r\n      const old_effects = props.choice[effect_prop]\r\n      const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n      handleChoiceChange(effect_prop, new_effects)\r\n    }\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n      const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n      const new_effects = props.choice[effect_prop].slice()\r\n      new_effects[props.choice[effect_prop].indexOf(old_effect)] = changed_effect\r\n      handleChoiceChange(effect_prop, new_effects)\r\n    }\r\n    const deleteEffect = (effect_prop, removed) => {\r\n      const new_effects = props.choice[effect_prop].filter(x => x !== removed)\r\n      handleChoiceChange(effect_prop, new_effects.length ? new_effects : undefined)\r\n    }\r\n  \r\n  \r\n    const addRequirement = added => {\r\n      const old_reqs = props.choice.requirements\r\n      const new_reqs = old_reqs !== undefined ? [...old_reqs, added] : [added]\r\n      handleChoiceChange(\"requirements\", new_reqs)\r\n    }\r\n  \r\n    const deleteRequirement = removed => {\r\n      const new_reqs = props.choice.requirements.filter(x => x !== removed)\r\n      handleChoiceChange(\"requirements\", new_reqs.length ? new_reqs : undefined)\r\n    }\r\n  \r\n    const updateRequirements = (old_req, changed_prop, new_value) => {\r\n      const changed_req = { ...old_req, [changed_prop]: new_value }\r\n      const new_reqs = props.choice.requirements.slice()\r\n      new_reqs[props.choice.requirements.indexOf(old_req)] = changed_req\r\n      handleChoiceChange(\"requirements\", new_reqs)\r\n    }\r\n    const [exitNodeSelectValue, setExitNodeSelectValue] = useState(props.choice.exit_node);\r\n  \r\n    const changeExitNode = (e) => {\r\n      setExitNodeSelectValue(e.target.value)\r\n      handleChoiceChange(\"exit_node\", e.target.value)\r\n    }\r\n  \r\n  \r\n    return (\r\n      <Card>\r\n        <Card.Body>\r\n          <Form.Text muted>Choice text visible to the player.</Form.Text>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Choice</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.choice.name} onChange={(e) => handleChoiceChange(\"name\", e.target.value)} />\r\n            <InputGroup.Append>\r\n              <Button variant=\"danger\" onClick={handleChoiceDeletion}>Delete</Button>\r\n            </InputGroup.Append>\r\n          </InputGroup>\r\n          <Form.Text muted>The node navigated to by choosing this choice.</Form.Text>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Exit Node</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <NodeSelectionDropdown value={exitNodeSelectValue} onChange={changeExitNode} allowNone={false}/>\r\n          </InputGroup>\r\n          <Form.Text muted>Delay between selecting the choice and entering exit node.</Form.Text>\r\n          <InputGroup>\r\n            <InputGroup.Prepend>\r\n              <InputGroup.Text>Delay(ds)</InputGroup.Text>\r\n            </InputGroup.Prepend>\r\n            <FormControl value={props.choice.delay} onChange={(e) => handleChoiceChange(\"delay\", convertNumberValue(e.target.value))} />\r\n            <InputGroup.Text>Message</InputGroup.Text>\r\n            <FormControl value={props.choice.delay_message} onChange={(e) => handleChoiceChange(\"delay_message\", e.target.value)} />\r\n          </InputGroup>\r\n          <Form.Text muted>Quality changes that happen on selecting this choice. (Before navigating to exit node)</Form.Text>\r\n          <EffectBuilder\r\n              title=\"Selection Effects\"\r\n              effects={props.choice.on_selection_effects}\r\n              handleEffectAdded={added => addEffect(\"on_selection_effects\", added)}\r\n              handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_selection_effects\", old, prop, new_value)}\r\n              handleEffectDeleted={deleted => deleteEffect(\"on_selection_effects\", deleted)}/>\r\n          <Form.Text muted>Qualities required for this choice to be availible. Empty set means it's always viable.</Form.Text>\r\n          <RequirementsBuilder\r\n            title=\"Requirements\"\r\n            requirements={props.choice.requirements}\r\n            handleRequirementAdded={addRequirement}\r\n            handleRequirementDeleted={deleteRequirement}\r\n            handleRequirementsChanged={updateRequirements}\r\n          />\r\n        </Card.Body>\r\n      </Card>)\r\n  }","import React, { useRef } from 'react';\r\nimport { Button, Card,Image, FormControl, FormGroup, Form, InputGroup } from 'react-bootstrap'\r\nimport { useRecoilState } from 'recoil'\r\nimport { updateProp } from '../Helpers'\r\nimport { NodeSelector, ChoiceData } from '../State'\r\nimport { AdventureChoice } from './AdventureChoice'\r\nimport { EffectBuilder } from './EffectBuilder'\r\nimport {preset_images} from '../ExternalDefines'\r\n\r\n\r\nexport function AdventureNode(props) {\r\n    const handleNodeDeletion = props.handleNodeDeletion\r\n\r\n    const [node, setNode] = useRecoilState(NodeSelector(props.node.id))\r\n\r\n    const update_node_name = (e) => {\r\n        const modified_node = updateProp(node, \"name\", e.target.value)\r\n        setNode(modified_node)\r\n    }\r\n\r\n    const addChoice = (new_choice) => {\r\n        const new_choices = [...props.node.choices, new_choice]\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n\r\n    const removeChoice = (removed) => {\r\n        const new_choices = props.node.choices.filter(x => x !== removed)\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n    const updateChoice = (old_choice, new_choice) => {\r\n        const new_choices = props.node.choices.slice()\r\n        new_choices[props.node.choices.indexOf(old_choice)] = new_choice\r\n        setNode(updateProp(node, \"choices\", new_choices))\r\n    }\r\n\r\n    const addEffect = (effect_prop, new_effect) => {\r\n        const old_effects = props.node[effect_prop]\r\n        const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n        setNode(updateProp(node, effect_prop, new_effects))\r\n    }\r\n\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n        const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n        const new_effects = props.node[effect_prop].slice()\r\n        new_effects[props.node[effect_prop].indexOf(old_effect)] = changed_effect\r\n        setNode(updateProp(node, effect_prop, new_effects))\r\n    }\r\n\r\n    const deleteEffect = (effect_prop, removed) => {\r\n        const new_effects = props.node[effect_prop].filter(x => x !== removed)\r\n        setNode(updateProp(node, effect_prop, new_effects.length ? new_effects : undefined))\r\n    }\r\n\r\n    const current_image = node.raw_image ? node.raw_image : preset_images[node.image]\r\n    const imageInput = useRef<HTMLInputElement>()\r\n    const try_uploading_image = () => {\r\n        imageInput.current.click() //god why\r\n    }\r\n\r\n    const setUploadedImage = (e) => {\r\n        var reader = new FileReader()\r\n        reader.onload = (e) => {\r\n            var uploaded_image = document.createElement('img');\r\n            uploaded_image.onload = () =>{\r\n                if(uploaded_image.width !== 200 || uploaded_image.height !== 100){\r\n                    alert(`Adventure images need to be be 200x100 pngs.`)\r\n                    return\r\n                }\r\n                const modified_node = {...node,\r\n                    raw_image:e.target.result as string,\r\n                    image:null\r\n                }\r\n                setNode(modified_node)\r\n            }\r\n            uploaded_image.src = e.target.result as string\r\n        }\r\n        reader.readAsDataURL(e.target.files[0])\r\n    }\r\n\r\n    const reset_image = () => {\r\n        const modified_node = {...node,\r\n            raw_image:undefined,\r\n            image:\"default\"\r\n        }\r\n        setNode(modified_node)\r\n    }\r\n\r\n    const update_image = e => {\r\n        setNode(updateProp(node,\"image\",e.target.value))\r\n    }\r\n\r\n    const image_name_text = node.raw_image ? \"custom image data\" : node.image\r\n    return (\r\n        <>\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <Card.Title>{node.name} <Button variant=\"danger\" onClick={handleNodeDeletion}>Delete</Button></Card.Title>\r\n                            <Image src={current_image} width=\"400px\" height=\"200px\"/>\r\n                            <InputGroup>\r\n                                <InputGroup.Prepend>\r\n                                    <InputGroup.Text>Image</InputGroup.Text>\r\n                                </InputGroup.Prepend>\r\n                                <Form.Control as=\"select\" value={image_name_text} readOnly={node.raw_image !== undefined} onChange={update_image}>\r\n                                    {Object.keys(preset_images).map(k => (<option key={k}>{k}</option>))}\r\n                                    </Form.Control>\r\n                                <Form.File type='file' accept=\"image/png\" ref={imageInput} onChange={setUploadedImage} style={{display:\"none\"}}/>\r\n                                <InputGroup.Append>\r\n                                    <Button onClick={try_uploading_image}>Custom</Button>\r\n                                    <Button onClick={reset_image}>Reset</Button>\r\n                                </InputGroup.Append>\r\n                            </InputGroup>\r\n                            <FormGroup>\r\n                                <Form.Label>Node ID</Form.Label>\r\n                                <Form.Text muted>Node unique ID, this is not visible to the player</Form.Text>\r\n                                <FormControl value={node.name} onChange={update_node_name} />\r\n                            </FormGroup>\r\n                            <FormGroup>\r\n                                <Form.Label>Description</Form.Label>\r\n                                <Form.Text muted>Text shown to the player for this node. You can use $$SITE_NAME to insert exploration site name in the text. Use $$QualityName to place current quality value in text.</Form.Text>\r\n                                <FormControl as=\"textarea\" rows={5} placeholder=\"Describe whatever here.\" value={node.description} onChange={(e) => setNode(updateProp(node, \"description\", e.target.value))} />\r\n                            </FormGroup>\r\n                            <Form.Text muted>Quality changes that happen when node is entered by any means.</Form.Text>\r\n                            <EffectBuilder\r\n                                title=\"On Enter Effects\"\r\n                                effects={node.on_enter_effects}\r\n                                handleEffectAdded={added => addEffect(\"on_enter_effects\", added)}\r\n                                handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_enter_effects\", old, prop, new_value)}\r\n                                handleEffectDeleted={deleted => deleteEffect(\"on_enter_effects\", deleted)} />\r\n                            <Form.Text muted>Quality changes that happen when node is exited by any means.</Form.Text>\r\n                            <EffectBuilder\r\n                                title=\"On Exit Effects\"\r\n                                effects={node.on_exit_effects}\r\n                                parent_id={node.id}\r\n                                handleEffectAdded={added => addEffect(\"on_exit_effects\", added)}\r\n                                handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_exit_effects\", old, prop, new_value)}\r\n                                handleEffectDeleted={deleted => deleteEffect(\"on_exit_effects\", deleted)} />\r\n                            <Card.Header>Choices</Card.Header>\r\n                                {node.choices.map(choice => (\r\n                                        <AdventureChoice\r\n                                            key={choice.id}\r\n                                            choice={choice}\r\n                                            handleChoiceDeletion={() => removeChoice(choice)}\r\n                                            handleChoiceChange={(choice_property, new_value) => {\r\n                                                const new_choice = { ...choice, [choice_property]: new_value }\r\n                                                updateChoice(choice, new_choice)\r\n                                            }}\r\n                                        />))}\r\n                                <Button onClick={() => addChoice(new ChoiceData())}>Add Choice</Button>\r\n                        </Card.Body>\r\n                    </Card>\r\n            </>\r\n    )\r\n}","import React from 'react';\r\nimport { Button, Card, FormControl, FormGroup, Form } from 'react-bootstrap'\r\nimport { useRecoilState } from 'recoil'\r\nimport { updateProp } from '../Helpers'\r\nimport { TriggerSelector } from '../State'\r\nimport { RequirementsBuilder } from './RequirementsBuilder'\r\nimport { EffectBuilder } from './EffectBuilder'\r\nimport {NodeSelectionDropdown} from './Utility'\r\n\r\n\r\nexport function AdventureTrigger(props) {\r\n    const handleDeletion = props.handleDeletion\r\n\r\n    const [trigger, setTrigger] = useRecoilState(TriggerSelector(props.trigger.id))\r\n\r\n    const update_trigger_name = (e) => {\r\n        setTrigger(updateProp(trigger, \"name\", e.target.value))\r\n    }\r\n\r\n    const update_trigger_target_node = (e) => {\r\n        setTrigger(updateProp(trigger, \"target_node\", e.target.value))\r\n    }\r\n\r\n    const addEffect = (effect_prop, new_effect) => {\r\n        const old_effects = props.trigger[effect_prop]\r\n        const new_effects = old_effects !== undefined ? [...old_effects, new_effect] : [new_effect]\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects))\r\n    }\r\n\r\n    const updateEffects = (effect_prop, old_effect, changed_prop, new_value) => {\r\n        const changed_effect = { ...old_effect, [changed_prop]: new_value }\r\n        const new_effects = props.trigger[effect_prop].slice()\r\n        new_effects[props.trigger[effect_prop].indexOf(old_effect)] = changed_effect\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects))\r\n    }\r\n\r\n    const deleteEffect = (effect_prop, removed) => {\r\n        const new_effects = props.trigger[effect_prop].filter(x => x !== removed)\r\n        setTrigger(updateProp(trigger, effect_prop, new_effects.length ? new_effects : undefined))\r\n    }\r\n\r\n    const addRequirement = added => {\r\n        const old_reqs = props.trigger.requirements\r\n        const new_reqs = old_reqs !== undefined ? [...old_reqs, added] : [added]\r\n        setTrigger(updateProp(trigger,\"requirements\", new_reqs))\r\n    }\r\n\r\n    const deleteRequirement = removed => {\r\n        const new_reqs = props.trigger.requirements.filter(x => x !== removed)\r\n        setTrigger(updateProp(trigger,\"requirements\",  new_reqs.length ? new_reqs : undefined))\r\n    }\r\n\r\n    const updateRequirements = (old_req, changed_prop, new_value) => {\r\n        const changed_req = { ...old_req, [changed_prop]: new_value }\r\n        const new_reqs = props.trigger.requirements.slice()\r\n        new_reqs[props.trigger.requirements.indexOf(old_req)] = changed_req\r\n        setTrigger(updateProp(trigger,\"requirements\",  new_reqs))\r\n    }\r\n\r\n\r\n    return (\r\n        <Card>\r\n            <Card.Body>\r\n                <Card.Title>Trigger <Button variant=\"danger\" onClick={handleDeletion}>Delete</Button></Card.Title>\r\n                <FormGroup>\r\n                    <Form.Label>Trigger ID</Form.Label>\r\n                    <FormControl value={trigger.name} onChange={update_trigger_name} />\r\n                </FormGroup>\r\n                <FormGroup>\r\n                    <Form.Label>Target Node On Trigger</Form.Label>\r\n                    <NodeSelectionDropdown allowNone={true} value={trigger.target_node} onChange={update_trigger_target_node}/>\r\n                </FormGroup>\r\n                <EffectBuilder\r\n                    title=\"On Trigger Effects\"\r\n                    effects={trigger.on_trigger_effects}\r\n                    handleEffectAdded={added => addEffect(\"on_trigger_effects\", added)}\r\n                    handleEffectsChanged={(old, prop, new_value) => updateEffects(\"on_trigger_effects\", old, prop, new_value)}\r\n                    handleEffectDeleted={deleted => deleteEffect(\"on_trigger_effects\", deleted)} />\r\n                <RequirementsBuilder\r\n                    title=\"Trigger Requirements\"\r\n                    requirements={props.trigger.requirements}\r\n                    handleRequirementAdded={addRequirement}\r\n                    handleRequirementDeleted={deleteRequirement}\r\n                    handleRequirementsChanged={updateRequirements}\r\n                />\r\n            </Card.Body>\r\n        </Card>\r\n\r\n    )\r\n}","import React, { useState } from 'react';\r\nimport { Button, Col, Container, Row, Card,Alert,Table } from 'react-bootstrap'\r\nimport {preset_images,EffectTypes,ValueTypes} from '../ExternalDefines'\r\nimport {useRecoilState} from 'recoil'\r\nimport { AdventureState, TriggerData } from '../State';\r\n\r\n\r\nexport function AdventurePlayer(props) {\r\n\r\n    const [adventure] = useRecoilState(AdventureState)\r\n\r\n    const [currentNode,setCurrentNode] = useState(adventure.nodes.find(node => node.name === adventure.starting_node) || adventure.nodes[0])\r\n    const [qualities,setQualities] = useState(adventure.starting_qualities)\r\n    const [prevNode,setPrevNode] = useState(currentNode ? currentNode.name : \"\")\r\n    \r\n    const restart_test = () => {\r\n        setCurrentNode(adventure.nodes.find(node => node.name === adventure.starting_node) || adventure.nodes[0])\r\n        setQualities(adventure.starting_qualities)\r\n        setPrevNode(currentNode.name)\r\n    }\r\n\r\n    const checkReq = req => {\r\n        switch(req.operator){\r\n            case \"==\":\r\n                if(qualities[req.quality] === req.value)\r\n                    return true\r\n                break\r\n            case \"!=\":\r\n                if(qualities[req.quality] !== req.value)\r\n                    return true\r\n                break\r\n            case \"<=\":\r\n                if(qualities[req.quality] <= req.value)\r\n                    return true\r\n                break\r\n            case \">=\":\r\n                if(qualities[req.quality] >= req.value)\r\n                    return true\r\n                break\r\n            case \">\":\r\n                if(qualities[req.quality] > req.value)\r\n                    return true\r\n                break\r\n            case \"<\":\r\n                if(qualities[req.quality] < req.value)\r\n                    return true\r\n                break\r\n            default:\r\n                alert(\"Unknown operator\")\r\n        }\r\n    }\r\n\r\n    const check_group = (req_group,group_type) => {\r\n        switch(group_type){\r\n            case \"AND\":\r\n                for(let req of req_group){\r\n                    if(req.group_type !== undefined){\r\n                        if(!check_group(req.requirements,req.group_type))\r\n                            return false;\r\n                    }else if(!checkReq(req))\r\n                        return false\r\n                }\r\n                return true;\r\n            case \"OR\":\r\n                for(let req of req_group){\r\n                    if(req.group_type !== undefined){\r\n                        if(check_group(req,req.group_type))\r\n                            return true;\r\n                    }else if(checkReq(req))\r\n                        return true;\r\n                }\r\n                return false;\r\n            default:\r\n                alert(\"wrong group_type\")\r\n        }\r\n    }\r\n\r\n    const checkChoice = choice => {\r\n        if(choice.requirements === undefined)\r\n            return true\r\n        return check_group(choice.requirements,\"AND\")\r\n    }\r\n\r\n    const navigateToNode = node_name => {\r\n        if(currentNode.on_exit_effects !== undefined){\r\n            if(apply_effects(currentNode.on_exit_effects))\r\n                return\r\n        }\r\n        switch(node_name){\r\n            case \"WIN\":\r\n                alert(\"Here you would complete the adventure in real game and recieve loot.\")\r\n                break\r\n            case \"FAIL\":\r\n                alert(\"Here you would lose the adventure in real game and get dealt half integrity as damage.\")\r\n                break\r\n            case \"FAIL_DEATH\":\r\n                alert(\"Here you would lose the adventure in real game and blown up.\")\r\n                break\r\n            case \"GO_BACK\":\r\n                navigateToNode(prevNode)\r\n                break\r\n            default:\r\n                const next_node = adventure.nodes.find(node => node.name === node_name)\r\n                setCurrentNode(next_node)\r\n                if(prevNode !== next_node.name)\r\n                    setPrevNode(next_node.name)\r\n                if(next_node.on_enter_effects !== undefined){\r\n                    if(apply_effects(next_node.on_enter_effects))\r\n                        return\r\n                }\r\n        }\r\n    }\r\n    const triggerGuard : Array<TriggerData> = []\r\n    const checkTriggers = () => {\r\n        if(adventure.triggers !== undefined){\r\n            for (let trigger of adventure.triggers) {\r\n                if(!check_group(trigger.requirements,\"AND\"))\r\n                    continue\r\n                if(triggerGuard.includes(trigger)){\r\n                    alert(`Recursive trigger detected. ${trigger.name}`)\r\n                    continue\r\n                }\r\n                triggerGuard.push(trigger)\r\n                if(trigger.on_trigger_effects !== undefined){\r\n                    if(apply_effects(trigger.on_trigger_effects))\r\n                        return true\r\n                }\r\n                if(trigger.target_node !== undefined)\r\n                    navigateToNode(trigger.target_node)\r\n                    return true\r\n            }\r\n        }\r\n        triggerGuard.length = 0\r\n        return false;\r\n    }\r\n\r\n    ///thanks mdn\r\n    const getRandomInt = (min, max) => {\r\n        min = Math.ceil(min);\r\n        max = Math.floor(max+1); //[x..y] not [x..y)\r\n        return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive\r\n    }\r\n\r\n    const extractValue = value => {\r\n        if(value === Object(value)){\r\n            switch(value.value_type){\r\n                case ValueTypes.random:\r\n                    return getRandomInt(value.low,value.high)\r\n                default:\r\n                    alert(\"wrong value type\")\r\n            }\r\n        }\r\n        return value;\r\n    }\r\n\r\n    const apply_effects = effect_list => {\r\n        var resulting_qualities = {...qualities}\r\n        for (let effect of effect_list) {\r\n            const extractedValue = extractValue(effect.value)\r\n            switch(effect.effect_type){\r\n                case EffectTypes.Add:\r\n                    resulting_qualities[effect.quality] = (resulting_qualities[effect.quality] || 0) + extractedValue\r\n                    break;\r\n                case EffectTypes.Set:\r\n                    resulting_qualities[effect.quality] = extractedValue\r\n                    break;\r\n                case EffectTypes.Remove:\r\n                    delete resulting_qualities[effect.quality]\r\n                    break;\r\n                default:\r\n                    alert(\"wrong effect type\")\r\n            }\r\n        }\r\n        setQualities(resulting_qualities)\r\n        if(checkTriggers())\r\n            return true\r\n        return false;\r\n    }\r\n\r\n    const selectChoice = (choice) => {\r\n        if(choice.on_selection_effects !== undefined){\r\n            if(apply_effects(choice.on_selection_effects))\r\n                return\r\n        }\r\n        navigateToNode(choice.exit_node)\r\n    }\r\n\r\n    const replaceKeywords = (text : string) => {\r\n        const subRegex = /\\$\\$(\\S*)/g;\r\n        return text.replace(subRegex, (match,g1) => { \r\n            switch (g1) {\r\n                case \"SITE_NAME\":\r\n                    return \"SITE NAME WOULD GO HERE\"\r\n                default:\r\n                    return qualities[g1] as string\r\n            }\r\n         })\r\n    }\r\n\r\n    if(!currentNode)\r\n        return (<Alert variant=\"danger\">You need at least one node to play.</Alert>)\r\n\r\n    return (\r\n        <Container>\r\n            <Alert variant=\"danger\">Delays are not implemented. Choices shown as disabled would not be visible in-game</Alert>\r\n            <Row>\r\n                <Col>\r\n                    <Button onClick={restart_test}>Restart</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col>\r\n                    <Card>\r\n                        <Card.Img src={currentNode.raw_image ? currentNode.raw_image : preset_images[currentNode.image]}/>\r\n                        <Card.Body>\r\n                            <Card.Text>{replaceKeywords(currentNode.description)}</Card.Text>\r\n                            <Container>\r\n                                {currentNode.choices.map(choice => (\r\n                                    <Row key={choice.id}><Col><Button disabled={!checkChoice(choice)} onClick={() => selectChoice(choice)}>{choice.name}</Button></Col></Row>\r\n                                ))}\r\n                            </Container>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Quality</th>\r\n                            <th>Value</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {Object.keys(qualities).map(qname => (<tr key={qname}><td>{qname}</td><td>{qualities[qname]}</td></tr>)) }\r\n                    </tbody>\r\n                </Table>\r\n            </Row>\r\n        </Container>\r\n    )\r\n}","import React,{useRef, useState} from 'react'\r\nimport { Button, Col, Container, Row, Tab, Nav, FormControl, FormGroup, Form, ButtonGroup,Modal } from 'react-bootstrap'\r\nimport {useRecoilState, useRecoilValue} from 'recoil'\r\nimport {AdventureState,NodesSelector,NodeData,TriggersSelector,TriggerData, unique_id} from '../State'\r\nimport {updateProp} from '../Helpers'\r\nimport {AdventureNode} from './AdventureNode'\r\nimport {AdventureTrigger} from './AdventureTrigger'\r\nimport {BasicCollapsible,NodeSelectionDropdown, KeyValueList, SimpleList} from './Utility'\r\nimport {scan_bands, loot_types, site_traits} from '../ExternalDefines'\r\nimport { AdventurePlayer } from './AdventurePlayer'\r\n\r\n\r\nexport function AdventureEditor() {\r\n    const [adventure,setAdventure] = useRecoilState(AdventureState);\r\n    const nodes = useRecoilValue(NodesSelector)\r\n    const triggers = useRecoilValue(TriggersSelector)\r\n\r\n    const [activeTab,setActiveTab] = useState(\"\")\r\n    const [draggedItem,setDraggedItem] = useState(null)\r\n   \r\n    const add_node = () => {\r\n      const modified_adventure = {...adventure,\r\n        nodes:[...nodes,new NodeData()]\r\n      }\r\n      setAdventure(modified_adventure)\r\n    }\r\n    const delete_node = (node) => {\r\n      var old_index = nodes.findIndex(x => x === node)\r\n      const changed_nodes = nodes.filter(x => x !== node)\r\n      setAdventure(updateProp(adventure,\"nodes\",changed_nodes))\r\n      if(changed_nodes.length){\r\n          const new_index = Math.max(0,old_index -1)\r\n          setActiveTab(changed_nodes[new_index].id)\r\n      }\r\n    }\r\n\r\n    const add_trigger = () => {\r\n      const modified_adventure = {...adventure,\r\n        triggers:[...triggers,new TriggerData()]\r\n      }\r\n      setAdventure(modified_adventure)\r\n\r\n    }\r\n    const delete_trigger = (trigger) => {\r\n      const changed_triggers = triggers.filter(x => x !== trigger)\r\n      setAdventure(updateProp(adventure,\"triggers\",changed_triggers))\r\n      \r\n    }\r\n\r\n    \r\n    const handleExport = () => {\r\n      const data_object = {\r\n        adventure_name: adventure.name,\r\n        author : adventure.author,\r\n        starting_node: startingNode,\r\n        starting_qualities: adventure.starting_qualities,\r\n        required_site_traits: adventure.required_site_traits,\r\n        loot_categories : adventure.loot_types,\r\n        scan_band_mods : adventure.band_modifiers,\r\n        deep_scan_description : adventure.deep_scan_description,\r\n        triggers : adventure.triggers,\r\n        nodes: nodes\r\n      }\r\n      //Internal stuff, byond doesn't care about this\r\n      const remove_ids = (key, value) => {\r\n        if (key === \"id\")\r\n          return undefined\r\n        return value;\r\n      }\r\n      const blob = new Blob([JSON.stringify(data_object, remove_ids)], { type: 'application/json' })\r\n      const blob_url = URL.createObjectURL(blob)\r\n      \r\n      ExportLink.current.href = blob_url\r\n      ExportLink.current.download = `${adventure.name}.json`\r\n      ExportLink.current.click();\r\n    }\r\n\r\n    const regenerate_reqs = req_list => {\r\n      for(var req of req_list){\r\n        req.id = unique_id(\"req\")\r\n        if(req.group_type !== undefined){\r\n          if(req.requirements !== undefined)\r\n            regenerate_reqs(req.requirements)\r\n        }\r\n      }\r\n    }\r\n\r\n    const regenerate_effects = effects => {\r\n      for(var effect of effects){\r\n        effect.id = unique_id(\"effect\")\r\n      }\r\n    }\r\n    /// Regenerates temporary ids\r\n    const regenerate_ids = node_list =>{\r\n      for(var node of node_list){\r\n        node.id = unique_id(\"Node\")\r\n        for(var choice of node.choices){\r\n          choice.id = unique_id(\"choice\")\r\n          if(choice.on_selection_effects !== undefined){\r\n            regenerate_effects(choice.on_selection_effects)\r\n          }\r\n          if(choice.requirements !== undefined){\r\n            regenerate_reqs(choice.requirements)\r\n          }\r\n        }\r\n        if(node.on_enter_effects !== undefined)\r\n          regenerate_effects(node.on_enter_effects)\r\n        if(node.on_exit_effects !== undefined)\r\n          regenerate_effects(node.on_exit_effects)\r\n      }\r\n      return node_list\r\n    }\r\n\r\n    const regenerate_trigger_ids = trigger_list => {\r\n      for(var trigger of trigger_list){\r\n        trigger.id = unique_id(\"trigger\")\r\n        if(trigger.requirements !== undefined){\r\n          regenerate_reqs(trigger.requirements)\r\n        }\r\n        if(trigger.on_trigger_effects !== undefined){\r\n          regenerate_effects(trigger.on_trigger_effects)\r\n        }\r\n      }\r\n      return trigger_list\r\n    }\r\n  \r\n    const handleImport = e => {\r\n      var reader = new FileReader()\r\n      reader.onload = (e) =>{\r\n        const result = JSON.parse(e.target.result as string);\r\n\r\n        const reindexed_nodes = regenerate_ids(result.nodes)\r\n        const reindexed_triggers = regenerate_trigger_ids(result.triggers)\r\n\r\n        const modified_adventure = {...adventure,\r\n          name:result.adventure_name,\r\n          author : result.author,\r\n          starting_node:result.starting_node,\r\n          starting_qualities:result.starting_qualities,\r\n          required_site_traits:result.required_site_traits,\r\n          band_modifiers:result.scan_band_mods,\r\n          loot_types:result.loot_categories,\r\n          triggers:reindexed_triggers,\r\n          nodes:reindexed_nodes\r\n        }\r\n        setAdventure(modified_adventure)\r\n      }\r\n      reader.readAsText(e.target.files[0])\r\n    }\r\n\r\n    const ImportInput = useRef<HTMLInputElement>()\r\n    const clickImport = () => {\r\n      ImportInput.current.click()\r\n    }\r\n\r\n    const ExportLink = useRef<HTMLAnchorElement>()\r\n\r\n    const start_dragging = (e,node) => {\r\n      setDraggedItem(node)\r\n    } \r\n\r\n    const end_dragging = (e,node) => {\r\n      setDraggedItem(null)\r\n    }\r\n\r\n    const switch_node = (node) => {\r\n      if(draggedItem != null){\r\n        const index_a = nodes.indexOf(node)\r\n        const index_b = nodes.indexOf(draggedItem)\r\n        const modified_nodes = nodes.slice();\r\n        [modified_nodes[index_a],modified_nodes[index_b]] = [modified_nodes[index_b],modified_nodes[index_a]]\r\n        setAdventure(updateProp(adventure,\"nodes\",modified_nodes))\r\n      }\r\n    }\r\n\r\n    const validate_drop = (e,node) => {\r\n      if(draggedItem != null && node !== draggedItem){\r\n        e.preventDefault()\r\n      }\r\n    }\r\n\r\n    const getDefaultTab = () => {\r\n      if(nodes.length)\r\n        return nodes[0].id.toString()\r\n    }\r\n    const openTab = activeTab || getDefaultTab()\r\n    \r\n    const getDefaultStartingNode = () => {\r\n      if(nodes.length)\r\n        return nodes[0].name\r\n    }\r\n    const startingNode = adventure.starting_node || getDefaultStartingNode()\r\n\r\n\r\n    const [playing,setPlaying] = useState(false)\r\n\r\n    const toggle_playing = () => {\r\n      setPlaying(!playing)\r\n    }\r\n\r\n    return (\r\n    <>\r\n    <Modal show={playing} onHide={toggle_playing}>\r\n      <AdventurePlayer adventure={adventure}/>\r\n    </Modal>\r\n    <Container>\r\n      <Row>\r\n        <Col>\r\n        <ButtonGroup>\r\n            <Button onClick={handleExport}>Export</Button>\r\n            <a ref={ExportLink} style={{display:\"none\"}} href=\"/\">God is this really how JS supposed to work</a>\r\n            <Button onClick={clickImport}>Import</Button>\r\n            <Form.File\r\n              onChange={handleImport}\r\n              accept=\".json\"\r\n              ref={ImportInput}\r\n              style ={{display:\"none\"}}/>\r\n            <Button onClick={toggle_playing}>Test</Button>\r\n        </ButtonGroup>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n        <BasicCollapsible title=\"Adventure Config\">\r\n            <Form>\r\n              <FormGroup>\r\n                <Form.Label>Adventure name</Form.Label>\r\n                <Form.Text muted>Adventure name, should be specific as possible since it needs to be unique among all adventures</Form.Text>\r\n                <FormControl placeholder=\"New adventure\" value={adventure.name} onChange={(e) => setAdventure(updateProp(adventure,\"name\",e.target.value))} />\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Author</Form.Label>\r\n                <Form.Text muted>Your name</Form.Text>\r\n                <FormControl value={adventure.author} onChange={(e) => setAdventure(updateProp(adventure,\"author\",e.target.value))} />\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Starting node</Form.Label>\r\n                <Form.Text muted>This is the node the adventure will being at. On Enter effects WILL fire for this node.</Form.Text>\r\n                <NodeSelectionDropdown value={startingNode} onChange={(e) => setAdventure(updateProp(adventure,\"starting_node\",e.target.value))} allowCustom={false}/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Starting qualities</Form.Label>\r\n                <Form.Text muted>These qualities will be set once before adventure begins on top of qualities provided by drone equipment.</Form.Text>\r\n                <KeyValueList adventureProp=\"starting_qualities\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Required site traits</Form.Label>\r\n                <Form.Text muted>This adventure will only appear on exploration sites with all these traits</Form.Text>\r\n                <SimpleList presetValues={site_traits} adventureProp=\"required_site_traits\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Loot type</Form.Label>\r\n                <Form.Text muted>Generator type used for adventure loot when win node is reached.</Form.Text>\r\n                <SimpleList presetValues={loot_types} adventureProp=\"loot_types\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Scanning modifiers</Form.Label>\r\n                <Form.Text muted>These modifiers will be applied to point scan results of the exploration site with this adventure.</Form.Text>\r\n                <KeyValueList presetKeys={scan_bands} adventureProp=\"band_modifiers\"/>\r\n              </FormGroup>\r\n              <FormGroup>\r\n                <Form.Label>Deep scan description</Form.Label>\r\n                <Form.Text muted>This description will be added to exploration site's description after a deep scan.</Form.Text>\r\n                <FormControl value={adventure.deep_scan_description} onChange={(e) => setAdventure(updateProp(adventure,\"deep_scan_description\",e.target.value))} />\r\n              </FormGroup>\r\n            </Form>\r\n        </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n          <BasicCollapsible title=\"Nodes\">\r\n          <Tab.Container id=\"nodes\" activeKey={openTab} onSelect={e => setActiveTab(e)}>\r\n            <Row>\r\n              <Col>\r\n                <Nav variant=\"tabs\">\r\n                  {nodes.map(node => (\r\n                    <Nav.Item \r\n                      key={node.id} \r\n                      draggable \r\n                      onDragEnd={e => end_dragging(e,node)} \r\n                      onDragStart={e => start_dragging(e,node)} \r\n                      onDrop={() => switch_node(node)}\r\n                      onDragOver={e => validate_drop(e,node)}\r\n                      >\r\n                      <Nav.Link eventKey={node.id}>{node.name}</Nav.Link>\r\n                    </Nav.Item>))}\r\n                  <Nav.Item>\r\n                    <Nav.Link onClick={add_node}>Add Node</Nav.Link>\r\n                  </Nav.Item>\r\n                </Nav>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col>\r\n                <Tab.Content>\r\n                    {nodes.map(node => (\r\n                      <Tab.Pane eventKey={node.id} key={node.id}>\r\n                        <AdventureNode \r\n                          node={node}\r\n                          handleNodeDeletion={() => delete_node(node)}\r\n                          />\r\n                      </Tab.Pane>))}\r\n                  </Tab.Content>\r\n              </Col>\r\n            </Row>\r\n          </Tab.Container>\r\n          </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n        <BasicCollapsible title=\"Triggers\" startCollapsed>\r\n          <Container>\r\n            <Row><Col><Form.Text muted>Triggers are checks that happen after any quality changes. If requirements are met the effects and/or node changes are applied over the choice that made it happen.</Form.Text></Col></Row>\r\n            <Row>\r\n              {triggers.map(trigger => (\r\n                <Col key={trigger.id} xl=\"auto\"><AdventureTrigger trigger={trigger} handleDeletion={() => delete_trigger(trigger)}/></Col>\r\n              ))}\r\n              <Col>\r\n                <Button onClick={add_trigger}>Add Trigger</Button>\r\n              </Col>\r\n            </Row>\r\n          </Container>\r\n        </BasicCollapsible>\r\n        </Col>\r\n      </Row>\r\n    </Container></>)\r\n  }","import './App.css';\r\nimport {RecoilRoot} from 'recoil'\r\nimport {AdventureEditor} from './Components/AdventureEditor'\r\n\r\n/*\r\nTODO:\r\nBasic validation of loops/invalid node ids and such.\r\nStyling this to look good aaahhh!!!\r\n*/\r\n\r\nfunction App(){\r\n  return (\r\n    <RecoilRoot>\r\n      <AdventureEditor/>\r\n    </RecoilRoot>\r\n  )\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}